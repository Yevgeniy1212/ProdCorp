// - БК - начало
Перем мОтображатьСтруктурныеПодразделения Экспорт;
////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ ДОКУМЕНТА   

Процедура ЗаполнитьПоДокументуОснования(Основание) Экспорт
	
	ТипОснования = ТипЗнч(Основание);
	Если ТипОснования = Тип("ДокументСсылка.ОПВПеречислениеВФонды") Тогда
		
		СоответствиеВидовОпераций = Новый Соответствие;
		СоответствиеВидовОпераций.Вставить(Перечисления.ВидыОперацийОПВПеречислениеВФонды.ПеречислениеОбязательныхПенсионныхВзносов, Перечисления.ВидыОперацийОПВВозвратВзносов.ВозвратОбязательныхПенсионныхВзносов);
		СоответствиеВидовОпераций.Вставить(Перечисления.ВидыОперацийОПВПеречислениеВФонды.ПеречислениеОбязательныхПрофессиональныхПенсионныхВзносов, Перечисления.ВидыОперацийОПВВозвратВзносов.ВозвратОбязательныхПрофессиональныхПенсионныхВзносов);
		СоответствиеВидовОпераций.Вставить(Перечисления.ВидыОперацийОПВПеречислениеВФонды.ПеречислениеОбязательныхПенсионныхВзносовРаботодателя, Перечисления.ВидыОперацийОПВВозвратВзносов.ВозвратОбязательныхПенсионныхВзносовРаботодателя);
		
		
		// Заполним реквизиты из стандартного набора.
		ЗаполнениеДокументов.ЗаполнитьШапкуДокументаПоОснованию(ЭтотОбъект, Основание);
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ОПВПеречислениеВФонды.Контрагент КАК Контрагент,
		|	ОПВПеречислениеВФонды.ВидПлатежа КАК ВидПлатежа,
		|	ОПВПеречислениеВФонды.ВидОперации КАК ВидОперации,
		|	ОПВПеречислениеВФонды.ПериодРегистрации КАК ПериодРегистрации,
		|	ОПВПеречислениеВФонды.ПенсионныеВзносы КАК ПенсионныеВзносы
		|ИЗ
		|	Документ.ОПВПеречислениеВФонды КАК ОПВПеречислениеВФонды
		|
		|ГДЕ
		|	ОПВПеречислениеВФонды.Ссылка = &парамСсылка";
		
		Запрос.УстановитьПараметр("парамСсылка", Основание);
		РезультатЗапроса = Запрос.Выполнить().Выбрать();
		Если РезультатЗапроса.Следующий() Тогда
			Контрагент		  = РезультатЗапроса.Контрагент;
			ВидПлатежа		  = РезультатЗапроса.ВидПлатежа;
			ПериодРегистрации = РезультатЗапроса.ПериодРегистрации;
			ВидОперации 	  = СоответствиеВидовОпераций[РезультатЗапроса.ВидОперации];
			
			ПенсионныеВзносы.Загрузить(РезультатЗапроса.ПенсионныеВзносы.Выгрузить());
		КонецЕсли;
		
	КонецЕсли;
	
	ДокументОснование = Основание;

КонецПроцедуры // ОбработкаЗаполненияУпр()

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ

Процедура ОбработкаЗаполнения(Основание)
	
	ЗаполнитьПоДокументуОснования(Основание)	
	
КонецПроцедуры

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат
	КонецЕсли;
	
	МассивТЧ = Новый Массив();
	МассивТЧ.Добавить(ПенсионныеВзносы);
	
	КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(МассивТЧ, "ФизЛицо");
	СуммаДокумента = ПенсионныеВзносы.Итог("Сумма");
	
КонецПроцедуры

// - БК - начало
мОтображатьСтруктурныеПодразделения = ОбщегоНазначения.ПолучитьПризнакОтображенияСтруктурныхПодразделенийВЗарплате();
// - БК - конец
