
Процедура Печать(ТабДок, Ссылка) Экспорт
	//{{_КОНСТРУКТОР_ПЕЧАТИ(Печать)
	Макет = Документы.ПланируемыйОбъемЗерна.ПолучитьМакет("Печать");
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ПланируемыйОбъемЗерна.Автор,
	|	ПланируемыйОбъемЗерна.Дата,
	|	ПланируемыйОбъемЗерна.ДоговорКонтрагента,
	|	ПланируемыйОбъемЗерна.Комментарий,
	|	ПланируемыйОбъемЗерна.Номер,
	|	ПланируемыйОбъемЗерна.Организация,
	|	ПланируемыйОбъемЗерна.Получатель,
	|	ПланируемыйОбъемЗерна.ТипОперации,
	|	ПланируемыйОбъемЗерна.Зерно.(
	|		НомерСтроки,
	|		ХПП,
	|		ЗерноваяРасписка,
	|		Культура,
	|		ГодУрожая,
	|		Объем,
	|		Влажность,
	|		СорнаяПримесь,
	|		ЗерноваяПримесь,
	|		Натура,
	|		Клейковина,
	|		Числопадений,
	|		Белок
	|	),
	|	ОтветственныеЛицаОрганизацийСрезПоследних.ФизическоеЛицо
	|ИЗ
	|	Документ.ПланируемыйОбъемЗерна КАК ПланируемыйОбъемЗерна
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ОтветственныеЛицаОрганизаций.СрезПоследних КАК ОтветственныеЛицаОрганизацийСрезПоследних
	|		ПО ПланируемыйОбъемЗерна.Организация = ОтветственныеЛицаОрганизацийСрезПоследних.СтруктурнаяЕдиница
	|ГДЕ
	|	ПланируемыйОбъемЗерна.Ссылка В(&Ссылка)
	|	И ОтветственныеЛицаОрганизацийСрезПоследних.Должность = &Должность";
	Запрос.Параметры.Вставить("Должность", Перечисления.ОтветственныеЛицаОрганизаций.Руководитель);
	Запрос.Параметры.Вставить("Ссылка", Ссылка);	
	Выборка = Запрос.Выполнить().Выбрать();

	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
	Шапка = Макет.ПолучитьОбласть("Шапка");
	ОбластьЗерноШапка = Макет.ПолучитьОбласть("ЗерноШапка");
	ОбластьЗерно = Макет.ПолучитьОбласть("Зерно");
	Подвал = Макет.ПолучитьОбласть("Подвал");

	ТабДок.Очистить();

	ВставлятьРазделительСтраниц = Ложь;
	Пока Выборка.Следующий() Цикл
		Если ВставлятьРазделительСтраниц Тогда
			ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;

		ТабДок.Вывести(ОбластьЗаголовок);

		Шапка.Параметры.Заполнить(Выборка);
		ТабДок.Вывести(Шапка, Выборка.Уровень());

		ТабДок.Вывести(ОбластьЗерноШапка);
		ВыборкаЗерно = Выборка.Зерно.Выбрать();
		Пока ВыборкаЗерно.Следующий() Цикл
			ОбластьЗерно.Параметры.Заполнить(ВыборкаЗерно);
			ТабДок.Вывести(ОбластьЗерно, ВыборкаЗерно.Уровень());
		КонецЦикла;

		Подвал.Параметры.Заполнить(Выборка);
		ТабДок.Вывести(Подвал);

		ВставлятьРазделительСтраниц = Истина;
	КонецЦикла;
	//}}
КонецПроцедуры
