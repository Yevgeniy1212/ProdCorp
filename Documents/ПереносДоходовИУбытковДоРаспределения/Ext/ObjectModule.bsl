
Процедура ОбработкаПроведения(Отказ, Режим)
		
	// регистр Типовой 
	Движения.Типовой.Записывать = Истина;
	Движения.Типовой.Очистить();
	Движение = Движения.Типовой.Добавить();
	Движение.СчетДт = ПланыСчетов.Типовой.НераспределеннаяПрибыльНепокрытыйУбытокОтчетногоГода;
	Движение.СчетКт = ПланыСчетов.Типовой.НераспределеннаяПрибыльНепокрытыйУбытокПредыдущихЛет;
	Движение.Период = Дата;
	Движение.Организация = Организация;
	Движение.Сумма = ПолучитьСумму(Движение.СчетДт);
	Движение.Содержание = "Перенос доходов и убытков";

КонецПроцедуры

Функция ПолучитьСумму(Счет)
	
	ОстатокНаСчете = 0;
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ТиповойОстатки.СуммаОстатокКт
	|ИЗ
	|	РегистрБухгалтерии.Типовой.Остатки(&Период, Счет = &Счет, , ) КАК ТиповойОстатки";
	Запрос.УстановитьПараметр("Период", Новый Граница(Дата, ВидГраницы.Исключая));
	Запрос.УстановитьПараметр("Счет", Счет);
	
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		ОстатокНаСчете = Выборка.СуммаОстатокКт;	
	КонецЕсли;
	
	Возврат ОстатокНаСчете;
	
КонецФункции
