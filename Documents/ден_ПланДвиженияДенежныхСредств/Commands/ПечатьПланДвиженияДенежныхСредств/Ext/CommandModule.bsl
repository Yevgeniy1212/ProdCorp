
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ДокументПланДДС = ПараметрКоманды;
	МассивДокументов = Новый Массив;
	МассивДокументов.Добавить(ДокументПланДДС);
	
	ПроверкаПроведенияПередПечатью = НЕ фин_ОбщегоНазначенияВызовСервераПовтИсп.ЕстьДополнительноеПравоПользователя("ПечатьНепроведенныхДокументов");
										
	Если ПроверкаПроведенияПередПечатью Тогда
		НепроведенныеДокументы = ОбщегоНазначенияВызовСервера.ПроверитьПроведенностьДокументов(МассивДокументов);
		ЕстьНепроведенныеДокументы = НепроведенныеДокументы.Количество() > 0;
		Если ЕстьНепроведенныеДокументы Тогда
			ДополнительныеПараметры = Новый Структура;
			ДополнительныеПараметры.Вставить("НепроведенныеДокументы", НепроведенныеДокументы);
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	ПараметрыФормирования = ПолучитьПараметрыФормирования(ДокументПланДДС);
	ОткрытьФорму("Отчет.ден_ПланыДвиженияДенежныхСредств.ФормаОбъекта",ПараметрыФормирования,,ДокументПланДДС);

КонецПроцедуры

&НаСервере
Функция ПолучитьПараметрыФормирования(ДокументПланДДС)

	ЗначенияРеквизитов = ОбщегоНазначения.ПолучитьЗначенияРеквизитов(ДокументПланДДС, "Сценарий, Организация, ПериодПланирования"); 	
	
	ЗначенияПараметров = Новый Структура;
	
	ЗначенияПараметров.Вставить("Организация", ЗначенияРеквизитов.Организация);
	ЗначенияПараметров.Вставить("НачалоПериода", ЗначенияРеквизитов.ПериодПланирования);
	
	КонецПериода = фин_ПроцедурыМеханизмовБюджетированияКлиентСервер.ПолучитьГоризонтПланирования(ЗначенияРеквизитов.ПериодПланирования, ЗначенияРеквизитов.Сценарий);
	ЗначенияПараметров.Вставить("КонецПериода", КонецПериода);
	
	СтруктураОтбора = Новый Структура("ДокументПланирования, Сценарий", ДокументПланДДС, ЗначенияРеквизитов.Сценарий);
	ЗначенияПараметров.Вставить("Отбор", СтруктураОтбора);
	
	ЗначенияПараметров.Вставить("КлючНазначенияИспользования",	ДокументПланДДС);
	ЗначенияПараметров.Вставить("СформироватьПриОткрытии",		Истина);
	ЗначенияПараметров.Вставить("ВосстанавливатьНастройки",		Ложь);
	
	Возврат ЗначенияПараметров;

КонецФункции 


 

