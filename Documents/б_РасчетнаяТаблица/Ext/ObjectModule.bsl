////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ

Перем мВалютаРегламентированногоУчета Экспорт;
Перем мРассчитыватьЗависимыеОбороты Экспорт;
Перем мТаблицаЗависимостей;
#Если Клиент Тогда
	
Функция ОбщаяШапкаИПодвал(Параметр)
	Макет = ПолучитьМакет("ОбщаяШапкаИПодвал");
	
	Если Параметр = "Шапка" Тогда
		
		ОбластьМакета = Макет.ПолучитьОбласть("ОбщаяШапка");
		ОбластьМакета.Параметры.СсылкаНаДок                   = Ссылка;
		ОбластьМакета.Параметры.Форма1БОили2БО                = ФормируемыйБюджет;
		ОбластьМакета.Параметры.Подразделение                 = ПодразделениеОрганизации;
		ОбластьМакета.Параметры.ПериодПланирования            = ДополнительныеПоБюджетированию.ПолучитьНадписьПериодаСтрокой(ПериодПланирования,Сценарий);;
		ОбластьМакета.Параметры.ОсновнойКорректировка         = ?(ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Бюджет, "Основной", "Корректировка");
		ОбластьМакета.Параметры.КодИНаименованиеСтатьиБюджета = Строка(СтатьяБюджета.КодСтрокиБюджета) + " " + Строка(СтатьяБюджета.Наименование);
	КонецЕсли;
	
	Если Параметр = "Подвал" Тогда
		
		ОбластьМакета = Макет.ПолучитьОбласть("Подвал");
		ОбластьМакета.Параметры.ДолжностьАвтор          = ПроцедурыУправленияПерсоналом.ДанныеДолжности(Организация, Автор.ФизЛицо,                          Дата).Должность;			
		ОбластьМакета.Параметры.ФИОАвтор	            = ПроцедурыУправленияПерсоналом.ДанныеФизЛица(  Организация, Автор.ФизЛицо,                          Дата).Представление;	
		ОбластьМакета.Параметры.ДолжностьДД             = ПроцедурыУправленияПерсоналом.ДанныеДолжности(Организация, ДиректорДепартаментаДляПодписи.ФизЛицо, Дата).Должность;			
		ОбластьМакета.Параметры.ФИОДиректорДепартамента	= ПроцедурыУправленияПерсоналом.ДанныеФизЛица(  Организация, ДиректорДепартаментаДляПодписи.ФизЛицо, Дата).Представление;						
		
	//	ОбластьМакета = Макет.ПолучитьОбласть("ОбщийПодвал");
	//	
	//	ОбластьМакета.Параметры.ДолжностьАвтор = ПроцедурыУправленияПерсоналом.ДанныеДолжности(Организация, Автор.ФизЛицо, Дата).Должность;			
	//	ОбластьМакета.Параметры.ФИОАвтор	   = ПроцедурыУправленияПерсоналом.ДанныеФизЛица(Организация, Автор.ФизЛицо, Дата).Представление;	
	//	ОбластьМакета.Параметры.ДатаРеестра	   = Дата;					
	//	
	//	Если Отметка_ДиректорДепартамента Тогда
	//		ОбластьМакета.Параметры.ДолжностьДД             = ПроцедурыУправленияПерсоналом.ДанныеДолжности(Организация, ДиректорДепартамента.ФизЛицо, Дата).Должность;			
	//		ОбластьМакета.Параметры.ФИОДиректорДепартамента	= ПроцедурыУправленияПерсоналом.ДанныеФизЛица(Организация, ДиректорДепартамента.ФизЛицо, Дата).Представление;						
	//		ОбластьМакета.Параметры.ВремяПодписания1		= Время_ДиректорДепартамента;					
	//	КонецЕсли;
	//
	//	
	//	Если Отметка_УправляющийДиректор Тогда
	//		ОбластьМакета.Параметры.ДолжностьУД             = ПроцедурыУправленияПерсоналом.ДанныеДолжности(Организация, УправляющийДиректор.ФизЛицо, Дата).Должность;			
	//		ОбластьМакета.Параметры.ФИОУправляющийДиректор	= ПроцедурыУправленияПерсоналом.ДанныеФизЛица(Организация, УправляющийДиректор.ФизЛицо, Дата).Представление;						
	//		ОбластьМакета.Параметры.ВремяПодписания2		= Время_УправляющийДиректор;					
	//	КонецЕсли;
	//	
	//	
	//	Если Проверено Тогда
	//		ОбластьМакета.Параметры.ФИОПроверено			= ПроцедурыУправленияПерсоналом.ДанныеФизЛица(Организация, ФИО_Проверено.ФизЛицо, Дата).Представление;				
	//		ОбластьМакета.Параметры.ВремяПодписания3		= Время_Проверно;					
	//	КонецЕсли;
	//	
	//	
	//	Если Согласован Тогда
	//		ОбластьМакета.Параметры.ФИОСогласовано			= ПроцедурыУправленияПерсоналом.ДанныеФизЛица(Организация, ФИО_Согласован.ФизЛицо, Дата).Представление;				
	//		ОбластьМакета.Параметры.ВремяПодписания4		= Время_Согласован;					
	//	КонецЕсли;
	//	
	КонецЕсли;
	
	Возврат ОбластьМакета;
КонецФункции
	
// Функция формирует табличный документ 
//
// Параметры: 
//  Нет.
//
// Возвращаемое значение:
//  Табличный документ по форме З-8.
//
Функция Печатьтаблицы(ТабДокумент,имяМакета)
	
	Запрос = Новый Запрос;
	ЗапросКСтатьям = Новый Запрос;
	ЗапросМасло = Новый Запрос;
	
	Запрос.УстановитьПараметр("ТекущийДокумент", ЭтотОбъект.Ссылка);
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	Организация,
	|	б_РасчетнаяТаблица.ФормируемыйБюджет КАК ФормируемыйБюджет,
	|	б_РасчетнаяТаблица.Сценарий КАК Сценарий,
	|	б_РасчетнаяТаблица.СтатьяБюджета КАК СтатьяБюджета,
	|	б_РасчетнаяТаблица.ПериодПланирования КАК ПериодПланирования
	|ИЗ
	|	Документ.б_РасчетнаяТаблица КАК б_РасчетнаяТаблица
	|ГДЕ
	|	б_РасчетнаяТаблица.ссылка = &ТекущийДокумент
	|";
	
	ЗапросШапка = Запрос.Выполнить().Выбрать();
	
	ЗапросШапка.Следующий();
	
	СписокВидовАмортизация = новый СписокЗначений;
	СписокВидовАмортизация.Добавить(Перечисления.б_ВидыРасчетныхТаблиц.АмортизацияНМА);
	СписокВидовАмортизация.Добавить(Перечисления.б_ВидыРасчетныхТаблиц.АмортизацияОС);
	СписокВидовАмортизация.Добавить(Перечисления.б_ВидыРасчетныхТаблиц.НалогНаИмущество);

	
 	ЗапросКСтатьям.УстановитьПараметр("ТекущийДокумент", ЭтотОбъект.Ссылка);
	ЗапросКСтатьям.УстановитьПараметр("СписокВидовАмортизация", СписокВидовАмортизация);
	ЗапросКСтатьям.Текст =
	"ВЫБРАТЬ
	|	б_РасчетнаяТаблица.НомерСтроки,
	|	ВЫБОР
	|		КОГДА б_РасчетнаяТаблица.Ссылка.ВидРасчетнойТаблицы В (&СписокВидовАмортизация)
	|			ТОГДА б_РасчетнаяТаблица.ОС
	|		ИНАЧЕ б_РасчетнаяТаблица.Номенклатура
	|	КОНЕЦ КАК Номенклатура,
	|	б_РасчетнаяТаблица.СтатьяБюджета,
	|	б_РасчетнаяТаблица.ОС,
	|	б_РасчетнаяТаблица.арЦена,
	|	б_РасчетнаяТаблица.арКоличествоШтатныхЕдиниц,
	|	б_РасчетнаяТаблица.арКоличествоКвМетровНаЧеловека,
	|	б_РасчетнаяТаблица.комДолжность,
	|	б_РасчетнаяТаблица.комЦельКомандировки,
	|	б_РасчетнаяТаблица.комКоличествоЧеловек,
	|	б_РасчетнаяТаблица.комКоличествоКомандировок,
	|	б_РасчетнаяТаблица.комКоличествоДней,
	|	б_РасчетнаяТаблица.комСрокКомандировки,
	|	б_РасчетнаяТаблица.комПроезд,
	|	б_РасчетнаяТаблица.комПроживание,
	|	б_РасчетнаяТаблица.комСуточные,
	|	б_РасчетнаяТаблица.НормаРасходаВДень,
	|	б_РасчетнаяТаблица.кЧислоДнейМесяца,
	|	б_РасчетнаяТаблица.ктариф,
	|	б_РасчетнаяТаблица.НормаРасходаНа100КмВЛетнееВремя,
	|	б_РасчетнаяТаблица.НормаРасходаНа100КмВЗимнееВремя,
	|	б_РасчетнаяТаблица.ПробегВДень,
	|	б_РасчетнаяТаблица.ЧислоДнейМесяца,
	|	б_РасчетнаяТаблица.ЦенаЗаЛитр,
	|	б_РасчетнаяТаблица.Количество,
	|	б_РасчетнаяТаблица.Цена,
	|	б_РасчетнаяТаблица.Сумма КАК Сумма,
	|	б_РасчетнаяТаблица.КонтрольнаяСумма КАК КонтрольнаяСумма,
	|	б_РасчетнаяТаблица.Сумма1 КАК Сумма1,
	|	б_РасчетнаяТаблица.Сумма2 КАК Сумма2,
	|	б_РасчетнаяТаблица.Сумма3 КАК Сумма3,
	|	б_РасчетнаяТаблица.Сумма4 КАК Сумма4,
	|	б_РасчетнаяТаблица.Сумма5 КАК Сумма5,
	|	б_РасчетнаяТаблица.Сумма6 КАК Сумма6,
	|	б_РасчетнаяТаблица.Сумма7 КАК Сумма7,
	|	б_РасчетнаяТаблица.Сумма8 КАК Сумма8,
	|	б_РасчетнаяТаблица.Сумма9 КАК Сумма9,
	|	б_РасчетнаяТаблица.Сумма10 КАК Сумма10,
	|	б_РасчетнаяТаблица.Сумма11 КАК Сумма11,
	|	б_РасчетнаяТаблица.Сумма12 КАК Сумма12,
	|	б_РасчетнаяТаблица.Сумма1 + б_РасчетнаяТаблица.Сумма2 + б_РасчетнаяТаблица.Сумма3 КАК Сумма1кв,
	|	б_РасчетнаяТаблица.Сумма4 + б_РасчетнаяТаблица.Сумма5 + б_РасчетнаяТаблица.Сумма6 КАК Сумма2кв,
	|	б_РасчетнаяТаблица.Сумма7 + б_РасчетнаяТаблица.Сумма8 + б_РасчетнаяТаблица.Сумма9 КАК Сумма3кв,
	|	б_РасчетнаяТаблица.Сумма10 + б_РасчетнаяТаблица.Сумма11 + б_РасчетнаяТаблица.Сумма12 КАК Сумма4кв,
	|	б_РасчетнаяТаблица.Сумма1 + б_РасчетнаяТаблица.Сумма2 + б_РасчетнаяТаблица.Сумма3 + б_РасчетнаяТаблица.Сумма4 + б_РасчетнаяТаблица.Сумма5 + б_РасчетнаяТаблица.Сумма6 КАК СуммаПолугодие,
	|	б_РасчетнаяТаблица.Сумма1 + б_РасчетнаяТаблица.Сумма2 + б_РасчетнаяТаблица.Сумма3 + б_РасчетнаяТаблица.Сумма4 + б_РасчетнаяТаблица.Сумма5 + б_РасчетнаяТаблица.Сумма6 + б_РасчетнаяТаблица.Сумма7 + б_РасчетнаяТаблица.Сумма8 + б_РасчетнаяТаблица.Сумма9 КАК СуммаДевятьМесяцев,
	|	б_РасчетнаяТаблица.ФИООбучаемого,
	|	б_РасчетнаяТаблица.НМА
	|ИЗ
	|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК б_РасчетнаяТаблица
	|ГДЕ
	|	б_РасчетнаяТаблица.Ссылка = &ТекущийДокумент
	|	И (б_РасчетнаяТаблица.Сумма1 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма2 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма3 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма4 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма5 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма6 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма7 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма8 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма9 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма10 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма11 <> 0
	|			ИЛИ б_РасчетнаяТаблица.Сумма12 <> 0)
	|ИТОГИ
	|	СУММА(Сумма),
	|	СУММА(КонтрольнаяСумма),
	|	СУММА(Сумма1),
	|	СУММА(Сумма2),
	|	СУММА(Сумма3),
	|	СУММА(Сумма4),
	|	СУММА(Сумма5),
	|	СУММА(Сумма6),
	|	СУММА(Сумма7),
	|	СУММА(Сумма8),
	|	СУММА(Сумма9),
	|	СУММА(Сумма10),
	|	СУММА(Сумма11),
	|	СУММА(Сумма12),
	|	СУММА(Сумма1кв),
	|	СУММА(Сумма2кв),
	|	СУММА(Сумма3кв),
	|	СУММА(Сумма4кв),
	|	СУММА(СуммаПолугодие),
	|	СУММА(СуммаДевятьМесяцев)
	|ПО
	|	ОБЩИЕ";	
	
	Результат = ЗапросКСтатьям.Выполнить();
	
 	ЗапросМасло.УстановитьПараметр("ТекущийДокумент", ЭтотОбъект.Ссылка);
	
	ЗапросМасло.Текст =
	"ВЫБРАТЬ
	|		б_РасчетнаяТаблица.НомерСтроки,
	|		б_РасчетнаяТаблица.Номенклатура,
	|		б_РасчетнаяТаблица.ОС,
	|		б_РасчетнаяТаблица.Количество,
	|		б_РасчетнаяТаблица.НормаРасходаНа100КмВЛетнееВремя,
	|		б_РасчетнаяТаблица.НормаРасходаНа100КмВЗимнееВремя,
	|		б_РасчетнаяТаблица.ЦенаЗалитр,
	|		б_РасчетнаяТаблица.КонтрольнаяСумма,
	|		б_РасчетнаяТаблица.Сумма1,
	|		б_РасчетнаяТаблица.Сумма2,
	|		б_РасчетнаяТаблица.Сумма3,
	|		б_РасчетнаяТаблица.Сумма4,
	|		б_РасчетнаяТаблица.Сумма5,
	|		б_РасчетнаяТаблица.Сумма6,
	|		б_РасчетнаяТаблица.Сумма7,
	|		б_РасчетнаяТаблица.Сумма8,
	|		б_РасчетнаяТаблица.Сумма9,
	|		б_РасчетнаяТаблица.Сумма10,
	|		б_РасчетнаяТаблица.Сумма11,
	|		б_РасчетнаяТаблица.Сумма12,
	|		б_РасчетнаяТаблица.Сумма1+б_РасчетнаяТаблица.Сумма2+б_РасчетнаяТаблица.Сумма3 КАК Сумма1кв,
	|		б_РасчетнаяТаблица.Сумма4+б_РасчетнаяТаблица.Сумма5+б_РасчетнаяТаблица.Сумма6 КАК Сумма2кв,
	|		б_РасчетнаяТаблица.Сумма7+б_РасчетнаяТаблица.Сумма7+б_РасчетнаяТаблица.Сумма9 КАК Сумма3кв,
	|		б_РасчетнаяТаблица.Сумма10+б_РасчетнаяТаблица.Сумма11+б_РасчетнаяТаблица.Сумма12 КАК Сумма4кв,
	|		б_РасчетнаяТаблица.Сумма1+б_РасчетнаяТаблица.Сумма2+б_РасчетнаяТаблица.Сумма3+б_РасчетнаяТаблица.Сумма4+б_РасчетнаяТаблица.Сумма5+б_РасчетнаяТаблица.Сумма6 КАК СуммаПолугодие,
	|		б_РасчетнаяТаблица.Сумма1+б_РасчетнаяТаблица.Сумма2+б_РасчетнаяТаблица.Сумма3+б_РасчетнаяТаблица.Сумма4+б_РасчетнаяТаблица.Сумма5+б_РасчетнаяТаблица.Сумма6+б_РасчетнаяТаблица.Сумма7+б_РасчетнаяТаблица.Сумма7+б_РасчетнаяТаблица.Сумма9 КАК СуммаДевятьМесяцев
	|ИЗ
	|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК б_РасчетнаяТаблица
	|ГДЕ
	|	б_РасчетнаяТаблица.ссылка = &ТекущийДокумент
	|Итоги 	
	|		Сумма(КонтрольнаяСумма),
	|		Сумма(Сумма1кв),
	|		Сумма(Сумма2кв),
	|		Сумма(Сумма3кв),
	|		Сумма(Сумма4кв),
	|		Сумма(СуммаПолугодие),
	|		Сумма(СуммаДевятьМесяцев),
	|		Сумма(Сумма1),
	|		Сумма(Сумма2),
	|		Сумма(Сумма3),
	|		Сумма(Сумма4),
	|		Сумма(Сумма5),
	|		Сумма(Сумма6),
	|		Сумма(Сумма7),
	|		Сумма(Сумма8),
	|		Сумма(Сумма9),
	|		Сумма(Сумма10),
	|		Сумма(Сумма11),
	|		Сумма(Сумма12)
	|ПО Общие
	|";	
	
	РезультатМасло = ЗапросМасло.Выполнить();
	
	Макет = ПолучитьМакет(ИмяМакета);
	
	// Зададим параметры макета
	ТабДокумент.ПолеСверху         = 0;
	ТабДокумент.ПолеСлева          = 10;
	ТабДокумент.ПолеСнизу          = 0;
	ТабДокумент.ПолеСправа         = 0;
    ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_РасчетнаяТаблица";
	
	// Выводим шапку накладной
	Отбор = СокрЛП(ЗапросШапка.СтатьяБюджета.КодСтрокиБюджета)+" :"+СокрЛП(ЗапросШапка.СтатьяБюджета);
	
	ТабДокумент.Вывести(ОбщаяШапкаИПодвал("Шапка"));
	
	//ОбластьМакета = Макет.ПолучитьОбласть("Заголовок");
	//ОбластьМакета.Параметры.ТекстЗаголовка = СокрЛП(ЗапросШапка.ФормируемыйБюджет)+" :"+ДополнительныеПоБюджетированию.ПолучитьНадписьПериодаСтрокой(ЗапросШапка.ПериодПланирования,ЗапросШапка.Сценарий);
	//ОбластьМакета.Параметры.Отбор = Отбор;
	//
	//ТабДокумент.Вывести(ОбластьМакета);

	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	ТабДокумент.Вывести(ОбластьМакета);
	
	ВыборкаОбщийИтог = РЕзультат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам,"Общие");
    ВыборкаОбщийИтог.Следующий();
	
	ОбластьМакета = Макет.ПолучитьОбласть("Строка");
	
	Выборка = ВыборкаОбщийИтог.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	Пока Выборка.Следующий() Цикл
		ОбластьМакета.Параметры.Заполнить(Выборка);
		ТабДокумент.Вывести(ОбластьМакета);
	КонецЦикла;
	
	ОбластьМакета = Макет.ПолучитьОбласть("Итог");
	ОбластьМакета.Параметры.Заполнить(ВыборкаОбщийИтог);
	
	ТабДокумент.Вывести(ОбластьМакета);
	
	ТабДокумент.Вывести(ОбщаяШапкаИПодвал("Подвал"));
	
	Если ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ГСМ Тогда
		// Выводим шапку накладной
		Отбор = СокрЛП(ЗапросШапка.СтатьяБюджета.КодСтрокиБюджета)+" :"+СокрЛП(ЗапросШапка.СтатьяБюджета)+" Масло";
		
		ОбластьМакета = Макет.ПолучитьОбласть("Заголовок1");
		ОбластьМакета.Параметры.ТекстЗаголовка = СокрЛП(ЗапросШапка.ФормируемыйБюджет)+" :"+ДополнительныеПоБюджетированию.ПолучитьНадписьПериодаСтрокой(ЗапросШапка.ПериодПланирования,ЗапросШапка.Сценарий);
		ОбластьМакета.Параметры.Отбор = Отбор;
		
		ТабДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Шапка1");
		ТабДокумент.Вывести(ОбластьМакета);
		
		ВыборкаОбщийИтог = РезультатМасло.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам,"Общие");
		ВыборкаОбщийИтог.Следующий();
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка1");
		
		Выборка = ВыборкаОбщийИтог.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		Пока Выборка.Следующий() Цикл
			ОбластьМакета.Параметры.Заполнить(Выборка);
			ТабДокумент.Вывести(ОбластьМакета);
		КонецЦикла;
		
		ОбластьМакета = Макет.ПолучитьОбласть("Итог1");
		ОбластьМакета.Параметры.Заполнить(ВыборкаОбщийИтог);
		
		ТабДокумент.Вывести(ОбластьМакета);
	Конецесли;
	
	
	
	Возврат ТабДокумент;

КонецФункции // ПечатьБронирование()

Функция ПечатьтаблицыПовышениеКвалификации(ТабДокумент,имяМакета)
	
	Запрос = Новый Запрос;
	ЗапросКСтатьям = Новый Запрос;
	
	Запрос.УстановитьПараметр("ТекущийДокумент", ЭтотОбъект.Ссылка);
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	Организация,
	|	б_РасчетнаяТаблица.ФормируемыйБюджет КАК ФормируемыйБюджет,
	|	б_РасчетнаяТаблица.Сценарий КАК Сценарий,
	|	б_РасчетнаяТаблица.СтатьяБюджета КАК СтатьяБюджета,
	|	б_РасчетнаяТаблица.ПериодПланирования КАК ПериодПланирования
	|ИЗ
	|	Документ.б_РасчетнаяТаблица КАК б_РасчетнаяТаблица
	|ГДЕ
	|	б_РасчетнаяТаблица.ссылка = &ТекущийДокумент
	|";
	
	ЗапросШапка = Запрос.Выполнить().Выбрать();
	
	ЗапросШапка.Следующий();
	
	
 	ЗапросКСтатьям.УстановитьПараметр("ТекущийДокумент", ЭтотОбъект.Ссылка);
	
	ЗапросКСтатьям.Текст =
	"ВЫБРАТЬ
	|	б_РасчетнаяТаблица.Номенклатура,
	|	б_РасчетнаяТаблица.пвНаименованиеСеминара,
	|	б_РасчетнаяТаблица.пвМестоПроведения,
	|	б_РасчетнаяТаблица.пвКонтрагент,
	|	б_РасчетнаяТаблица.пвМесяцПроведения,
	|	б_РасчетнаяТаблица.пвПодразделение КАК Подразделение,
	|	б_РасчетнаяТаблица.комДолжность,
	|	б_РасчетнаяТаблица.ФИООбучаемого,
	|	б_РасчетнаяТаблица.комКоличествоДней,
	|	б_РасчетнаяТаблица.пвПериодПроведения,
	|	б_РасчетнаяТаблица.КонтрольнаяСумма КАК КонтрольнаяСумма
	|ИЗ
	|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК б_РасчетнаяТаблица
	|ГДЕ
	|	б_РасчетнаяТаблица.Ссылка = &ТекущийДокумент
	|ИТОГИ
	|	СУММА(КонтрольнаяСумма)
	|ПО
	|	ОБЩИЕ,
	|	Подразделение";	
	
	Результат = ЗапросКСтатьям.Выполнить();
	
	Макет = ПолучитьМакет(ИмяМакета);
	
	// Зададим параметры макета
	ТабДокумент.ПолеСверху         = 0;
	ТабДокумент.ПолеСлева          = 10;
	ТабДокумент.ПолеСнизу          = 0;
	ТабДокумент.ПолеСправа         = 0;
    ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_РасчетнаяТаблица";
	
	// Выводим шапку накладной
	Отбор = СокрЛП(ЗапросШапка.СтатьяБюджета.КодСтрокиБюджета)+" :"+СокрЛП(ЗапросШапка.СтатьяБюджета);
	
	ТабДокумент.Вывести(ОбщаяШапкаИПодвал("Шапка"));
	
	ОбластьМакета = Макет.ПолучитьОбласть("Заголовок");
	ОбластьМакета.Параметры.ТекстЗаголовка = СокрЛП(ЗапросШапка.ФормируемыйБюджет)+" :"+ДополнительныеПоБюджетированию.ПолучитьНадписьПериодаСтрокой(ЗапросШапка.ПериодПланирования,ЗапросШапка.Сценарий);
	ОбластьМакета.Параметры.Отбор = Отбор;
	
	ТабДокумент.Вывести(ОбластьМакета);

	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	ТабДокумент.Вывести(ОбластьМакета);
	
	ВыборкаОбщийИтог = РЕзультат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам,"Общие");
    ВыборкаОбщийИтог.Следующий();
	
	ОбластьМакета = Макет.ПолучитьОбласть("Строка");
	ОбластьМакетаПодразделение = Макет.ПолучитьОбласть("Подразделение");
	
	ВыборкаПодразделение = ВыборкаОбщийИтог.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	Пока ВыборкаПодразделение.Следующий() Цикл
		ОбластьМакетаПодразделение.Параметры.Заполнить(ВыборкаПодразделение);
		ТабДокумент.Вывести(ОбластьМакетаПодразделение);
		
		Выборка = ВыборкаПодразделение.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		Пока Выборка.Следующий() Цикл
			ОбластьМакета.Параметры.Заполнить(Выборка);
			ТабДокумент.Вывести(ОбластьМакета);
		КонецЦикла;
	КонецЦикла;
	
	ОбластьМакета = Макет.ПолучитьОбласть("Итог");
	ОбластьМакета.Параметры.Заполнить(ВыборкаОбщийИтог);
	
	ТабДокумент.Вывести(ОбластьМакета);
	
	ТабДокумент.Вывести(ОбщаяШапкаИПодвал("Подвал"));
	
	Возврат ТабДокумент;

КонецФункции // Печать()

////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ ДОКУМЕНТА

// Процедура осуществляет печать документа. Можно направить печать на 
// экран или принтер, а также распечатать необходмое количество копий.
//
//  Название макета печати передается в качестве параметра,
// по переданному названию находим имя макета в соответствии.
//
// Параметры:
//  НазваниеМакета - строка, название макета.
//
Процедура Печать(ИмяМакета, КоличествоЭкземпляров = 1, НаПринтер = Ложь) Экспорт

	Если ЭтоНовый() Тогда
		Предупреждение("Документ можно распечатать только после его записи");
		Возврат;
	ИначеЕсли Не УправлениеПользователями.РазрешитьПечатьНепроведенныхДокументов(Проведен) Тогда
		Предупреждение("Недостаточно полномочий для печати непроведенного документа!");
		Возврат;
	КонецЕсли;
	
	Если Не РаботаСДиалогами.ПроверитьМодифицированность(ЭтотОбъект) Тогда
		Возврат;
	КонецЕсли;

	// Получить экземпляр документа на печать
	Если ИмяМакета = "Макет" Тогда
		Если ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ГСМ  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"ГСМ");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Командировочные  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"Командировочные");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ТМЦ  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"ТМЦ");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ТМЦНаОС  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"ТМЦНаОС");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ПовышениеКвалификации  Тогда
			ТабДокумент = ПечатьТаблицыПовышениеКвалификации( Новый ТабличныйДокумент,"ПовышениеКвалификации");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Аренда  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"Аренда");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Коммунальные  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"Коммунальные");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета
			ИЛИ ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Зарплата Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"ПоГруппеСтатейБюджета");
		Иначе
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"Макет");
		Конецесли;
	ИначеЕсли ИмяМакета = "Квартал" Тогда
		Если ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ГСМ  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"ГСМКвартал");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Командировочные  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"КомандировочныеКвартал");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ТМЦ  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"ТМЦКвартал");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ТМЦНаОС  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"ТМЦНаОСКвартал");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Командировочные  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"КомандировочныеКвартал");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Аренда  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"АрендаКвартал");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Коммунальные  Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"КоммунальныеКвартал");
		ИначеЕсли ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета
			ИЛИ ВидРасчетнойТаблицы = Перечисления.б_ВидыРасчетныхТаблиц.Зарплата Тогда
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"ПоГруппеСтатейБюджетаКвартал");
		Иначе
			ТабДокумент = ПечатьТаблицы( Новый ТабличныйДокумент,"МакетКвартал");
		Конецесли;
	КонецЕсли;

	УниверсальныеМеханизмы.НапечататьДокумент(ТабДокумент, КоличествоЭкземпляров, НаПринтер, РаботаСДиалогами.СформироватьЗаголовокДокумента(ЭтотОбъект, ЭтотОбъект.Метаданные().Представление()));
                                                                                                                                                    
КонецПроцедуры // Печать

#КонецЕсли

Функция ПолучитьБазовыеСтатьи(ТекСтатья) экспорт
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("Конецпериода",КонецГода(периодПланирования));
	Запрос.УстановитьПараметр("ТекДокумент",ЭтотОбъект.Ссылка);
	Запрос.УстановитьПараметр("Бюджет",ФормируемыйБюджет);
	Запрос.УстановитьПараметр("СтатьяБюджета",ТекСтатья);
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	б_БазовыеВидыСтатейПоОплатеСрезПоследних.БазоваяСтатьяБюджета,
	|	б_БазовыеВидыСтатейПоОплатеСрезПоследних.Ставка,
	|	РасчетнаяТаблицаДоп.ПорядковыйНомерПоказателя КАК ПорядковыйНомерПоказателя
	|ИЗ
	|	РегистрСведений.б_БазовыеВидыСтатейПоОплате.СрезПоследних(&КонецПериода, бюджет = &Бюджет И СтатьяБюджета = &сТАТЬЯбЮДЖЕТА) КАК б_БазовыеВидыСтатейПоОплатеСрезПоследних
	|Внутреннее Соединение
	|	(ВЫБРАТЬ
	|		РасчетнаяТаблица.СтатьяБюджета,
	|		РасчетнаяТаблица.ПорядковыйНомерПоказателя КАК ПорядковыйНомерПоказателя
	|	ИЗ
	|   	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК РасчетнаяТаблица
	|	ГДЕ
	|   	РасчетнаяТаблица.ссылка = &ТекДокумент
	|   )  РасчетнаяТаблицаДоп
	|	ПО 
	|   	РасчетнаяТаблицаДоп.СтатьяБюджета = б_БазовыеВидыСтатейПоОплатеСрезПоследних.БазоваяСтатьяБюджета
	|";
	
	тз = Запрос.Выполнить().Выгрузить();
	
	Возврат тз;
	
КонецФункции

Процедура РассчитатьФОТ(ТекущаяСтрокаРасчТаблицы) Экспорт
	
	ТекущаяСтрокаРасчТаблицы.СуммаФОТ = 0;
	Для А = 1 по 12 Цикл
		ТекущаяСтрокаРасчТаблицы.СуммаФОТ = ТекущаяСтрокаРасчТаблицы.СуммаФОТ + ТекущаяСтрокаРасчТаблицы["Сумма"+СокрЛП(А)];
	КонецЦикла;
КонецПроцедуры

Процедура РассчитатьМатПомощь() Экспорт
	
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("Конецпериода",КонецГода(периодПланирования));
	Запрос.УстановитьПараметр("ТекДокумент",ЭтотОбъект.Ссылка);
	Запрос.УстановитьПараметр("Бюджет",ФормируемыйБюджет);
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	б_БазовыеВидыСтатейПоОплатеСрезПоследних.СтатьяБюджета,
	|	б_БазовыеВидыСтатейПоОплатеСрезПоследних.Ставка,
	|	РасчетнаяТаблицаДоп.ПорядковыйНомерПоказателя КАК ПорядковыйНомерПоказателя
	|ИЗ
	|	РегистрСведений.б_БазовыеВидыСтатейПоОплате.СрезПоследних(&КонецПериода, бюджет = &Бюджет ) КАК б_БазовыеВидыСтатейПоОплатеСрезПоследних
	|
	|Внутреннее Соединение
	|	(ВЫБРАТЬ
	|		РасчетнаяТаблица.СтатьяБюджета,
	|		РасчетнаяТаблица.ПорядковыйНомерПоказателя КАК ПорядковыйНомерПоказателя
	|	ИЗ
	|   	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК РасчетнаяТаблица
	|	ГДЕ
	|   	РасчетнаяТаблица.ссылка = &ТекДокумент
	|   )  РасчетнаяТаблицаДоп
	|	ПО 
	|   	РасчетнаяТаблицаДоп.СтатьяБюджета = б_БазовыеВидыСтатейПоОплатеСрезПоследних.СтатьяБюджета
	|";
	
	Результат = Запрос.Выполнить().Выбрать();
	
	Пока Результат.Следующий() Цикл
		ТекСтатья = Результат.СтатьяБюджета;
		
		тз = ПолучитьБазовыеСтатьи(ТекСтатья);
		
		Для Каждого СтрокаТЧ ИЗ Зарплата Цикл
			СтрокаТЧ["Сумма"+Результат.ПорядковыйНомерПоказателя] = 0;
			РасчСумма =0;
			Для Каждого СтрокаТЗ из ТЗ Цикл
				РасчСумма = РасчСумма + СтрокаТЧ["Сумма"+СтрокаТЗ.ПорядковыйНомерПоказателя]*СтрокаТЗ.Ставка/100;
			КонецЦикла;
			СтрокаТЧ["Сумма"+Результат.ПорядковыйНомерПоказателя] = РасчСумма;
			РассчитатьФОТ(СтрокаТЧ);
		КонецЦикла;
		
	КонецЦИкла;
КонецПроцедуры

Процедура ПерерасчетФОТ(ЭтотОбъект,Параметры) Экспорт
	
	//КоэффициентПерерасчета = Параметры.КоэффициентПерерасчета;
	ПериодПерерасчета = Параметры.ПериодПерерасчета;
	
	Если ЗНАЧЕНИЕЗАПОЛНЕНО(ПериодПерерасчета) Тогда
		
		Для Каждого СтрокаТЧ ИЗ Зарплата Цикл
			Если НЕ ЗНАЧЕНИЕЗАПОЛНЕНО(СтрокаТЧ.ДолжностнойОкладПлановый) Тогда
				Продолжить;
			КонецЕсли;
			
			СтрокаТЧ.Сумма1 = (Месяц(ПериодПерерасчета)-1)*(СтрокаТЧ.КоличествоСтавок*СтрокаТЧ.ДолжностнойОклад)
			+(13-Месяц(ПериодПерерасчета))*(СтрокаТЧ.КоличествоСтавок*СтрокаТЧ.ДолжностнойОкладПлановый);
			
			ДополнительныеПоБюджетированию.РассчитатьЗависимыеВиды(ЭтотОбъект,СтрокаТЧ,"Перерасчет");
			
			РассчитатьФОТ(СтрокаТЧ);		
		КонецЦикла;
		
		РассчитатьМатПомощь();
		
		Для Каждого СтрокаТЧ ИЗ РасчетнаяТаблица Цикл
			ГодоваяСумма = Зарплата.Итог("Сумма"+СокрЛП(СтрокаТЧ.ПорядковыйНомерПоказателя));
			
			СтрокаТЧ.КонтрольнаяСумма = ГодоваяСумма;
			
			ИсключаемаяСумма = 0;
			
			НомерМесяца = Месяц(ПериодПерерасчета);
			
			Для А =1 По НомерМесяца-1 Цикл
				ИсключаемаяСумма = ИсключаемаяСумма + СтрокаТЧ["Сумма"+СокрЛП(А)];
			КонецЦикла;
			
			РаспределяемаяСумма = ГодоваяСумма - ИсключаемаяСумма;
			
			РаспределеннаяСумма = 0;
			
			Для А=НомерМесяца По 12 Цикл
				Если А = 12 Тогда
					СтрокаТЧ["Сумма"+СокрЛП(А)]= РаспределяемаяСумма - РаспределеннаяСумма;
				Иначе
					СтрокаТЧ["Сумма"+СокрЛП(А)]= Окр(РаспределяемаяСумма /(12-НомерМесяца+1),0,1);
					РаспределеннаяСумма = РаспределеннаяСумма + Окр(РаспределяемаяСумма /(12-НомерМесяца+1),0,1);
				Конецесли;
				
			КонецЦикла;
			
		КонецЦикла;
	КонецЕсли;
	
	
КонецПроцедуры

Процедура ПерерасчетФОТПоНовомуШтатному(ЭтотОбъект,Параметры) Экспорт
	
	//КоэффициентПерерасчета = Параметры.КоэффициентПерерасчета;
	ПериодПерерасчета = Параметры.ПериодПерерасчета;
	
	Если ЗНАЧЕНИЕЗАПОЛНЕНО(ПериодПерерасчета) Тогда
		
				
		
		
		Для Каждого СтрокаТЧ ИЗ Зарплата Цикл
			Если НЕ ЗНАЧЕНИЕЗАПОЛНЕНО(СтрокаТЧ.ДолжностнойОкладПлановый) Тогда
				Продолжить;
			КонецЕсли;
			
					Запрос = Новый Запрос;
				Запрос.УстановитьПараметр("Организация",Организация);
				Запрос.УстановитьПараметр("КонецПериода",КонецГода(ПериодПланирования));
				Запрос.УстановитьПараметр("НачалоПериода",НачалоГода(ПериодПланирования));
				Запрос.УстановитьПараметр("Бюджет",ФормируемыйБюджет);
				Запрос.УстановитьПараметр("СтатьяФОТ",СтатьяБюджета);
				Запрос.УстановитьПараметр("Должность",СтрокаТЧ.Должность);
				Запрос.УстановитьПараметр("ПодразделениеОрганизации",СтрокаТЧ.Подразделение);
				
					//Запрос.Текст = 
					//	"ВЫБРАТЬ
					//	|	ШтатноеРасписаниеОрганизацийСрезПоследних.ПодразделениеОрганизации КАК Подразделение,
					//	|	ШтатноеРасписаниеОрганизацийСрезПоследних.Должность КАК Должность,
					//	|	ШтатноеРасписаниеОрганизацийСрезПоследних.КоличествоСтавок КАК КоличествоСтавок,
					//	|	ШтатноеРасписаниеОрганизацийСрезПоследних.МаксимальнаяТарифнаяСтавка КАК ДолжностнойОклад
					//	|ИЗ
					//	|	РегистрСведений.ШтатноеРасписаниеОрганизаций.СрезПоследних(&КонецПериода, ) КАК ШтатноеРасписаниеОрганизацийСрезПоследних
					//	|ГДЕ
					//	|	ШтатноеРасписаниеОрганизацийСрезПоследних.ПодразделениеОрганизации В
					//	|			(ВЫБРАТЬ
					//	|				б_ЗакреплениеПодразделенийЗаСтатьямиФОТСрезПоследних.Подразделение
					//	|			ИЗ
					//	|				РегистрСведений.б_ЗакреплениеПодразделенийЗаСтатьямиФОТ.СрезПоследних(&КонецПериода, Организация = &Организация
					//	|					И Бюджет = &Бюджет
					//	|					И СтатьяФОТ = &СтатьяФОТ) КАК б_ЗакреплениеПодразделенийЗаСтатьямиФОТСрезПоследних)
					//	|	И ШтатноеРасписаниеОрганизацийСрезПоследних.КоличествоСтавок <> 0
					//	|	И ШтатноеРасписаниеОрганизацийСрезПоследних.Должность = &Должность
					//	|	И ШтатноеРасписаниеОрганизацийСрезПоследних.ПодразделениеОрганизации = &ПодразделениеОрганизации
					//	|АВТОУПОРЯДОЧИВАНИЕ";
					
					Запрос.Текст = "ВЫБРАТЬ
					               |	ШтатноеРасписаниеОрганизаций.Период,
					               |	ШтатноеРасписаниеОрганизаций.ПодразделениеОрганизации,
					               |	ШтатноеРасписаниеОрганизаций.Должность,
					               |	ШтатноеРасписаниеОрганизаций.КоличествоСтавок,
					               |	ШтатноеРасписаниеОрганизаций.МаксимальнаяТарифнаяСтавка
					               |ИЗ
					               |	РегистрСведений.ШтатноеРасписаниеОрганизаций КАК ШтатноеРасписаниеОрганизаций
					               |ГДЕ
					               |	ШтатноеРасписаниеОрганизаций.Должность = &Должность
					               |	И ШтатноеРасписаниеОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации
					               |	И ШтатноеРасписаниеОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода
					               |	И ШтатноеРасписаниеОрганизаций.ПодразделениеОрганизации В
					               |			(ВЫБРАТЬ
					               |				б_ЗакреплениеПодразделенийЗаСтатьямиФОТСрезПоследних.Подразделение
					               |			ИЗ
					               |				РегистрСведений.б_ЗакреплениеПодразделенийЗаСтатьямиФОТ.СрезПоследних(&КонецПериода, Организация = &Организация
					               |					И Бюджет = &Бюджет
					               |					И СтатьяФОТ = &СтатьяФОТ) КАК б_ЗакреплениеПодразделенийЗаСтатьямиФОТСрезПоследних)";
					Результат = Запрос.Выполнить();

					ВыборкаДетальныеЗаписи = Результат.Выбрать();

					СтарыйОклад = СтрокаТЧ.ДолжностнойОклад;
					СтарыйОкладОбщ = СтрокаТЧ.ДолжностнойОкладПлановый;
					СтароеКолвоСтавок = СтрокаТЧ.КоличествоСтавок;

					Если Результат.пустой() Тогда
						 СтрокаТЧ.ДолжностнойОклад = 0;
						 СтрокаТЧ.КоличествоСтавок = 0;
						 СтрокаТЧ.ДолжностнойОкладПлановый = 0;
					КонецЕсли;
					
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						 СтрокаТЧ.ДолжностнойОклад = ВыборкаДетальныеЗаписи.ДолжностнойОклад;
						 СтрокаТЧ.КоличествоСтавок = ВыборкаДетальныеЗаписи.КоличествоСтавок;
						 СтрокаТЧ.ДолжностнойОкладПлановый = ВыборкаДетальныеЗаписи.ДолжностнойОклад*СтрокаТЧ.КоличествоСтавокНаНачалоГода;
                 	КонецЦикла;

	        СтрокаТЧ.Сумма1 = (Месяц(ПериодПерерасчета)-1)*(СтароеКолвоСтавок*СтарыйОклад)
			+(13-Месяц(ПериодПерерасчета))*(СтрокаТЧ.КоличествоСтавок*СтрокаТЧ.ДолжностнойОклад);
			
			//СтрокаТЧ.Сумма1 = (Месяц(ПериодПерерасчета)-1)*(СтрокаТЧ.КоличествоСтавок*СтрокаТЧ.ДолжностнойОклад)
			//+(13-Месяц(ПериодПерерасчета))*(СтрокаТЧ.КоличествоСтавок*СтрокаТЧ.ДолжностнойОкладПлановый);
			
						
			ДополнительныеПоБюджетированию.РассчитатьЗависимыеВидыЗарплата(ЭтотОбъект,СтрокаТЧ,"Перерасчет", СтарыйОклад, СтароеКолвоСтавок);
			
			РассчитатьФОТ(СтрокаТЧ);		
		КонецЦикла;
		
		ДобавитьНовыеДолжности();

		РассчитатьМатПомощь();
		
		Для Каждого СтрокаТЧ ИЗ РасчетнаяТаблица Цикл
			ГодоваяСумма = Зарплата.Итог("Сумма"+СокрЛП(СтрокаТЧ.ПорядковыйНомерПоказателя));
			
			СтрокаТЧ.КонтрольнаяСумма = ГодоваяСумма;
			
			ИсключаемаяСумма = 0;
			
			НомерМесяца = Месяц(ПериодПерерасчета);
			
			Для А =1 По НомерМесяца-1 Цикл
				ИсключаемаяСумма = ИсключаемаяСумма + СтрокаТЧ["Сумма"+СокрЛП(А)];
			КонецЦикла;
			
			РаспределяемаяСумма = ГодоваяСумма - ИсключаемаяСумма;
			
			РаспределеннаяСумма = 0;
			
			КолвоПремийОсталось = 0; 
			
			Если НомерМесяца = 4 Тогда
				КолвоПремийОсталось = 3;
			ИначеЕсли НомерМесяца = 10 Тогда
				КолвоПремийОсталось = 1;
			КонецЕсли;
			
			Для А=НомерМесяца По 12 Цикл
				Если А = 12 Тогда
					СтрокаТЧ["Сумма"+СокрЛП(А)]= РаспределяемаяСумма - РаспределеннаяСумма;
				Иначе
					
					Если СтрокаТЧ.ПорядковыйНомерПоказателя = 4 Тогда
						Если А = 6 ИЛИ А = 9 ИЛИ А=12 Тогда
							СтрокаТЧ["Сумма"+СокрЛП(А)]= Окр(РаспределяемаяСумма /(КолвоПремийОсталось),0,1);
						 	РаспределеннаяСумма = РаспределеннаяСумма + Окр(РаспределяемаяСумма /(КолвоПремийОсталось),0,1);
						КонецЕсли;
						
                    Иначе
						СтрокаТЧ["Сумма"+СокрЛП(А)]= Окр(РаспределяемаяСумма /(12-НомерМесяца+1),0,1);
						РаспределеннаяСумма = РаспределеннаяСумма + Окр(РаспределяемаяСумма /(12-НомерМесяца+1),0,1);
					КонецЕсли;
					
				Конецесли;
				
			КонецЦикла;
			
		КонецЦикла;
	КонецЕсли;
	
	
КонецПроцедуры

Функция ДобавитьНовыеДолжности()
	
		ЗапросПодр = Новый Запрос;
	ЗапросПодр.Текст = 
		"ВЫБРАТЬ
		|	ПодразделенияОрганизаций.Ссылка КАК Подразделение
		|ИЗ
		|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
		|ГДЕ
		|	ПодразделенияОрганизаций.Владелец = &Организация";

	ЗапросПодр.УстановитьПараметр("Организация", Организация);

	РезультатПодр = ЗапросПодр.Выполнить();

	ВыборкаПодразделения = РезультатПодр.Выбрать();

	Пока ВыборкаПодразделения.Следующий() Цикл
		
				ЗапросДолжн = Новый Запрос;
			ЗапросДолжн.Текст = 
				"ВЫБРАТЬ
				|	б_РасчетнаяТаблицаЗарплата.Должность
				|ИЗ
				|	Документ.б_РасчетнаяТаблица.Зарплата КАК б_РасчетнаяТаблицаЗарплата
				|ГДЕ
				|	б_РасчетнаяТаблицаЗарплата.Ссылка = &Ссылка
				|	И б_РасчетнаяТаблицаЗарплата.Подразделение = &Подразделение";

			ЗапросДолжн.УстановитьПараметр("Подразделение", ВыборкаПодразделения.Подразделение);
			ЗапросДолжн.УстановитьПараметр("Ссылка", Ссылка);

			Результат = ЗапросДолжн.Выполнить();

			ВыборкаДолжности = Результат.Выбрать();
			
			СписокДолжности = Новый СписокЗначений;
			СписокДолжности.Очистить();
			
			Пока ВыборкаДолжности.Следующий() Цикл
				СписокДолжности.Добавить(ВыборкаДолжности.Должность); 		
			КонецЦикла;
              			
				Запрос = Новый Запрос;
				
				Запрос.УстановитьПараметр("Организация",Организация);
				Запрос.УстановитьПараметр("КонецПериода",КонецГода(ПериодПланирования));
				Запрос.УстановитьПараметр("Бюджет",ФормируемыйБюджет);
				Запрос.УстановитьПараметр("СтатьяФОТ",СтатьяБюджета);
				Запрос.УстановитьПараметр("Должность",СписокДолжности);
				Запрос.УстановитьПараметр("ПодразделениеОрганизации",ВыборкаПодразделения.Подразделение);
              								
					Запрос.Текст = 
						"ВЫБРАТЬ
						|	ШтатноеРасписаниеОрганизацийСрезПоследних.ПодразделениеОрганизации КАК Подразделение,
						|	ШтатноеРасписаниеОрганизацийСрезПоследних.Должность КАК Должность,
						|	ШтатноеРасписаниеОрганизацийСрезПоследних.КоличествоСтавок КАК КоличествоСтавок,
						|	ШтатноеРасписаниеОрганизацийСрезПоследних.МаксимальнаяТарифнаяСтавка КАК ДолжностнойОклад
						|ИЗ
						|	РегистрСведений.ШтатноеРасписаниеОрганизаций.СрезПоследних(&КонецПериода, ) КАК ШтатноеРасписаниеОрганизацийСрезПоследних
						|ГДЕ
						|	ШтатноеРасписаниеОрганизацийСрезПоследних.ПодразделениеОрганизации В
						|			(ВЫБРАТЬ
						|				б_ЗакреплениеПодразделенийЗаСтатьямиФОТСрезПоследних.Подразделение
						|			ИЗ
						|				РегистрСведений.б_ЗакреплениеПодразделенийЗаСтатьямиФОТ.СрезПоследних(&КонецПериода, Организация = &Организация
						|					И Бюджет = &Бюджет
						|					И СтатьяФОТ = &СтатьяФОТ) КАК б_ЗакреплениеПодразделенийЗаСтатьямиФОТСрезПоследних)
						|	И ШтатноеРасписаниеОрганизацийСрезПоследних.КоличествоСтавок <> 0
						|	И НЕ ШтатноеРасписаниеОрганизацийСрезПоследних.Должность В (&Должность)
						|	И ШтатноеРасписаниеОрганизацийСрезПоследних.ПодразделениеОрганизации = &ПодразделениеОрганизации
						|АВТОУПОРЯДОЧИВАНИЕ";

					Результат = Запрос.Выполнить();

					ВыборкаДетальныеЗаписи = Результат.Выбрать();
                 					
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						ДолжностнойОклад = ВыборкаДетальныеЗаписи.ДолжностнойОклад;
						КоличествоСтавок = ВыборкаДетальныеЗаписи.КоличествоСтавок;
						ДолжностнойОкладПлановый = ВыборкаДетальныеЗаписи.ДолжностнойОклад*ВыборкаДетальныеЗаписи.КоличествоСтавок;
						 
						НовСтрока = ЭтотОбъект.Зарплата.Добавить();
						ЗаполнитьЗначенияСвойств(НовСтрока, ВыборкаДетальныеЗаписи);
					    НовСтрока.ДолжностнойОклад = ВыборкаДетальныеЗаписи.ДолжностнойОклад;
						НовСтрока.КоличествоСтавок = ВыборкаДетальныеЗаписи.КоличествоСтавок;
						НовСтрока.ДолжностнойОкладПлановый = ВыборкаДетальныеЗаписи.ДолжностнойОклад*ВыборкаДетальныеЗаписи.КоличествоСтавок;

						НовСтрока.Сумма1 = (13-Месяц(ПериодПерерасчета))*(НовСтрока.КоличествоСтавок*НовСтрока.ДолжностнойОклад);
						
						
						ДополнительныеПоБюджетированию.РассчитатьЗависимыеВидыЗарплата(ЭтотОбъект,НовСтрока,"Перерасчет", 0, 0);
						РассчитатьФОТ(НовСтрока);	
					КонецЦикла;
					 
		 КонецЦикла;
				 

КонецФункции

Функция ПолучитьВыборку()
	
	СписокСтатейБюджета = Новый Массив;
	СписокСтатейБюджета.Добавить(СтатьяБюджета);
	Если ВидРасчетнойТаблицы = перечисления.б_ВидыРасчетныхТаблиц.Зарплата Тогда
		Для Каждого СтрокаТЧ из Налоги Цикл
			СписокСтатейБюджета.Добавить(СтрокаТЧ.СтатьяБюджета);
		КонецЦикла;
	Конецесли;
	
	
	
	мСубконтоДоходы = Новый Массив;
	мСубконтоДоходы.Добавить(ПланыВидовХарактеристик.ВидыСубконтоТиповые.Доходы);
	
	мСубконтоТипыОпераций = Новый Массив;
	мСубконтоТипыОпераций.Добавить(ПланыВидовХарактеристик.ВидыСубконтоТиповые.ТипыОпераций);
	
	мСубконтоСтатьиЗатрат = Новый Массив;
	мСубконтоСтатьиЗатрат.Добавить(ПланыВидовХарактеристик.ВидыСубконтоТиповые.СтатьиЗатрат);
	
	мСубконтоОС = Новый Массив;
	мСубконтоОС.Добавить(ПланыВидовХарактеристик.ВидыСубконтоТиповые.ОсновныеСредства);
	
	мСубконтоНМА = Новый Массив;
	мСубконтоНМА.Добавить(ПланыВидовХарактеристик.ВидыСубконтоТиповые.НематериальныеАктивы);
	
	мСписокСчетовПоставщиков = Новый Массив;
	мСписокСчетовПоставщиков.Добавить(ПланыСчетов.Типовой.КраткосрочнаяКредиторскаяЗадолженность);
	
	Запрос = Новый Запрос;
	
	мНачГраница = Новый Граница(НачалоДня(НачалоГода(ПериодПланирования)), ВидГраницы.Включая);
	мКонГраница = Новый Граница(КонецДня(КонецМесяца(Дата(Год(ПериодПланирования),Видкорректировки.НомерМесяца-1,1))), ВидГраницы.Включая);

	Запрос.УстановитьПараметр("мСписокСчетовПоставщиков", мСписокСчетовПоставщиков);
	Запрос.УстановитьПараметр("мСубконтоОС", мСубконтоОС);
	Запрос.УстановитьПараметр("мСубконтоНМА", мСубконтоНМА);
	Запрос.УстановитьПараметр("мСубконтоСтатьиЗатрат", мСубконтоСтатьиЗатрат);
	Запрос.УстановитьПараметр("мСубконтоДоходы", мСубконтоДоходы);
	Запрос.УстановитьПараметр("мСубконтоТипыОпераций", мСубконтоТипыОпераций);
	Запрос.УстановитьПараметр("ФормируемыйБюджет", ФормируемыйБюджет);
	Запрос.УстановитьПараметр("ЕдиницаИзмерения", Перечисления.ПорядкиОкругленияОтчетности.Окр1);
	Запрос.УстановитьПараметр("Статус", перечисления.СостоянияОбъектов.Утвержден);
	Запрос.УстановитьПараметр("НачалоПериода", мНачГраница);
	Запрос.УстановитьПараметр("КонецПериода", мКонГраница);
	Запрос.УстановитьПараметр("СтатьяБюджета", СписокСтатейБюджета);
	Запрос.УстановитьПараметр("Организация", Организация);
	
	Запрос.Текст =
	
	"ВЫБРАТЬ
	|	СтатьиБюджета.Ссылка КАК СтатьяБюджета,
	|	ВЫБОР
	|		КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|			ТОГДА ЕстьNull(Сумма(ОборотыБУ.Сумма),0) / 1000000
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|					ТОГДА ЕстьNull(Сумма(ОборотыБУ.Сумма),0) / 1000
	|				ИНАЧЕ ЕстьNull(Сумма(ОборотыБУ.Сумма),0)
	|			КОНЕЦ
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|			ТОГДА ЕстьNull(Сумма(ОборотыБУ.СуммаПлан),0) / 1000000
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|					ТОГДА ЕстьNull(Сумма(ОборотыБУ.СуммаПлан),0) / 1000
	|				ИНАЧЕ ЕстьNull(Сумма(ОборотыБУ.СуммаПлан),0)
	|			КОНЕЦ
	|	КОНЕЦ КАК СуммаПлан
	|	ИЗ
	|	Справочник.фин_СтатьиБюджета КАК СтатьиБюджета
	|	Левое Соединение
	|		(ВЫБРАТЬ
	|		б_СоответствияСтатейБюджетаСчетамБУ.СтатьяБюджета КАК СтатьяБюджета,
	|		ЕстьNull(ТиповойОбороты.Организация,Значение(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|		ВЫБОР
	|			КОГДА б_СоответствияСтатейБюджетаСчетамБУ.Счет.Вид = ЗНАЧЕНИЕ(ВидСчета.Активный)
	|				ТОГДА ЕСТЬNULL(ТиповойОбороты.СуммаОборотДт, 0) * б_СоответствияСтатейБюджетаСчетамБУ.ПризнакСуммы
	|			ИНАЧЕ ЕСТЬNULL(ТиповойОбороты.СуммаОборотКт, 0) * б_СоответствияСтатейБюджетаСчетамБУ.ПризнакСуммы
	|		КОНЕЦ КАК Сумма,
	|		0 КАК СуммаПлан
	|	ИЗ
	|		РегистрСведений.б_СоответствияСтатейБюджетаСчетамБУ КАК б_СоответствияСтатейБюджетаСчетамБУ
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Типовой.Обороты(
	|					&НачалоПериода,
	|					&КонецПериода,
	|					,
	|					Счет В
	|						(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|							СоответствияСтатейБюджетаСчетамБУ.Счет
	|						ИЗ
	|							РегистрСведений.б_СоответствияСтатейБюджетаСчетамБУ КАК СоответствияСтатейБюджетаСчетамБУ),
	|					,
	|					Организация = &Организация,
	|					,
	|					) КАК ТиповойОбороты
	|			ПО (ТиповойОбороты.Счет = б_СоответствияСтатейБюджетаСчетамБУ.Счет)
    |	
	|	Объединить Все
	|		ВЫБРАТЬ
	|			б_СоответствияСтатейБюджетаДоходамБУ.СтатьяБюджета,
	|			ЕстьNull(ТиповойОбороты.Организация,Значение(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|			ВЫБОР
	|				КОГДА б_СоответствияСтатейБюджетаДоходамБУ.Счет.Вид = ЗНАЧЕНИЕ(ВидСчета.Активный)
	|					ТОГДА ЕСТЬNULL(ТиповойОбороты.СуммаОборотДт, 0) * б_СоответствияСтатейБюджетаДоходамБУ.ПризнакСуммы
	|				ИНАЧЕ ЕСТЬNULL(ТиповойОбороты.СуммаОборотКт, 0) * б_СоответствияСтатейБюджетаДоходамБУ.ПризнакСуммы
	|			КОНЕЦ КАК Сумма,
	|			0 КАК СуммаПлан
	|		ИЗ
	|			РегистрСведений.б_СоответствияСтатейБюджетаДоходамБУ КАК б_СоответствияСтатейБюджетаДоходамБУ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Типовой.Обороты(
	|						&НачалоПериода,
	|						&КонецПериода,
	|						,
	|						Счет В
	|							(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|								СоответствияСтатейБюджетаДоходамБУ.Счет
	|							ИЗ
	|								РегистрСведений.б_СоответствияСтатейБюджетаДоходамБУ КАК СоответствияСтатейБюджетаДоходамБУ),
	|						&мСубконтоДоходы,
	|						Организация = &Организация,
	|						,
	|						) КАК ТиповойОбороты
	|				ПО (ТиповойОбороты.Счет = б_СоответствияСтатейБюджетаДоходамБУ.Счет)
	|					И (ТиповойОбороты.Субконто1 = б_СоответствияСтатейБюджетаДоходамБУ.Доход)
    |	
	|	Объединить Все
	|		ВЫБРАТЬ
	|			б_СоответствияСтатейБюджетаТипамОперацийБУ.СтатьяБюджета,
	|			ЕстьNull(ТиповойОбороты.Организация,Значение(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|		ВЫБОР
	|				КОГДА б_СоответствияСтатейБюджетаТипамОперацийБУ.Счет.Вид = ЗНАЧЕНИЕ(ВидСчета.Активный)
	|					ТОГДА ЕСТЬNULL(ТиповойОбороты.СуммаОборотДт, 0) * б_СоответствияСтатейБюджетаТипамОперацийБУ.ПризнакСуммы
	|				ИНАЧЕ ЕСТЬNULL(ТиповойОбороты.СуммаОборотКт, 0) * б_СоответствияСтатейБюджетаТипамОперацийБУ.ПризнакСуммы
	|			КОНЕЦ КАК Сумма,
	|			0 КАК СуммаПлан
	|		ИЗ
	|			РегистрСведений.б_СоответствияСтатейБюджетаТипамОперацийБУ КАК б_СоответствияСтатейБюджетаТипамОперацийБУ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Типовой.Обороты(
	|						&НачалоПериода,
	|						&КонецПериода,
	|						,
	|						Счет В
	|							(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|								СоответствияСтатейБюджетаТипамОперацийБУ.Счет
	|							ИЗ
	|								РегистрСведений.б_СоответствияСтатейБюджетаТипамОперацийБУ КАК СоответствияСтатейБюджетаТипамОперацийБУ),
	|						&мСубконтоТипыОпераций,
	|						Организация = &Организация,
	|						,
	|						) КАК ТиповойОбороты
	|				ПО (ТиповойОбороты.Счет = б_СоответствияСтатейБюджетаТипамОперацийБУ.Счет)
	|					И (ТиповойОбороты.Субконто1 = б_СоответствияСтатейБюджетаТипамОперацийБУ.ТипОперации)
    |	
	|	Объединить Все
	|		ВЫБРАТЬ
	|			б_СоответствияСтатейБюджетаСтатьямЗатратБУ.СтатьяБюджета,
	|			ЕстьNull(ТиповойОбороты.Организация,Значение(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|		ВЫБОР
	|				КОГДА б_СоответствияСтатейБюджетаСтатьямЗатратБУ.Счет.Вид = ЗНАЧЕНИЕ(ВидСчета.Активный)
	|					ТОГДА ЕСТЬNULL(ТиповойОбороты.СуммаОборотДт, 0) * б_СоответствияСтатейБюджетаСтатьямЗатратБУ.ПризнакСуммы
	|				ИНАЧЕ ЕСТЬNULL(ТиповойОбороты.СуммаОборотКт, 0) * б_СоответствияСтатейБюджетаСтатьямЗатратБУ.ПризнакСуммы
	|			КОНЕЦ КАК Сумма,
	|			0 КАК СуммаПлан
	|		ИЗ
	|			РегистрСведений.б_СоответствияСтатейБюджетаСтатьямЗатратБУ КАК б_СоответствияСтатейБюджетаСтатьямЗатратБУ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Типовой.Обороты(
	|						&НачалоПериода,
	|						&КонецПериода,
	|						,
	|						Счет В
	|							(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|								СоответствияСтатейБюджетаСтатьямЗатратБУ.Счет
	|							ИЗ
	|								РегистрСведений.б_СоответствияСтатейБюджетаСтатьямЗатратБУ КАК СоответствияСтатейБюджетаСтатьямЗатратБУ),
	|						&мСубконтоСтатьиЗатрат,
	|						Организация = &Организация,
	|						,
	|						) КАК ТиповойОбороты
	|				ПО (ТиповойОбороты.Счет = б_СоответствияСтатейБюджетаСтатьямЗатратБУ.Счет)
	|					И (ТиповойОбороты.Субконто1 = б_СоответствияСтатейБюджетаСтатьямЗатратБУ.СтатьяЗатрат)
    |	
	|	Объединить Все
	|		ВЫБРАТЬ
	|			б_СоответствияСтатейБюджетаГруппамОСБУ.СтатьяБюджета,
	|			ЕстьNull(ТиповойОбороты.Организация,Значение(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|			ЕСТЬNULL(ТиповойОбороты.СуммаОборотДт, 0) * б_СоответствияСтатейБюджетаГруппамОСБУ.ПризнакСуммы КАК Сумма,
	|			0 КАК СуммаПлан
	|		ИЗ
	|			РегистрСведений.б_СоответствияСтатейБюджетаГруппамОСБУ КАК б_СоответствияСтатейБюджетаГруппамОСБУ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Типовой.Обороты(
	|						&НачалоПериода,
	|						&КонецПериода,
	|						,
	|						Счет В
	|							(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|								СоответствияСтатейБюджетаГруппамОСБУ.Счет
	|							ИЗ
	|								РегистрСведений.б_СоответствияСтатейБюджетаГруппамОСБУ КАК СоответствияСтатейБюджетаГруппамОСБУ),
	|						&мСубконтоОС,
	|						Организация = &Организация,
	|						КорСчет в ИЕРАРХИИ (&мСписокСчетовПоставщиков),
	|						) КАК ТиповойОбороты
	|				ПО (ТиповойОбороты.Счет = б_СоответствияСтатейБюджетаГруппамОСБУ.Счет)
	|					И (ТиповойОбороты.Субконто1.ГруппаОС = б_СоответствияСтатейБюджетаГруппамОСБУ.ГруппаОС)
    |	
	|	Объединить Все
	|		ВЫБРАТЬ
	|			б_СоответствияСтатейБюджетаВидамНМАБУ.СтатьяБюджета,
	|			ЕстьNull(ТиповойОбороты.Организация,Значение(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|			ЕСТЬNULL(ТиповойОбороты.СуммаОборотДт, 0) * б_СоответствияСтатейБюджетаВидамНМАБУ.ПризнакСуммы КАК Сумма,
	|			0 КАК СуммаПлан
	|		ИЗ
	|			РегистрСведений.б_СоответствияСтатейБюджетаВидамНМАБУ КАК б_СоответствияСтатейБюджетаВидамНМАБУ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Типовой.Обороты(
	|						&НачалоПериода,
	|						&КонецПериода,
	|						,
	|						Счет В
	|							(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|								СоответствияСтатейБюджетаВидамНМАБУ.Счет
	|							ИЗ
	|								РегистрСведений.б_СоответствияСтатейБюджетаВидамНМАБУ КАК СоответствияСтатейБюджетаВидамНМАБУ),
	|						&мСубконтоНМА,
	|						Организация = &Организация,
	|						КорСчет в ИЕРАРХИИ (&мСписокСчетовПоставщиков),
	|						) КАК ТиповойОбороты
	|				ПО (ТиповойОбороты.Счет = б_СоответствияСтатейБюджетаВидамНМАБУ.Счет)
	|					И (ТиповойОбороты.Субконто1.ВидНМА = б_СоответствияСтатейБюджетаВидамНМАБУ.ВидНМА)
	|	
	|	Объединить Все
	|	ВЫБРАТЬ
	|		б_БюджетОбороты.СтатьяБюджета КАК СтатьяБюджета,
	|		б_БюджетОбороты.Организация КАК Организация,
	|		0 КАК Сумма,
	|		б_БюджетОбороты.СуммаОборот КАК СуммаПлан
	|	ИЗ
	|		РегистрНакопления.б_Бюджет.Обороты(
	|				&НачалоПериода,
	|				&КонецПериода,
	|				,
	|				Организация = &Организация
	|					И Бюджет = &ФормируемыйБюджет
	|					И Статус = &Статус) КАК б_БюджетОбороты
    |	
    |	
	|	) КАК ОборотыБУ
	|	ПО (ОборотыБУ.СтатьяБюджета = СтатьиБюджета.ссылка)
	|	ГДЕ
	|	СтатьиБюджета.Владелец = &ФормируемыйБюджет
	|	И НЕ СтатьиБюджета.ЭтоГруппа
	|	И СтатьиБюджета.ссылка В ИЕРАРХИИ
	|			(&СтатьяБюджета)
    |СГРУППИРОВАТЬ ПО СтатьиБюджета.Ссылка	
    |	
	|";
	
	Возврат Запрос.Выполнить().Выгрузить();
КонецФункции

Процедура РассчитатьОтклонение() Экспорт
	
	
	тзРезультат = ПолучитьВыборку();	
	
	Если ВидРасчетнойТаблицы = перечисления.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета
		ИЛИ ВидРасчетнойТаблицы = перечисления.б_ВидыРасчетныхТаблиц.Зарплата Тогда
		
		Для Каждого СтрокаТЧ из РасчетнаяТаблица Цикл
			СтрокаТЧ.Отклонение = 0;
			СтрокаТЗ = тзРезультат.Найти(СтрокаТЧ.СтатьяБюджета,"СтатьяБюджета");
			СтрокаТЧ.Отклонение = ?(СтрокаТЗ=НЕОПРЕДЕЛЕНО,0,СтрокаТЗ.СуммаПлан-СтрокаТЗ.Сумма);
		КонецЦикла;
		
		Если ВидРасчетнойТаблицы = перечисления.б_ВидыРасчетныхТаблиц.Зарплата Тогда
			Для Каждого СтрокаТЧ из Налоги Цикл
				СтрокаТЧ.Отклонение = 0;
				СтрокаТЗ = тзРезультат.Найти(СтрокаТЧ.СтатьяБюджета,"СтатьяБюджета");
				СтрокаТЧ.Отклонение = ?(СтрокаТЗ=НЕОПРЕДЕЛЕНО,0,СтрокаТЗ.СуммаПлан-СтрокаТЗ.Сумма);
			КонецЦикла;
		Конецесли;
		
	Иначе
		Отклонение = 0;
		СтрокаТЗ = тзРезультат.Найти(СтатьяБюджета,"СтатьяБюджета");
		Отклонение = ?(СтрокаТЗ=НЕОПРЕДЕЛЕНО,0,СтрокаТЗ.СуммаПлан-СтрокаТЗ.Сумма);
	Конецесли;

	
КонецПроцедуры

Функция СформироватьТаблицуВлияющихОборотов(СтруктураШапкиДокумента) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ВидТаблицы",СтруктураШапкиДокумента.ВидРасчетнойТаблицы);
	Запрос.УстановитьПараметр("ТекДокумент",ЭтотОбъект.Ссылка);
	Запрос.УстановитьПараметр("Началопериода",СтруктураШапкиДокумента.ПериодПланирования);
	
	Если ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Бюджет Тогда
		Запрос.Текст =
		"ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	&НачалоПериода КАК Период,
		|	ДанныеПоСтатьям.Сумма1 КАК Сумма,
		|	ДанныеПоСтатьям.ПоступлениеСумма1 КАК ПоступлениеСумма,
		|	ДанныеПоСтатьям.ВыбытиеСумма1 КАК ВыбытиеСумма,
		|	ДанныеПоСтатьям.Вознаграждение1 КАК ВознаграждениеСумма,
		|	ДанныеПоСтатьям.Сдвиг1 КАК сдвиг
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО) 
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 1),
		|	ДанныеПоСтатьям.Сумма2,
		|	ДанныеПоСтатьям.ПоступлениеСумма2,
		|	ДанныеПоСтатьям.ВыбытиеСумма2,
		|	ДанныеПоСтатьям.Вознаграждение2,
		|	ДанныеПоСтатьям.Сдвиг2
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 2),
		|	ДанныеПоСтатьям.Сумма3,
		|	ДанныеПоСтатьям.ПоступлениеСумма3,
		|	ДанныеПоСтатьям.ВыбытиеСумма3,
		|	ДанныеПоСтатьям.Вознаграждение3,
		|	ДанныеПоСтатьям.Сдвиг3
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 3),
		|	ДанныеПоСтатьям.Сумма4,
		|	ДанныеПоСтатьям.ПоступлениеСумма4,
		|	ДанныеПоСтатьям.ВыбытиеСумма4,
		|	ДанныеПоСтатьям.Вознаграждение4,
		|	ДанныеПоСтатьям.Сдвиг4
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 4),
		|	ДанныеПоСтатьям.Сумма5,
		|	ДанныеПоСтатьям.ПоступлениеСумма5,
		|	ДанныеПоСтатьям.ВыбытиеСумма5,
		|	ДанныеПоСтатьям.Вознаграждение5,
		|	ДанныеПоСтатьям.Сдвиг5
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 5),
		|	ДанныеПоСтатьям.Сумма6,
		|	ДанныеПоСтатьям.ПоступлениеСумма6,
		|	ДанныеПоСтатьям.ВыбытиеСумма6,
		|	ДанныеПоСтатьям.Вознаграждение6,
		|	ДанныеПоСтатьям.Сдвиг6
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 6),
		|	ДанныеПоСтатьям.Сумма7,
		|	ДанныеПоСтатьям.ПоступлениеСумма7,
		|	ДанныеПоСтатьям.ВыбытиеСумма7,
		|	ДанныеПоСтатьям.Вознаграждение7,
		|	ДанныеПоСтатьям.Сдвиг7
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 7),
		|	ДанныеПоСтатьям.Сумма8,
		|	ДанныеПоСтатьям.ПоступлениеСумма8,
		|	ДанныеПоСтатьям.ВыбытиеСумма8,
		|	ДанныеПоСтатьям.Вознаграждение8,
		|	ДанныеПоСтатьям.Сдвиг8
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 8),
		|	ДанныеПоСтатьям.Сумма9,
		|	ДанныеПоСтатьям.ПоступлениеСумма9,
		|	ДанныеПоСтатьям.ВыбытиеСумма9,
		|	ДанныеПоСтатьям.Вознаграждение9,
		|	ДанныеПоСтатьям.Сдвиг9
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 9),
		|	ДанныеПоСтатьям.Сумма10,
		|	ДанныеПоСтатьям.ПоступлениеСумма10,
		|	ДанныеПоСтатьям.ВыбытиеСумма10,
		|	ДанныеПоСтатьям.Вознаграждение10,
		|	ДанныеПоСтатьям.Сдвиг10
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 10),
		|	ДанныеПоСтатьям.Сумма11,
		|	ДанныеПоСтатьям.ПоступлениеСумма11,
		|	ДанныеПоСтатьям.ВыбытиеСумма11,
		|	ДанныеПоСтатьям.Вознаграждение11,
		|	ДанныеПоСтатьям.Сдвиг11
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 11),
		|	ДанныеПоСтатьям.Сумма12,
		|	ДанныеПоСтатьям.ПоступлениеСумма12,
		|	ДанныеПоСтатьям.ВыбытиеСумма12,
		|	ДанныеПоСтатьям.Вознаграждение12,
		|	ДанныеПоСтатьям.Сдвиг12
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	&НачалоПериода,
		|	ДанныеПоСтатьям.Сумма1,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 1),
		|	ДанныеПоСтатьям.Сумма2,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 2),
		|	ДанныеПоСтатьям.Сумма3,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 3),
		|	ДанныеПоСтатьям.Сумма4,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 4),
		|	ДанныеПоСтатьям.Сумма5,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 5),
		|	ДанныеПоСтатьям.Сумма6,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 6),
		|	ДанныеПоСтатьям.Сумма7,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 7),
		|	ДанныеПоСтатьям.Сумма8,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 8),
		|	ДанныеПоСтатьям.Сумма9,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 9),
		|	ДанныеПоСтатьям.Сумма10,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 10),
		|	ДанныеПоСтатьям.Сумма11,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 11),
		|	ДанныеПоСтатьям.Сумма12,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	&НачалоПериода,
		|	ДанныеПоСтатьям.Сумма1,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 1),
		|	ДанныеПоСтатьям.Сумма2,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 2),
		|	ДанныеПоСтатьям.Сумма3,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 3),
		|	ДанныеПоСтатьям.Сумма4,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 4),
		|	ДанныеПоСтатьям.Сумма5,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 5),
		|	ДанныеПоСтатьям.Сумма6,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 6),
		|	ДанныеПоСтатьям.Сумма7,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 7),
		|	ДанныеПоСтатьям.Сумма8,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 8),
		|	ДанныеПоСтатьям.Сумма9,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 9),
		|	ДанныеПоСтатьям.Сумма10,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 10),
		|	ДанныеПоСтатьям.Сумма11,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 11),
		|	ДанныеПоСтатьям.Сумма12,
		|	0,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент";
		
	ИначеЕсли ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Корректировка ИЛИ 
		ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Заявка Тогда
		Запрос.Текст =
		"ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	&НачалоПериода КАК Период,
		|	ДанныеПоСтатьям.Сумма1-ДанныеПоСтатьям.иСумма1 КАК Сумма   ,
		|ПоступлениеСумма1-ипоступлениесумма1 как ПоступлениеСумма, 
		|ВыбытиеСумма1 -ивыбытиесумма1 как ВыбытиеСумма , 
		|Вознаграждение1-иВознаграждение1 как ВознаграждениеСумма,сдвиг1-исдвиг1 как сдвиг
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,1) КАК Период,
		|	ДанныеПоСтатьям.Сумма2-ДанныеПоСтатьям.иСумма2 КАК Сумма,
		|ПоступлениеСумма2-ипоступлениесумма2 , 
		|ВыбытиеСумма2 -ивыбытиесумма2  , Вознаграждение2-иВознаграждение2 ,сдвиг2-исдвиг2
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,2) КАК Период,
		|	ДанныеПоСтатьям.Сумма3-ДанныеПоСтатьям.иСумма3 КАК Сумма,
		|ПоступлениеСумма3-ипоступлениесумма3 , 
		|ВыбытиеСумма3 -ивыбытиесумма3 , Вознаграждение3-иВознаграждение3 ,сдвиг3-исдвиг3
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,3) КАК Период,
		|	ДанныеПоСтатьям.Сумма4-ДанныеПоСтатьям.иСумма4 КАК Сумма,
		|ПоступлениеСумма4-ипоступлениесумма4 , 
		|ВыбытиеСумма4 -ивыбытиесумма4    , Вознаграждение4-иВознаграждение4 ,сдвиг4-исдвиг4
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,4) КАК Период,
		|	ДанныеПоСтатьям.Сумма5-ДанныеПоСтатьям.иСумма5 КАК Сумма,
		|ПоступлениеСумма5-ипоступлениесумма5 , 
		|ВыбытиеСумма5 -ивыбытиесумма5    , Вознаграждение5-иВознаграждение5  ,сдвиг5-исдвиг5
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,5) КАК Период,
		|	ДанныеПоСтатьям.Сумма6-ДанныеПоСтатьям.иСумма6 КАК Сумма,
		|ПоступлениеСумма6-ипоступлениесумма6 , 
		|ВыбытиеСумма6 -ивыбытиесумма6  , Вознаграждение6-иВознаграждение6 ,сдвиг6-исдвиг6
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,6) КАК Период,
		|	ДанныеПоСтатьям.Сумма7-ДанныеПоСтатьям.иСумма7 КАК Сумма,
		|ПоступлениеСумма7-ипоступлениесумма7 , 
		|ВыбытиеСумма7 -ивыбытиесумма7 , Вознаграждение7-иВознаграждение7,сдвиг7-исдвиг7
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,7) КАК Период,
		|	ДанныеПоСтатьям.Сумма8-ДанныеПоСтатьям.иСумма8 КАК Сумма,
		|ПоступлениеСумма8-ипоступлениесумма8 , 
		|ВыбытиеСумма8 -ивыбытиесумма8  , Вознаграждение8-иВознаграждение8,сдвиг8-исдвиг8
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,8) КАК Период,
		|	ДанныеПоСтатьям.Сумма9-ДанныеПоСтатьям.иСумма9 КАК Сумма,
		|ПоступлениеСумма9-ипоступлениесумма9 , 
		|ВыбытиеСумма9 -ивыбытиесумма9   , Вознаграждение9-иВознаграждение9,сдвиг9-исдвиг9
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,9) КАК Период,
		|	ДанныеПоСтатьям.Сумма10-ДанныеПоСтатьям.иСумма10 КАК Сумма,
		|ПоступлениеСумма10-ипоступлениесумма10 , 
		|ВыбытиеСумма10 -ивыбытиесумма10          , Вознаграждение10-иВознаграждение10 ,сдвиг10-исдвиг10
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,10) КАК Период,
		|	ДанныеПоСтатьям.Сумма11-ДанныеПоСтатьям.иСумма11 КАК Сумма,
		|ПоступлениеСумма11-ипоступлениесумма11 , 
		|ВыбытиеСумма11 -ивыбытиесумма11          , Вознаграждение11-иВознаграждение11,сдвиг11-исдвиг11
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР КОГДА &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|	ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|	ИНАЧЕ 
		|		ВЫБОР КОГДА  &ВидТаблицы = Значение(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|		ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ДанныеПоСтатьям.ссылка.СтатьяБюджета
		|       КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,11) КАК Период,
		|	ДанныеПоСтатьям.Сумма12-ДанныеПоСтатьям.иСумма12 КАК Сумма,
		|ПоступлениеСумма12-ипоступлениесумма12 , 
		|ВыбытиеСумма12 -ивыбытиесумма12      , Вознаграждение12-иВознаграждение12  ,сдвиг12-исдвиг12
		|ИЗ
		|	Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|/////////////////МАСЛО
		//|
		|Объединить Все
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	&НачалоПериода КАК Период,
		|	ДанныеПоСтатьям.иСумма1-ДанныеПоСтатьям.иСумма1 КАК Сумма,0,0,0  ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,1) КАК Период,
		|	ДанныеПоСтатьям.Сумма2-ДанныеПоСтатьям.иСумма2 КАК Сумма,0,0 ,0  ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,2) КАК Период,
		|	ДанныеПоСтатьям.Сумма3-ДанныеПоСтатьям.иСумма3 КАК Сумма,0,0  ,0   ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,3) КАК Период,
		|	ДанныеПоСтатьям.Сумма4-ДанныеПоСтатьям.иСумма4 КАК Сумма,0,0 ,0,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,4) КАК Период,
		|	ДанныеПоСтатьям.Сумма5-ДанныеПоСтатьям.иСумма5 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,5) КАК Период,
		|	ДанныеПоСтатьям.Сумма6-ДанныеПоСтатьям.иСумма6 КАК Сумма,0,0 ,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,6) КАК Период,
		|	ДанныеПоСтатьям.Сумма7-ДанныеПоСтатьям.иСумма7 КАК Сумма,0,0,0  ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,7) КАК Период,
		|	ДанныеПоСтатьям.Сумма8-ДанныеПоСтатьям.иСумма8 КАК Сумма,0,0,0  ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,8) КАК Период,
		|	ДанныеПоСтатьям.Сумма9-ДанныеПоСтатьям.иСумма9 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,9) КАК Период,
		|	ДанныеПоСтатьям.Сумма10-ДанныеПоСтатьям.иСумма10 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,10) КАК Период,
		|	ДанныеПоСтатьям.Сумма11-ДанныеПоСтатьям.иСумма11 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ДанныеПоСтатьям.ссылка.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,11) КАК Период,
		|	ДанныеПоСтатьям.Сумма12-ДанныеПоСтатьям.иСумма12 КАК Сумма,0,0 ,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.РасчетнаятаблицаМАСЛО КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|/////////////////НАЛОГИ
		|
		|Объединить Все
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	&НачалоПериода КАК Период,
		|	ДанныеПоСтатьям.Сумма1-ДанныеПоСтатьям.иСумма1 КАК Сумма,0,0 ,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,1) КАК Период,
		|	ДанныеПоСтатьям.Сумма2-ДанныеПоСтатьям.иСумма2 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,2) КАК Период,
		|	ДанныеПоСтатьям.иСумма3-ДанныеПоСтатьям.иСумма3 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,3) КАК Период,
		|	ДанныеПоСтатьям.Сумма4-ДанныеПоСтатьям.иСумма4 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,4) КАК Период,
		|	ДанныеПоСтатьям.Сумма5-ДанныеПоСтатьям.иСумма5 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,5) КАК Период,
		|	ДанныеПоСтатьям.Сумма6-ДанныеПоСтатьям.иСумма6 КАК Сумма,0,0,0  ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,6) КАК Период,
		|	ДанныеПоСтатьям.Сумма7-ДанныеПоСтатьям.иСумма7 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,7) КАК Период,
		|	ДанныеПоСтатьям.Сумма8-ДанныеПоСтатьям.иСумма8 КАК Сумма,0,0 ,0,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,8) КАК Период,
		|	ДанныеПоСтатьям.Сумма9-ДанныеПоСтатьям.иСумма9 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,9) КАК Период,
		|	ДанныеПоСтатьям.Сумма10-ДанныеПоСтатьям.иСумма10 КАК Сумма,0,0 ,0,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,10) КАК Период,
		|	ДанныеПоСтатьям.Сумма11-ДанныеПоСтатьям.иСумма11 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|
		|Объединить Все
		| ВЫБРАТЬ
		|	ДанныеПоСтатьям.ссылка.ФормируемыйБюджет КАК Бюджет,
		|   ДанныеПоСтатьям.СтатьяБюджета КАК СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода,Месяц,11) КАК Период,
		|	ДанныеПоСтатьям.Сумма12-ДанныеПоСтатьям.иСумма12 КАК Сумма,0,0,0 ,0
		|ИЗ
		|	Документ.б_Расчетнаятаблица.НАЛОГИ КАК ДанныеПоСтатьям
		|Где
		|	ДанныеПоСтатьям.ссылка = &ТекДокумент
		|";
		
	КонецЕсли;
	
	
	Возврат Запрос.Выполнить().Выгрузить();
КонецФункции

// Заполняет таблицу зависимых оборотов рекурсивно зависимыми от статьи
// переданной в качестве параметра.
//
// Параметры
//  Статья  – <Справочник.СтатьиОборотовБюджета> – статья оборотов, для которой выбираются зависимые
//  ДатаДвижения - дата движения по влияющей статье
//  КоличествоПоСтатье - количественный оборот по влияющей статье
//  СуммаПоСтатье - суммовой оборот по влияющей статье
//
Процедура ЗаполнитьЗависимымиОборотами(ТекБюджет,
										ТекСтатьяБюджета,
										ТекПериод,
										СуммаПоСтатье,
										СуммаПоступление,
										СуммаВыбытие,
										СуммаВознаграждение,
										СуммаСдвиг)
										
	//Запрос = Новый Запрос;
	//									
	//Запрос.Текст =
	//"ВЫБРАТЬ
	//|	ЗависимостиСтатейБюджета.ЗависимыйБюджет,
	//|	ЗависимостиСтатейБюджета.ЗависимаяСтатьяБюджета,
	//|	ЗависимостиСтатейБюджета.Коэффициент,
	//|	ЗависимостиСтатейБюджета.ПериодОтражения,
	//|	ЗависимостиСтатейБюджета.ИсточникДанных
	//|ИЗ
	//|	РегистрСведений.ЗависимостиСтатейБюджета КАК ЗависимостиСтатейБюджета
	//|ГДЕ
	//|	ЗависимостиСтатейБюджета.ВлияющийБюджет = &ТекБюджет
	//|	И ЗависимостиСтатейБюджета.ВлияющаяСтатьяБюджета = &ТекСтатьяБюджета";
	//
	//Запрос.УстановитьПараметр("ТекБюджет",ТекБюджет);
	//Запрос.УстановитьПараметр("ТекСтатьяБюджета",ТекСтатьяБюджета);

	//РезультатЗапроса=Запрос.Выполнить();

	СтруктураПоиска = новый Структура("ВлияющийБюджет,ВлияющаяСтатьяБюджета",ТекБюджет,ТекСтатьяБюджета);
	МассивСтрокТЗЗависимостей = мТаблицаЗависимостей.НайтиСтроки(СтруктураПоиска);
					
		Для Каждого ТекущаяЗависимость Из МассивСтрокТЗЗависимостей Цикл
				НовыйЗависимыйОборот				=ЗависимыеОбороты.Добавить();
				НовыйЗависимыйОборот.Период			=?(ТекущаяЗависимость.ПериодОтражения>0,Дата(Год(ТекПериод),ТекущаяЗависимость.ПериодОтражения,1),ТекПериод);
				
				
				Если ТекущаяЗависимость.ЗависимаяСтатьяБюджета.КодСтрокиБюджета = "414.2" 
					И ТекущаяЗависимость.ЗависимыйБюджет.Наименование = "Прогнозный бухгалтерский баланс" Тогда

					НовыйЗависимыйОборот.Период	=?(ТекущаяЗависимость.ПериодОтражения>0, НачалоМесяца(КонецГода(Дата(Год(ТекПериод),ТекущаяЗависимость.ПериодОтражения,1))),НачалоМесяца(КонецГода(ТекПериод)));
					
				КонецЕсли;
				
				Если ТекущаяЗависимость.ЗависимаяСтатьяБюджета.КодСтрокиБюджета = "1.1.1" 
					И ТекущаяЗависимость.ЗависимыйБюджет.Наименование = "1 БК" Тогда

					НовыйЗависимыйОборот.Период	=?(ТекущаяЗависимость.ПериодОтражения>0, НачалоМесяца(КонецГода(Дата(Год(ТекПериод),ТекущаяЗависимость.ПериодОтражения,1))),НачалоМесяца(КонецГода(ТекПериод)));
					
				КонецЕсли;

				Если ТекущаяЗависимость.ЗависимаяСтатьяБюджета.КодСтрокиБюджета = "1.1.2" 
					И ТекущаяЗависимость.ЗависимыйБюджет.Наименование = "1 БК" Тогда

					НовыйЗависимыйОборот.Период	=?(ТекущаяЗависимость.ПериодОтражения>0, НачалоМесяца(КонецГода(Дата(Год(ТекПериод),ТекущаяЗависимость.ПериодОтражения,1))),НачалоМесяца(КонецГода(ТекПериод)));
					
				КонецЕсли;

				
				НовыйЗависимыйОборот.Бюджет			= ТекущаяЗависимость.ЗависимыйБюджет;
				НовыйЗависимыйОборот.СтатьяБюджета	= ТекущаяЗависимость.ЗависимаяСтатьяБюджета;
				Если ТекущаяЗависимость.ИсточникДанных = Перечисления.ЦС_ВидыИсточниковСуммДляЗависимостейСтатейБюджета.Поступление тогда
					РасчетнаяСумма = СуммаПоступление;
				ИначеЕсли ТекущаяЗависимость.ИсточникДанных = Перечисления.ЦС_ВидыИсточниковСуммДляЗависимостейСтатейБюджета.Выбытие тогда
					РасчетнаяСумма = СуммаВыбытие;
				ИначеЕсли ТекущаяЗависимость.ИсточникДанных = Перечисления.ЦС_ВидыИсточниковСуммДляЗависимостейСтатейБюджета.Вознаграждение тогда
					РасчетнаяСумма = СуммаВознаграждение;
				ИначеЕсли ТекущаяЗависимость.ИсточникДанных = Перечисления.ЦС_ВидыИсточниковСуммДляЗависимостейСтатейБюджета.Сдвиг тогда
					РасчетнаяСумма = СуммаСдвиг;
				Иначе
					РасчетнаяСумма = СуммаПоСтатье;
				КонецЕсли;
				
				НовыйЗависимыйОборот.Сумма			= РасчетнаяСумма*ТекущаяЗависимость.Коэффициент;
				
				
				Если ТекущаяЗависимость.ЗависимыйБюджет.Наименование = "Прогнозный бухгалтерский баланс"
					И ФормируемыйБюджет.Наименование <> "Прогнозный бухгалтерский баланс"
					И ТекущаяЗависимость.ВлияющийБюджет.Наименование <> "Прогнозный бухгалтерский баланс"
					И ФормируемыйБюджет.Наименование <> "Прогнозный портфель долговых обязательств"
					И ФормируемыйБюджет.Наименование <> "Прогноз движения денег" Тогда
					
					Если РасчетнаяСумма*ТекущаяЗависимость.Коэффициент <> 0 Тогда
						
						Если ТекущаяЗависимость.ЗависимаяСтатьяБюджета.КодСтрокиБюджета <> "414.2" Тогда
							
							ЗаполнитьЗависимымиОборотами(НовыйЗависимыйОборот.Бюджет,
											НовыйЗависимыйОборот.СтатьяБюджета,
											НовыйЗависимыйОборот.Период,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма);

							ПериодЗавис = ?(ТекущаяЗависимость.ПериодОтражения>0,Дата(Год(ТекПериод),ТекущаяЗависимость.ПериодОтражения,1),ТекПериод);
							
							Аслед = Месяц(ПериодЗавис);
							АПослед = 12 - Аслед;
							Для А = 1 по АПослед Цикл
								
								НовыйЗависимыйОборот				= ЗависимыеОбороты.Добавить();
								НовыйЗависимыйОборот.Период			= НачалоМесяца(ПериодЗавис + А*31*24*60*60);
								НовыйЗависимыйОборот.Бюджет			= ТекущаяЗависимость.ЗависимыйБюджет;
								НовыйЗависимыйОборот.СтатьяБюджета	= ТекущаяЗависимость.ЗависимаяСтатьяБюджета;
								Если ТекущаяЗависимость.ИсточникДанных = Перечисления.ЦС_ВидыИсточниковСуммДляЗависимостейСтатейБюджета.Поступление тогда
									РасчетнаяСумма = СуммаПоступление;
								ИначеЕсли ТекущаяЗависимость.ИсточникДанных = Перечисления.ЦС_ВидыИсточниковСуммДляЗависимостейСтатейБюджета.Выбытие тогда
									РасчетнаяСумма = СуммаВыбытие;
								ИначеЕсли ТекущаяЗависимость.ИсточникДанных = Перечисления.ЦС_ВидыИсточниковСуммДляЗависимостейСтатейБюджета.Вознаграждение тогда
									РасчетнаяСумма = СуммаВознаграждение;
								ИначеЕсли ТекущаяЗависимость.ИсточникДанных = Перечисления.ЦС_ВидыИсточниковСуммДляЗависимостейСтатейБюджета.Сдвиг тогда
									РасчетнаяСумма = СуммаСдвиг;
								Иначе
									РасчетнаяСумма = СуммаПоСтатье;
								КонецЕсли;
								
								НовыйЗависимыйОборот.Сумма			= РасчетнаяСумма*ТекущаяЗависимость.Коэффициент;

								
								ЗаполнитьЗависимымиОборотами(НовыйЗависимыйОборот.Бюджет,
											НовыйЗависимыйОборот.СтатьяБюджета,
											НовыйЗависимыйОборот.Период,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма)

							КонецЦикла;
							
						Иначе
							
							ЗаполнитьЗависимымиОборотами(НовыйЗависимыйОборот.Бюджет,
											НовыйЗависимыйОборот.СтатьяБюджета,
											НовыйЗависимыйОборот.Период,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма)

						КонецЕсли;
						
					КонецЕсли;

				Иначе
					ЗаполнитьЗависимымиОборотами(НовыйЗависимыйОборот.Бюджет,
											НовыйЗависимыйОборот.СтатьяБюджета,
											НовыйЗависимыйОборот.Период,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма,
											НовыйЗависимыйОборот.Сумма)

				КонецЕсли;
									
				//ЗаполнитьЗависимымиОборотами(НовыйЗависимыйОборот.Бюджет,
				//							НовыйЗависимыйОборот.СтатьяБюджета,
				//							НовыйЗависимыйОборот.Период,
				//							НовыйЗависимыйОборот.Сумма,
				//							НовыйЗависимыйОборот.Сумма,
				//							НовыйЗависимыйОборот.Сумма,
				//							НовыйЗависимыйОборот.Сумма,
				//							НовыйЗависимыйОборот.Сумма)
		КонецЦикла;
	
	
		

КонецПроцедуры
									
// Инициирует процесс заполнения ТЧ "ЗависимыеОбороты"
//
Процедура РассчитатьЗависимыеОбороты() Экспорт
	
	ЗависимыеОбороты.Очистить();
	
	
	СтруктураШапкиДокумента   = ОбщегоНазначения.СформироватьСтруктуруШапкиДокумента(ЭтотОбъект);
	тз = СформироватьТаблицуВлияющихОборотов(СтруктураШапкиДокумента);
	
	тз.Свернуть("Бюджет,СтатьяБюджета,Период","Сумма,ПоступлениеСумма,ВыбытиеСумма,ВознаграждениеСумма,Сдвиг");
	Для Каждого СтрокаТЗ из тз Цикл
		ЗаполнитьЗависимымиОборотами(СтрокаТЗ.Бюджет,
									СтрокаТЗ.СтатьяБюджета,
									СтрокаТЗ.Период,
									СтрокаТЗ.Сумма,
									СтрокаТЗ.ПоступлениеСумма,
									СтрокаТЗ.ВыбытиеСумма,
									СтрокаТЗ.ВознаграждениеСумма,
									СтрокаТЗ.Сдвиг);
	КонецЦикла;
	
КонецПроцедуры // РассчитатьЗависимые()

//
Процедура ЗаполнитьПоТаблицеГСМ() Экспорт
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("ТекДокумент",ЭтотОбъект.Ссылка);
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ГСМ.ОС КАК ОС
	|ИЗ
	|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ГСМ
	|ГДЕ
	| ГСМ.Ссылка = &ТекДокумент
	|";
	
	тз = Запрос.Выполнить().Выгрузить();
	
	РасчетнаяТаблицаМасло.Загрузить(тз);
	
КонецПроцедуры

// Возвращает доступные варианты печати документа.
//
// Вовращаемое значение:
//  Струткура, каждая строка которой соответствует одному из вариантов печати
//  
Функция ПолучитьСтруктуруПечатныхФорм() Экспорт
	
	Возврат Новый Структура("Макет,Квартал,ПовышениеКвалификации","Расчетная таблица","Расчетная таблица (только квартал)","Повышение квалификации");

КонецФункции // ПолучитьСтруктуруПечатныхФорм()

//
Функция СформироватьЗапросПОТабличнойЧасти()
	
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("ТекДокумент",ЭтотОбъект.Ссылка);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ДанныеПоМесяцам.Период,
	|	ДанныеПоМесяцам.Сумма,
	|	Данные.Номенклатура
	|ИЗ
	|	Документ.б_Расчетнаятаблица.ДанныеПоМесяцам КАК ДанныеПоМесяцам
	|Левое соединение
	|	(ВЫБРАТЬ
	|		Расчетнаятаблица.IDстроки КАК IDстроки,
	|		Расчетнаятаблица.Номенклатура КАК Номенклатура
	|    ИЗ
	|		Документ.б_Расчетнаятаблица.Расчетнаятаблица КАК Расчетнаятаблица
	|    ГДЕ
	|    	 Расчетнаятаблица.ссылка = &ТекДокумент) КАК Данные
	|   ПО Данные.IDСтроки = ДанныеПоМесяцам.IDСтроки
	|ГДЕ
	|	ДанныеПоМесяцам.ссылка = &ТекДокумент
	|";
	
	Возврат Запрос.Выполнить();
КонецФункции


// Проверяет правильность заполнения шапки документа.
// Если какой-то из реквизтов шапки, влияющий на проведение не заполнен или
// заполнен не корректно, то выставляется флаг отказа в проведении.
// Проверяется также правильность заполнения реквизитов ссылочных полей документа.
// Проверка выполняется по объекту и по выборке из результата запроса по шапке.
//
// Параметры: 
//  СтруктураШапкиДокумента - выборка из результата запроса по шапке документа,
//  Отказ                   - флаг отказа в проведении,
//  Заголовок               - строка, заголовок сообщения об ошибке проведения.
//
Процедура ПроверитьЗаполнениеШапки(СтруктураШапкиДокумента, Отказ, Заголовок)

	// Укажем, что надо проверить:
	Если СтруктураШапкиДокумента.ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Бюджет Тогда
	СтруктураОбязательныхПолей = Новый Структура("Организация, 
									|ФормируемыйБюджет,
									|Сценарий,
									|СтатьяБюджета");
	
	ИначеЕсли СтруктураШапкиДокумента.ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Корректировка Тогда
	СтруктураОбязательныхПолей = Новый Структура("Организация, 
									|ФормируемыйБюджет,
									|Сценарий,
									|ВидКорректировки,
									|СтатьяБюджета");
	КонецЕсли;	
	// Теперь позовем общую процедуру проверки.
	ОбщегоНазначения.ПроверитьЗаполнениеШапкиДокумента(ЭтотОбъект, СтруктураОбязательныхПолей, Отказ, Заголовок);

КонецПроцедуры // ПроверитьЗаполнениеШапки()

Функция ПодготовитьТаблицу(СтруктураШапкиДокумента)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ВидТаблицы",СтруктураШапкиДокумента.ВидРасчетнойТаблицы);
	Запрос.УстановитьПараметр("ТекДокумент",ЭтотОбъект.Ссылка);
	Запрос.УстановитьПараметр("Началопериода",СтруктураШапкиДокумента.ПериодПланирования);
	
	Запрос.Текст =
    "ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация КАК Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет КАК Бюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий КАК Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ КАК СтатьяБюджета,
    |	ДанныеПоСтатьям.Номенклатура КАК Номенклатура,
    |	ДанныеПоСтатьям.ОС КАК ОС,
    |	&НачалоПериода КАК Период,
    |	ДанныеПоСтатьям.Сумма1 КАК Сумма,
    |	ДанныеПоСтатьям.ПоступлениеСумма1 КАК ПоступлениеСумма,
    |	ДанныеПоСтатьям.ВыбытиеСумма1 КАК ВыбытиеСумма,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 1),
    |	ДанныеПоСтатьям.Сумма2,
    |	ДанныеПоСтатьям.ПоступлениеСумма2,
    |	ДанныеПоСтатьям.ВыбытиеСумма2,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 2),
    |	ДанныеПоСтатьям.Сумма3,
    |	ДанныеПоСтатьям.ПоступлениеСумма3,
    |	ДанныеПоСтатьям.ВыбытиеСумма3,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 3),
    |	ДанныеПоСтатьям.Сумма4,
    |	ДанныеПоСтатьям.ПоступлениеСумма4,
    |	ДанныеПоСтатьям.ВыбытиеСумма4,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 4),
    |	ДанныеПоСтатьям.Сумма5,
    |	ДанныеПоСтатьям.ПоступлениеСумма5,
    |	ДанныеПоСтатьям.ВыбытиеСумма5,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 5),
    |	ДанныеПоСтатьям.Сумма6,
    |	ДанныеПоСтатьям.ПоступлениеСумма6,
    |	ДанныеПоСтатьям.ВыбытиеСумма6,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 6),
    |	ДанныеПоСтатьям.Сумма7,
    |	ДанныеПоСтатьям.ПоступлениеСумма7,
    |	ДанныеПоСтатьям.ВыбытиеСумма7,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 7),
    |	ДанныеПоСтатьям.Сумма8,
    |	ДанныеПоСтатьям.ПоступлениеСумма8,
    |	ДанныеПоСтатьям.ВыбытиеСумма8,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 8),
    |	ДанныеПоСтатьям.Сумма9,
    |	ДанныеПоСтатьям.ПоступлениеСумма9,
    |	ДанныеПоСтатьям.ВыбытиеСумма9,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 9),
    |	ДанныеПоСтатьям.Сумма10,
    |	ДанныеПоСтатьям.ПоступлениеСумма10,
    |	ДанныеПоСтатьям.ВыбытиеСумма10,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 10),
    |	ДанныеПоСтатьям.Сумма11,
    |	ДанныеПоСтатьям.ПоступлениеСумма11,
    |	ДанныеПоСтатьям.ВыбытиеСумма11,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент
    |
    |ОБЪЕДИНИТЬ ВСЕ
    |
    |ВЫБРАТЬ
    |	ДанныеПоСтатьям.Ссылка.Организация,
    |	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
    |	ДанныеПоСтатьям.Ссылка.Сценарий,
    |	ВЫБОР
    |		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
    |				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
    |			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |		ИНАЧЕ ВЫБОР
    |				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
    |					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
    |				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
    |			КОНЕЦ
    |	КОНЕЦ,
    |	ДанныеПоСтатьям.Номенклатура,
    |	ДанныеПоСтатьям.ОС,
    |	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 11),
    |	ДанныеПоСтатьям.Сумма12,
    |	ДанныеПоСтатьям.ПоступлениеСумма12,
    |	ДанныеПоСтатьям.ВыбытиеСумма12,
    |	ДанныеПоСтатьям.ИсточникФинансирования
    |ИЗ
    |	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
    |ГДЕ
    |	ДанныеПоСтатьям.Ссылка = &ТекДокумент";
	
	
	Возврат Запрос.Выполнить().Выгрузить();
 
КонецФункции

Функция ПодготовитьТаблицуДляБюджета(СтруктураШапкиДокумента)
	
	Если ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Бюджет Тогда
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("ВидТаблицы",СтруктураШапкиДокумента.ВидРасчетнойТаблицы);
		Запрос.УстановитьПараметр("ТекДокумент",ЭтотОбъект.Ссылка);
		Запрос.УстановитьПараметр("Началопериода",СтруктураШапкиДокумента.ПериодПланирования);
		
		Запрос.Текст =
		"ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация КАК Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет КАК Бюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ КАК СтатьяБюджета,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ КАК ДополнительнаяАналитика,
		|	&НачалоПериода КАК Период,
		|	ДанныеПоСтатьям.Сумма1 КАК Сумма,
		|	ДанныеПоСтатьям.ПоступлениеСумма1 КАК ПоступлениеСумма,
		|	ДанныеПоСтатьям.ВыбытиеСумма1 КАК Выбытиесумма,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 1),
		|	ДанныеПоСтатьям.Сумма2,
		|	ДанныеПоСтатьям.ПоступлениеСумма2,
		|	ДанныеПоСтатьям.ВыбытиеСумма2,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 2),
		|	ДанныеПоСтатьям.Сумма3,
		|	ДанныеПоСтатьям.ПоступлениеСумма3,
		|	ДанныеПоСтатьям.ВыбытиеСумма3,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 3),
		|	ДанныеПоСтатьям.Сумма4,
		|	ДанныеПоСтатьям.ПоступлениеСумма4,
		|	ДанныеПоСтатьям.ВыбытиеСумма4,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 4),
		|	ДанныеПоСтатьям.Сумма5,
		|	ДанныеПоСтатьям.ПоступлениеСумма5,
		|	ДанныеПоСтатьям.ВыбытиеСумма5,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 5),
		|	ДанныеПоСтатьям.Сумма6,
		|	ДанныеПоСтатьям.ПоступлениеСумма6,
		|	ДанныеПоСтатьям.ВыбытиеСумма6,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 6),
		|	ДанныеПоСтатьям.Сумма7,
		|	ДанныеПоСтатьям.ПоступлениеСумма7,
		|	ДанныеПоСтатьям.ВыбытиеСумма7,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 7),
		|	ДанныеПоСтатьям.Сумма8,
		|	ДанныеПоСтатьям.ПоступлениеСумма8,
		|	ДанныеПоСтатьям.ВыбытиеСумма8,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 8),
		|	ДанныеПоСтатьям.Сумма9,
		|	ДанныеПоСтатьям.ПоступлениеСумма9,
		|	ДанныеПоСтатьям.ВыбытиеСумма9,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 9),
		|	ДанныеПоСтатьям.Сумма10,
		|	ДанныеПоСтатьям.ПоступлениеСумма10,
		|	ДанныеПоСтатьям.ВыбытиеСумма10,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 10),
		|	ДанныеПоСтатьям.Сумма11,
		|	ДанныеПоСтатьям.ПоступлениеСумма11,
		|	ДанныеПоСтатьям.ВыбытиеСумма11,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|			ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|					ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|				ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияОС)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаЗемлю)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаТранспорт)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.НалогНаИмущество)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Коммунальные)
		|			ТОГДА ДанныеПоСтатьям.ОС
		|		ИНАЧЕ ВЫБОР
		|				КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.АмортизацияНМА)
		|					ТОГДА ДанныеПоСтатьям.НМА
		|				ИНАЧЕ ВЫБОР
		|						КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|								ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|							ТОГДА """"
		|						ИНАЧЕ ДанныеПоСтатьям.Номенклатура
		|					КОНЕЦ
		|			КОНЕЦ
		|	КОНЕЦ,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 11),
		|	ДанныеПоСтатьям.Сумма12,
		|	ДанныеПоСтатьям.ПоступлениеСумма12,
		|	ДанныеПоСтатьям.ВыбытиеСумма12,
		|	ДанныеПоСтатьям.ИсточникФинансирования
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	&НачалоПериода,
		|	ДанныеПоСтатьям.Сумма1,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 1),
		|	ДанныеПоСтатьям.Сумма2,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 2),
		|	ДанныеПоСтатьям.Сумма3,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 3),
		|	ДанныеПоСтатьям.Сумма4,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 4),
		|	ДанныеПоСтатьям.Сумма5,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 5),
		|	ДанныеПоСтатьям.Сумма6,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 6),
		|	ДанныеПоСтатьям.Сумма7,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 7),
		|	ДанныеПоСтатьям.Сумма8,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 8),
		|	ДанныеПоСтатьям.Сумма9,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 9),
		|	ДанныеПоСтатьям.Сумма10,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 10),
		|	ДанныеПоСтатьям.Сумма11,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|	ДанныеПоСтатьям.Номенклатура,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 11),
		|	ДанныеПоСтатьям.Сумма12,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	&НачалоПериода,
		|	ДанныеПоСтатьям.Сумма1,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 1),
		|	ДанныеПоСтатьям.Сумма2,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 2),
		|	ДанныеПоСтатьям.Сумма3,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 3),
		|	ДанныеПоСтатьям.Сумма4,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 4),
		|	ДанныеПоСтатьям.Сумма5,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 5),
		|	ДанныеПоСтатьям.Сумма6,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 6),
		|	ДанныеПоСтатьям.Сумма7,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 7),
		|	ДанныеПоСтатьям.Сумма8,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 8),
		|	ДанныеПоСтатьям.Сумма9,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 9),
		|	ДанныеПоСтатьям.Сумма10,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 10),
		|	ДанныеПоСтатьям.Сумма11,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Ссылка.ФормируемыйБюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 11),
		|	ДанныеПоСтатьям.Сумма12,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Бюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	"""",
		|	ДанныеПоСтатьям.Период,
		|	ДанныеПоСтатьям.Сумма,
		|	0,
		|	0,
		|	NULL
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.ЗависимыеОбороты КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент";
	ИначеЕсли ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Корректировка Тогда
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("ВидТаблицы",СтруктураШапкиДокумента.ВидРасчетнойТаблицы);
		Запрос.УстановитьПараметр("Организация",СтруктураШапкиДокумента.Организация);
		Запрос.УстановитьПараметр("ФормируемыйБюджет",СтруктураШапкиДокумента.ФормируемыйБюджет);
		Запрос.УстановитьПараметр("ТекДокумент",ЭтотОбъект.Ссылка);
		Запрос.УстановитьПараметр("Началопериода",СтруктураШапкиДокумента.ПериодПланирования);
		Запрос.УстановитьПараметр("Конецпериода",КонецГода(СтруктураШапкиДокумента.ПериодПланирования));
		Запрос.УстановитьПараметр("Статус",Перечисления.СостоянияОбъектов.Утвержден);
		
		Текст =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Номенклатура,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Ссылка,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ГодУрожая,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Период,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Количество,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.УчетнаяЦена,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.КоличествоМесяцевХранения,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.РасценкаХранения,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.РасходыПоХранению,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПроцентВознагрожденияБанка,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВознагрожденияБанка,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.РеализационнаяЦена1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПроцентВознагрожденияКорпорации,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВознагрожденияКорпорации,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПроцентМаржа,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаМаржа,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.РеализационнаяЦена2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СтавкаРефинансирования,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаРефинансирования,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаБезНДС,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаСНДС,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.РеализационнаяЦена,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ЦенаВВалютеДокумента,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПроцентБиржевыхУслуг,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаБиржевыхУслуг,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Себестоимость,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Страна,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаРасходовПоРеализации,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.УсловиеОплаты,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ОС,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ЕдиницаИзмерения,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Цена,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.КонтрольнаяСумма,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Примечание,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.НормаРасходаНа100КмВЛетнееВремя,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.НормаРасходаНа100КмВЗимнееВремя,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПробегВДень,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ЧислоДнейМесяца,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ЦенаЗаЛитр,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.НормаРасходаВДень,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.кЧислоДнейМесяца,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ктариф,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комДолжность,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комЦельКомандировки,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комКоличествоЧеловек,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комКоличествоКомандировок,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комКоличествоДней,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комСрокКомандировки,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комПроезд,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комПроживание,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комСуточные,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комНормаСуточных,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.комНормаПроживание,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.арКоличествоШтатныхЕдиниц,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.арКоличествоКвМетровНаЧеловека,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.арЦена,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СтатьяБюджета,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПорядковыйНомерПоказателя,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.амКоэффициентАмортизации,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.НМА,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.амСрокПолезногоИспользования,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПризнакКорректировки,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Регион,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.амДатаПринятияКУчету,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.пвНаименованиеСеминара,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.пвКонтрагент,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.пвМестоПроведения,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.пвМесяцПроведения,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.пвПодразделение,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.пвПериодПроведения,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСумма12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИКонтрольнаяСумма,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Отклонение,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СпособЗакупок,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.АвансПлатеж,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаНачПроведенияЗакупок,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаКонПроведенияЗакупок,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаНачПоставокТовара,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаКонПоставокТовара,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.МестоПроведЗакупок,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.МестоПоставкиТоваров,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ФИООбучаемого,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаПоступления12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаВыбытия12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаПоступления12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИСуммаВыбытия12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.КонтрольнаяСуммаПоступления,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.КонтрольнаяСуммаВыбытия,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИКонтрольнаяСуммаПоступления,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ИКонтрольнаяСуммаВыбытия,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ПоступлениеСумма12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ВыбытиеСумма12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иПоступлениеСумма12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВыбытиеСумма12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.КонтрольнаяСуммаПоступление,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.КонтрольнаяСуммаВыбытие,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иКонтрольнаяСуммаПоступление,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иКонтрольнаяСуммаВыбытие,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сумма0,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.СуммаФактПозапрошлогоГода,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ОбъемЗакупаВНатуральномВыражении,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Вознаграждение12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаПоступления12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.ДатаВыбытия12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иВознаграждение12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.КонтрольнаяСуммаВознаграждение,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иКонтрольнаяСуммаВознаграждение,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Выплачивать12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Сдвиг12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.иСдвиг12
		|ПОМЕСТИТЬ ДанныеПоСтатьям
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблица КАК б_РасчетнаяТаблицаРасчетнаяТаблица
		|ГДЕ
		|	б_РасчетнаяТаблицаРасчетнаяТаблица.Ссылка = &ТекДокумент
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Ссылка,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.НомерСтроки,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Номенклатура,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ОС,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ЕдиницаИзмерения,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Количество,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.КонтрольнаяСумма,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Примечание,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Сумма12,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.НормаРасходаНа100КмВЛетнееВремя,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.НормаРасходаНа100КмВЗимнееВремя,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ЦенаЗаЛитр,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ПризнакКорректировки,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИКонтрольнаяСумма,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма1,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма2,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма3,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма4,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма5,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма6,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма7,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма8,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма9,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма10,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма11,
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.ИСумма12
		|ПОМЕСТИТЬ ДанныеПоСтатьямМасло
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.РасчетнаяТаблицаМасло КАК б_РасчетнаяТаблицаРасчетнаяТаблицаМасло
		|ГДЕ
		|	б_РасчетнаяТаблицаРасчетнаяТаблицаМасло.Ссылка = &ТекДокумент
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	б_РасчетнаяТаблицаНалоги.Ссылка,
		|	б_РасчетнаяТаблицаНалоги.НомерСтроки,
		|	б_РасчетнаяТаблицаНалоги.СтатьяБюджета,
		|	б_РасчетнаяТаблицаНалоги.Сумма1,
		|	б_РасчетнаяТаблицаНалоги.Сумма2,
		|	б_РасчетнаяТаблицаНалоги.Сумма3,
		|	б_РасчетнаяТаблицаНалоги.Сумма4,
		|	б_РасчетнаяТаблицаНалоги.Сумма5,
		|	б_РасчетнаяТаблицаНалоги.Сумма6,
		|	б_РасчетнаяТаблицаНалоги.Сумма7,
		|	б_РасчетнаяТаблицаНалоги.Сумма8,
		|	б_РасчетнаяТаблицаНалоги.Сумма9,
		|	б_РасчетнаяТаблицаНалоги.Сумма10,
		|	б_РасчетнаяТаблицаНалоги.Сумма11,
		|	б_РасчетнаяТаблицаНалоги.Сумма12,
		|	б_РасчетнаяТаблицаНалоги.КонтрольнаяСумма,
		|	б_РасчетнаяТаблицаНалоги.ПризнакКорректировки,
		|	б_РасчетнаяТаблицаНалоги.ИСумма1,
		|	б_РасчетнаяТаблицаНалоги.ИСумма2,
		|	б_РасчетнаяТаблицаНалоги.ИСумма3,
		|	б_РасчетнаяТаблицаНалоги.ИСумма4,
		|	б_РасчетнаяТаблицаНалоги.ИСумма5,
		|	б_РасчетнаяТаблицаНалоги.ИСумма6,
		|	б_РасчетнаяТаблицаНалоги.ИСумма7,
		|	б_РасчетнаяТаблицаНалоги.ИСумма8,
		|	б_РасчетнаяТаблицаНалоги.ИСумма9,
		|	б_РасчетнаяТаблицаНалоги.ИСумма10,
		|	б_РасчетнаяТаблицаНалоги.ИСумма11,
		|	б_РасчетнаяТаблицаНалоги.ИСумма12,
		|	б_РасчетнаяТаблицаНалоги.ИКонтрольнаяСумма,
		|	б_РасчетнаяТаблицаНалоги.Отклонение
		|ПОМЕСТИТЬ Налоги
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.Налоги КАК б_РасчетнаяТаблицаНалоги
		|ГДЕ
		|	б_РасчетнаяТаблицаНалоги.Ссылка = &ТекДокумент
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	&Организация КАК организация,
		|	&ФормируемыйБюджет КАК Бюджет,
		|	Январь.СтатьяБюджета,
		|	&НачалоПериода КАК Период,
		|	Январь.Сумма - Январь.ИСумма КАК Сумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма1) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма1) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма1),
		|		СУММА(ДанныеПоСтатьям.ИСумма1)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма1),
		|		СУММА(ДанныеПоСтатьям.ИСумма1)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Январь
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Февраль.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 1),
		|	Февраль.Сумма - Февраль.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма2) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма2) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма2),
		|		СУММА(ДанныеПоСтатьям.ИСумма2)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма2),
		|		СУММА(ДанныеПоСтатьям.ИСумма2)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Февраль
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Март.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 2),
		|	Март.Сумма - Март.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма3) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма3) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма3),
		|		СУММА(ДанныеПоСтатьям.ИСумма3)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма3),
		|		СУММА(ДанныеПоСтатьям.ИСумма3)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Март
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Апрель.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 3),
		|	Апрель.Сумма - Апрель.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма4) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма4) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма4),
		|		СУММА(ДанныеПоСтатьям.ИСумма4)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма4),
		|		СУММА(ДанныеПоСтатьям.ИСумма4)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Апрель
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Май.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 4),
		|	Май.Сумма - Май.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма5) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма5) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма5),
		|		СУММА(ДанныеПоСтатьям.ИСумма5)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма5),
		|		СУММА(ДанныеПоСтатьям.ИСумма5)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Май
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Июнь.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 5),
		|	Июнь.Сумма - Июнь.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма6) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма6) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма6),
		|		СУММА(ДанныеПоСтатьям.ИСумма6)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма6),
		|		СУММА(ДанныеПоСтатьям.ИСумма6)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Июнь
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Июль.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 6),
		|	Июль.Сумма - Июль.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма7) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма7) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма7),
		|		СУММА(ДанныеПоСтатьям.ИСумма7)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма7),
		|		СУММА(ДанныеПоСтатьям.ИСумма7)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Июль
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Август.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 7),
		|	Август.Сумма - Август.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма8) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма8) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма8),
		|		СУММА(ДанныеПоСтатьям.ИСумма8)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма8),
		|		СУММА(ДанныеПоСтатьям.ИСумма8)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Август
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Сентябрь.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 8),
		|	Сентябрь.Сумма - Сентябрь.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма9) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма9) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма9),
		|		СУММА(ДанныеПоСтатьям.ИСумма9)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма9),
		|		СУММА(ДанныеПоСтатьям.ИСумма9)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Сентябрь
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Октябрь.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 9),
		|	Октябрь.Сумма - Октябрь.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма10) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма10) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма10),
		|		СУММА(ДанныеПоСтатьям.ИСумма10)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма10),
		|		СУММА(ДанныеПоСтатьям.ИСумма10)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Октябрь
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Ноябрь.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 10),
		|	Ноябрь.Сумма - Ноябрь.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма11) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма11) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма11),
		|		СУММА(ДанныеПоСтатьям.ИСумма11)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма11),
		|		СУММА(ДанныеПоСтатьям.ИСумма11)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Ноябрь
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	&Организация,
		|	&ФормируемыйБюджет,
		|	Декабрь.СтатьяБюджета,
		|	ДОБАВИТЬКДАТЕ(&НачалоПериода, МЕСЯЦ, 11),
		|	Декабрь.Сумма - Декабрь.ИСумма
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ КАК СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма12) КАК Сумма,
		|		СУММА(ДанныеПоСтатьям.ИСумма12) КАК ИСумма
		|	ИЗ
		|		ДанныеПоСтатьям КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ПоГруппеСтатейБюджета)
		|				ИЛИ &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.ДенежныеСредства3БО)
		|				ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|			ИНАЧЕ ВЫБОР
		|					КОГДА &ВидТаблицы = ЗНАЧЕНИЕ(Перечисление.б_ВидыРасчетныхТаблиц.Зарплата)
		|						ТОГДА ДанныеПоСтатьям.СтатьяБюджета
		|					ИНАЧЕ ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|				КОНЕЦ
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма12),
		|		СУММА(ДанныеПоСтатьям.ИСумма12)
		|	ИЗ
		|		ДанныеПоСтатьямМасло КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.Ссылка.СтатьяБюджета
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДанныеПоСтатьям.СтатьяБюджета,
		|		СУММА(ДанныеПоСтатьям.Сумма12),
		|		СУММА(ДанныеПоСтатьям.ИСумма12)
		|	ИЗ
		|		Налоги КАК ДанныеПоСтатьям
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДанныеПоСтатьям.СтатьяБюджета) КАК Декабрь
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеПоСтатьям.Ссылка.Организация,
		|	ДанныеПоСтатьям.Бюджет,
		|	ДанныеПоСтатьям.СтатьяБюджета,
		|	ДанныеПоСтатьям.Период,
		|	ДанныеПоСтатьям.Сумма
		|ИЗ
		|	Документ.б_РасчетнаяТаблица.ЗависимыеОбороты КАК ДанныеПоСтатьям
		|ГДЕ
		|	ДанныеПоСтатьям.Ссылка = &ТекДокумент";
		
		Запрос.Текст = Текст;

		
		КонецЕсли;
	
	
	Возврат Запрос.Выполнить().Выгрузить();
 
КонецФункции


// Процедура выполняет движения по регистрам
//
Процедура ДвиженияПоРегистрам(РежимПроведения, СтруктураШапкиДокумента,
									ТаблицаПоРасчетнойТаблице, ТаблицаПоРасчетнойТаблицеДляБюджета, Отказ, Заголовок)
									
	Для Каждого Движение из Движения Цикл
		Движение.Записывать = истина;
	КонецЦикла;
	
	Движения.б_Бюджет.БлокироватьДляИзменения = Истина;
	Движения.фин_Бюджетирование.БлокироватьДляИзменения = Истина;	
	
	//Зафиксировать расчетную таблицу
	ДвижениеПоБюджетам	= Движения.СформированныеРасчетныеТаблицы.Добавить();
	ДвижениеПоБюджетам.Бюджет = СтруктураШапкиДокумента.Формируемыйбюджет;
	ДвижениеПоБюджетам.Организация = СтруктураШапкиДокумента.Организация;
	ДвижениеПоБюджетам.Сценарий 			= СтруктураШапкиДокумента.Сценарий;
	ДвижениеПоБюджетам.Видоперации 			= СтруктураШапкиДокумента.Видоперации;
	ДвижениеПоБюджетам.ПериодПланирования 	= СтруктураШапкиДокумента.ПериодПланирования;
	//ДвижениеПоБюджетам.Проект = СтруктураШапкиДокумента.Проект;
	ДвижениеПоБюджетам.СтатьяБюджета 		= СтруктураШапкиДокумента.СтатьяБюджета;
	//ЦС
	ДвижениеПоБюджетам.ВидКорректировки 		= СтруктураШапкиДокумента.ВидКорректировки;
	ДвижениеПоБюджетам.ПодразделениеОрганизации = СтруктураШапкиДокумента.ПодразделениеОрганизации;
	//ЦС
	
	// Выполнить движения по регистру накопления 	
	НаборДвижений = Движения.б_Бюджет;
	
	// Получим таблицу значений, совпадающую со струкутрой набора записей регистра.
	ТаблицаДвижений = НаборДвижений.ВыгрузитьКолонки();
	
	// Заполним таблицу движений.
	ТаблицаДанныхДляБюджета = ТаблицаПоРасчетнойТаблицеДляБюджета.Скопировать();
	
	
	ТаблицаДанныхДляБюджета.Колонки.Добавить("Активность");
	ТаблицаДанныхДляБюджета.Колонки.Добавить("Статус");
	
	ТаблицаДанныхДляБюджета.ЗаполнитьЗначения(Истина, "Активность");
	ТаблицаДанныхДляБюджета.ЗаполнитьЗначения(СтруктураШапкиДокумента.Состояние, "Статус");
	
	
	ОбщегоНазначения.ЗагрузитьВТаблицуЗначений(ТаблицаДанныхДляБюджета, ТаблицаДвижений);
	
	НаборДвижений.мТаблицаДвижений   = ТаблицаДвижений;
	
	Если Не Отказ Тогда
		//Движения.б_ОборотРасчетныхтаблиц.ВыполнитьДвижения();
		Движения.б_Бюджет.ВыполнитьДвижения();
		
		ДвиженияПоБюджету = Движения.фин_Бюджетирование;
		
		
		ТабПроводокДокумента = ДополнительныеПоБюджетированию.ВыполнитьДвижениеПроводокПоБюджетированию(ЭтотОбъект, ДвиженияПоБюджету, СтруктураШапкиДокумента, ТаблицаДанныхДляБюджета);
	КонецЕсли;

	
	
	Если ФормируемыйБюджет.Наименование = "Прогнозный портфель долговых обязательств" И ВидОперации = Перечисления.фин_ВидыОперацийБюджет.Корректировка Тогда
		Для Каждого ТекСтрокаЗависимыеОбороты Из КорректировкаДокумента.ЗависимыеОбороты Цикл
					
			Движение = Движения.б_Бюджет.Добавить();
			Движение.Период = ТекСтрокаЗависимыеОбороты.Период;
			Движение.Организация = КорректировкаДокумента.Организация;
			Движение.СтатьяБюджета = ТекСтрокаЗависимыеОбороты.СтатьяБюджета;
			Движение.Бюджет = ТекСтрокаЗависимыеОбороты.Бюджет;
			Движение.Сумма = -ТекСтрокаЗависимыеОбороты.Сумма;
		КонецЦикла;
	КонецЕсли;
	
	
Конецпроцедуры
								
////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ

// Процедура - обработчик события "ОбработкаЗаполнения".
//
Процедура ОбработкаЗаполнения(Основание)
    // Обработка для работы в версии 8.2
	Если ТипЗнч(Основание) <> Тип("Структура")
		И Основание <> НЕОПРЕДЕЛЕНО Тогда
	
		//ЗаполнитьПоДокументуОснования(Основание);
    КонецЕсли;
КонецПроцедуры // ОбработкаЗаполнения()

// Процедура вызывается перед записью документа 
//
Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	РассчитатьСдвиг();
	
	мТаблицаЗависимостей = СформироватьТаблицуЗависимостей();
	
	Если мРассчитыватьЗависимыеОбороты тогда
		  РассчитатьЗависимыеОбороты();
	КонецЕсли;
	
КонецПроцедуры // ПередЗаписью

Функция СформироватьТаблицуЗависимостей()
	
	Запрос = Новый Запрос;
										
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ЗависимостиСтатейБюджета.ЗависимыйБюджет,
	|	ЗависимостиСтатейБюджета.ЗависимаяСтатьяБюджета,
	|	ЗависимостиСтатейБюджета.Коэффициент,
	|	ЗависимостиСтатейБюджета.ВлияющийБюджет,
	|	ЗависимостиСтатейБюджета.ВлияющаяСтатьяБюджета,
	|	ЗависимостиСтатейБюджета.ПериодОтражения,
	|	ЗависимостиСтатейБюджета.ИсточникДанных
	|ИЗ
	|	РегистрСведений.ЗависимостиСтатейБюджета КАК ЗависимостиСтатейБюджета";
	
	Возврат Запрос.Выполнить().Выгрузить();

КонецФункции

процедура РассчитатьСдвиг() Экспорт
	
	Для Каждого СтрокаТЧ из РасчетнаяТаблица Цикл
		Накопление = 0;
		
		Для Сч = 1 по 12 Цикл
			Если строкатч["Выплачивать"+Сч] тогда
				строкатч["Сдвиг"+Сч] = СтрокаТЧ["Вознаграждение"+Сч]+Накопление;
				Накопление = 0;
			Иначе
				СтрокаТЧ["Сдвиг"+Сч] = 0;
				Накопление = СтрокаТЧ["Вознаграждение"+Сч]+Накопление;
			КонецЕсли;
		КонецЦикла;
		
	КонецЦикла;
	
КонецПроцедуры


Процедура ОбработкаПроведения(Отказ, РежимПроведения)
			
	// Дерево значений, содержащее имена необходимых полей в запросе по шапке.
	Перем ДеревоПолейЗапросаПоШапке;
		
	// Заголовок для сообщений об ошибках проведения.
	Заголовок = "Проведение документа """ + СокрЛП(Ссылка) + """: ";
	
	
	// Проверка ручной корректировки
	Если ОбщегоНазначения.РучнаяКорректировкаОбработкаПроведения(РучнаяКорректировка,Отказ,Заголовок,ЭтотОбъект) Тогда
		Возврат
	КонецЕсли;
	
	
	СтруктураШапкиДокумента   = ОбщегоНазначения.СформироватьСтруктуруШапкиДокумента(ЭтотОбъект);
	

	// Проверим правильность заполнения шапки документа
	ПроверитьЗаполнениеШапки(СтруктураШапкиДокумента, Отказ, Заголовок);

	ТаблицаДанных = ПодготовитьТаблицу(СтруктураШапкиДокумента);
	
	ТаблицаДанныхДляБюджета = ПодготовитьТаблицуДляБюджета(СтруктураШапкиДокумента);
	 
	Если Не Проверено Тогда
			
		Сообщить("Документ не проверили, вы можете его только записать.");
		Отказ = Истина;
									
	КонецЕсли;	
	
	// Движения по документу
	Если Не Отказ Тогда
		
		ДвиженияПоРегистрам(РежимПроведения, СтруктураШапкиДокумента, 
							ТаблицаДанных, ТаблицаДанныхДляБюджета,  Отказ, Заголовок);
							
	КонецЕсли;
						
	
	
КонецПроцедуры // ОбработкаПроведения()

// Предопределенная процедура обработки удаления проведения документа
//
Процедура ОбработкаУдаленияПроведения(Отказ)
	ОбщегоНазначения.УдалитьДвиженияРегистратора(ЭтотОбъект, Отказ, РучнаяКорректировка);
КонецПроцедуры

Процедура ПриЗаписи(Отказ)
	если ОбменДанными.Загрузка тогда
		возврат;
	КонецЕсли;

	
КонецПроцедуры

Процедура ПриКопировании(ОбъектКопирования)
	Автор = Неопределено;
	Согласован = ложь;
	Ответственный = Неопределено;
	// Вставить содержимое обработчика.
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ

мВалютаРегламентированногоУчета   = Константы.ВалютаРегламентированногоУчета.Получить();
мРассчитыватьЗависимыеОбороты = истина;