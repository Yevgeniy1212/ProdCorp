
Процедура ОбработкаПроведения(Отказ, Режим)
	
	Если СуммаПрибыли < 0 Тогда
		Отказ = Истина;
		Сообщить("Сумма прибыли за период отрицательная!");
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(СчетРезервов) Тогда
		Отказ = Истина;
		Сообщить("Не выбран счет резервов!");		
	КонецЕсли;
		
	Если Не Отказ Тогда 
		
		РегВалюта = Константы.ВалютаРегламентированногоУчета.Получить();
		
		// регистр Типовой 
		Движения.Типовой.Записывать = Истина;
		Движения.Типовой.Очистить();
		Движение = Движения.Типовой.Добавить();
		Движение.СчетДт = ПланыСчетов.Типовой.НераспределеннаяПрибыльНепокрытыйУбытокПредыдущихЛет;
		Движение.СчетКт = ПланыСчетов.Типовой.КраткосрочнаяКредиторскаяЗадолженностьПоДивидендамИДоходамУчастников;
		Движение.Период = Дата;
		Движение.Организация = Организация;
		Движение.Сумма = СуммаДивидендов;
		Если Движение.СчетКт.Валютный Тогда
			Движение.ВалютаКт = РегВалюта;
			Движение.ВалютнаяСуммаКт = СуммаДивидендов;
		КонецЕсли;
		Движение.Содержание = Содержание;
		Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконтоТиповые.Контрагенты] = Контрагент;
		Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконтоТиповые.Договоры] = Договор;
		Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконтоТиповые.ТипыОпераций] = ТипОперации;
						
		// регистр Типовой 
		Движение = Движения.Типовой.Добавить();
		Движение.СчетДт = ПланыСчетов.Типовой.НераспределеннаяПрибыльНепокрытыйУбытокПредыдущихЛет;
		Движение.СчетКт = СчетРезервов;
		Движение.Период = Дата;
		Движение.Организация = Организация;
		Движение.Сумма = СуммаПрибыли - СуммаДивидендов;
		Если Движение.СчетКт.Валютный Тогда
			Движение.ВалютаКт = РегВалюта;
			Движение.ВалютнаяСуммаКт = СуммаПрибыли - СуммаДивидендов;
		КонецЕсли;
		Движение.СубконтоКт[ПланыВидовХарактеристик.ВидыСубконтоТиповые.ВидыИзмененийВСобственномКапитале] = Перечисления.ВидыИзмененийВСобственномКапитале.ДоходУбытокЗаПериод;
		Движение.Содержание = Договор;
		
	КонецЕсли;
	
КонецПроцедуры
