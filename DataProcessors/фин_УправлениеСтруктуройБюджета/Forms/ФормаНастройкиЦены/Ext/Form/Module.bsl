
// Обновляет списки выбора для показателей источников данных
//
//
&НаСервере
Процедура ОбновитьСпискиВыбора()
	
	Если НЕ ИсточникДанныхДляЦены.Пустая() Тогда

		СписокВыбораПоказательЦены.Очистить();

		Для Каждого Показатель Из ИсточникДанныхДляЦены.Показатели Цикл

			Если Показатель.Использование Тогда
				СписокВыбораПоказательЦены.Добавить(Показатель.Имя, Показатель.Представление);
			КонецЕсли;

		КонецЦикла; 

	КонецЕсли;
	
КонецПроцедуры // ОбновитьСпискиВыбора()

&НаКлиенте
Процедура ИсточникДанныхДляЦеныПриИзменении(Элемент)
	ПоказательИсточникаДанныхДляЦены = "";
	ОбновитьСпискиВыбора();
КонецПроцедуры

&НаКлиенте
Процедура ПоказательИсточникаДанныхДляЦеныНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка=Ложь;
	ДанныеВыбора = СписокВыбораПоказательЦены;
КонецПроцедуры

&НаКлиенте
Процедура СпособЦенообразованияПриИзменении(Элемент)
	ИспользуемыйТипЦен 				= фин_ОбщегоНазначенияКлиентПовтИсп.ПустойТипПлановыхЦен();
	ИсточникДанныхДляЦены 			= ПредопределенноеЗначение("Справочник.фин_ИсточникиДанныхДляРасчетовБюджетирования.ПустаяСсылка");
	ПоказательИсточникаДанныхДляЦены	= "";
	Элементы.ИсточникДанныхДляЦены.Видимость = СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоДаннымИсточникаРасчетов");
	Элементы.ПоказательИсточникаДанныхДляЦены.Видимость = СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоДаннымИсточникаРасчетов");
	Элементы.ИспользуемыйТипЦен.Видимость = СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоПрогнознымЦенамНоменклатуры") ИЛИ СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоБухгалтерскимЦенамНоменклатуры") ИЛИ СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоЦенамПоставщиков");
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Параметры.Свойство("СпособЦенообразования") Тогда
		ИспользуемыйТипЦен = Параметры.ИспользуемыйТипЦен;
		ИсточникДанныхДляЦены = Параметры.ИсточникДанныхДляЦены;
		ПоказательИсточникаДанныхДляЦены = Параметры.ПоказательИсточникаДанныхДляЦены;
		СпособЦенообразования = Параметры.СпособЦенообразования;
		ОбновитьСпискиВыбора();
	КонецЕсли;
	Элементы.ИсточникДанныхДляЦены.Видимость = СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоДаннымИсточникаРасчетов");
	Элементы.ПоказательИсточникаДанныхДляЦены.Видимость = СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоДаннымИсточникаРасчетов");
	Элементы.ИспользуемыйТипЦен.Видимость = СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоПрогнознымЦенамНоменклатуры") ИЛИ СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоБухгалтерскимЦенамНоменклатуры") ИЛИ СпособЦенообразования=ПредопределенноеЗначение("Перечисление.фин_СпособыЦенообразованияПоФинансовымПоказателям.ПоЦенамПоставщиков");
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
	Закрыть(Новый Структура("СпособЦенообразования,ИспользуемыйТипЦен,ИсточникДанныхДляЦены,ПоказательИсточникаДанныхДляЦены",СпособЦенообразования,ИспользуемыйТипЦен,ИсточникДанныхДляЦены,ПоказательИсточникаДанныхДляЦены));
КонецПроцедуры

&НаКлиенте
Процедура СпособЦенообразованияНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	ДанныеВыбора = СписокСпособов();
КонецПроцедуры


&НаСервере
Функция СписокСпособов()
	Возврат фин_ПроцедурыУправленияПлановымЦенообразованием.СписокСпособов();
КонецФункции

