////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Исполнитель = фин_ОбщегоНазначенияВызовСервераПовтИсп.ЗначениеПеременной("ТекущийПользователь");
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

&НаКлиенте
Процедура ЗакрытьФорму(Команда)
	Закрыть();
КонецПроцедуры

&НаКлиенте
Процедура СохранитьЗаписи(Команда)
	Если с = '00010101' Тогда
		ПоказатьПредупреждение(, "Не указано начало периода");
		Возврат;
	КонецЕсли;
	Если мПо = '00010101' Тогда
		ПоказатьПредупреждение(, "Не указан конец периода");
		Возврат;
	КонецЕсли;
	Если мПо < с Тогда
		ПоказатьПредупреждение(, "Конец периода меньше чем начало");
		Возврат;
	КонецЕсли;
	Если СохранитьЗаписиСервер() Тогда
		Закрыть();
	КонецЕсли;
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

&НаСервере
Функция СохранитьЗаписиСервер()
	Попытка
		МЗ = РегистрыСведений.усд_ДоступностьИсполнителейСогласования.СоздатьМенеджерЗаписи();
		МЗ.Исполнитель = Исполнитель;
		МЗ.Период = С;
		МЗ.Записать();
		МЗ = РегистрыСведений.усд_ДоступностьИсполнителейСогласования.СоздатьМенеджерЗаписи();
		МЗ.Исполнитель = Исполнитель;
		МЗ.Период = КонецДня(мПо);
		МЗ.Доступность = Истина;
		МЗ.Записать();
		Возврат Истина;
	Исключение
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки());
		Возврат Ложь;
	КонецПопытки;
КонецФункции
