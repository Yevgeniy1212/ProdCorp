
&НаКлиенте
Процедура ИсточникДанныхДляФактаПриИзменении(Элемент)

	Запись.ПоказательИсточникаДанныхДляФактаКол    = "";
	Запись.ПоказательИсточникаДанныхДляФактаСум    = "";
	Запись.КоэффициентДляФактаКол                  = 1;
	Запись.КоэффициентДляФактаСум                  = 1;
	Запись.СпособОпределенияВалютыОборотаФакт      = ПредопределенноеЗначение("Перечисление.фин_СпособыОпределенияВалютыОборотаПоСтатье.ПустаяСсылка");
	
	ОбновитьСпискиВыбора();
	
КонецПроцедуры

&НаКлиенте
Процедура ИсточникДанныхДляФактаОчистка(Элемент, СтандартнаяОбработка)
    Запись.ПоказательИсточникаДанныхДляФактаСум = "";
	Запись.ПоказательИсточникаДанныхДляФактаКол = "";
	Запись.СпособОпределенияВалютыОборотаФакт      = ПредопределенноеЗначение("Перечисление.фин_СпособыОпределенияВалютыОборотаПоСтатье.ПустаяСсылка");
	
	Запись.КоэффициентДляФактаКол = 0;
	Запись.КоэффициентДляФактаСум = 0;
КонецПроцедуры

&НаКлиенте
Процедура ПоказательИсточникаДанныхДляФактаСумНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	ДанныеВыбора = СписокВыбораСуммаФакт;
КонецПроцедуры

&НаКлиенте
Процедура СпособОпределенияВалютыОборотаФактНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка=Ложь;
	ДанныеВыбора = СписокВыбораВалютаФакт;
КонецПроцедуры


// Обновляет списки выбора для показателей источников данных
//
//
&НаСервере
Процедура ОбновитьСпискиВыбора()
	
	СписокВыбораСуммаФакт.Очистить();
	СписокВыбораВалютаФакт.Очистить();
	Если НЕ Запись.ИсточникДанныхДляФакта.Пустая() Тогда


		Для Каждого Показатель Из Запись.ИсточникДанныхДляФакта.Показатели Цикл

			Если Показатель.Использование Тогда
				СписокВыбораСуммаФакт.Добавить(Показатель.Имя, Показатель.Представление);
			КонецЕсли;

		КонецЦикла; 

		СписокВыбораВалютаФакт.Добавить(Перечисления.фин_СпособыОпределенияВалютыОборотаПоСтатье.ВалютаУправленческогоУчета,      "Валюта управленческого учета");
		СписокВыбораВалютаФакт.Добавить(Перечисления.фин_СпособыОпределенияВалютыОборотаПоСтатье.ВалютаРегламентированногоУчета,  "Валюта регламентированного учета");
		СписокВыбораВалютаФакт.Добавить(Перечисления.фин_СпособыОпределенияВалютыОборотаПоСтатье.ОсновнаяВалютаСтатьи,            "Основная валюта статьи");
		
		Если НЕ Запись.ИсточникДанныхДляФакта.ИзмеренияИсточника.Найти(Перечисления.фин_ФактическиеПоказателиБюджетирования.Валюта,"ИзмерениеБюджетирования")=Неопределено Тогда
			
			СписокВыбораВалютаФакт.Добавить(Перечисления.фин_СпособыОпределенияВалютыОборотаПоСтатье.ВалютаИсточникаДанных,"Валюта источника данных");
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры // ОбновитьСпискиВыбора()

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ОбновитьСпискиВыбора();
	НадписьНастройкаРасчетаФактическихДанных = "Настройка расчета фактических данных";
	Если ЗначениеЗаполнено(Запись.ФинансовыйПоказатель) Тогда
		УстановитьВидимость();
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура УстановитьВидимость()
	Если Запись.ФинансовыйПоказатель<>Неопределено Тогда
		ПоКоличеству = ?(ТипЗнч(Запись.ФинансовыйПоказатель)=Тип("СправочникСсылка.фин_ФинансовыеПоказатели"),Запись.ФинансовыйПоказатель.УчетПоКоличеству,Запись.ФинансовыйПоказатель.Количественный);
		ПоСумме = ?(ТипЗнч(Запись.ФинансовыйПоказатель)=Тип("СправочникСсылка.фин_ФинансовыеПоказатели"),Запись.ФинансовыйПоказатель.УчетПоСумме,Истина);
	Иначе
		ПоКоличеству = Ложь;
		ПоСумме = Ложь;
	КонецЕсли;
	Элементы.КоэффициентДляФактаКол.Видимость = ПоКоличеству;
	Элементы.ПоказательИсточникаДанныхДляФактаКол.Видимость = ПоКоличеству;
	Элементы.КоэффициентДляФактаСум.Видимость = ПоСумме;
	Элементы.ПоказательИсточникаДанныхДляФактаСум.Видимость = ПоСумме;
	Элементы.СпособОпределенияВалютыОборотаФакт.Видимость = ПоСумме;
КонецПроцедуры

&НаКлиенте
Процедура ФинансовыйПоказательПриИзменении(Элемент)
	ПриИзмененииФинансовогоПоказателя();
КонецПроцедуры

&НаСервере
Процедура ПриИзмененииФинансовогоПоказателя()
	Если Запись.ФинансовыйПоказатель=Неопределено Тогда
		ПоКоличеству = ?(ТипЗнч(Запись.ФинансовыйПоказатель)=Тип("СправочникСсылка.фин_ФинансовыеПоказатели"),Запись.ФинансовыйПоказатель.УчетПоКоличеству,Запись.ФинансовыйПоказатель.Количественный);
		ПоСумме = ?(ТипЗнч(Запись.ФинансовыйПоказатель)=Тип("СправочникСсылка.фин_ФинансовыеПоказатели"),Запись.ФинансовыйПоказатель.УчетПоСумме,Истина);
	Иначе
		ПоКоличеству = Ложь;
		ПоСумме = Ложь;
	КонецЕсли;
	Если НЕ ПоКоличеству Тогда
		Запись.ПоказательИсточникаДанныхДляФактаКол    = "";
		Запись.КоэффициентДляФактаКол                  = 1;
	КонецЕсли;

	Если НЕ ПоСумме Тогда
		Запись.ПоказательИсточникаДанныхДляФактаСум    = "";
		Запись.КоэффициентДляФактаСум                  = 1;
		Запись.СпособОпределенияВалютыОборотаФакт      = ПредопределенноеЗначение("Перечисление.фин_СпособыОпределенияВалютыОборотаПоСтатье.ПустаяСсылка");
	КонецЕсли;

	УстановитьВидимость();
КонецПроцедуры
