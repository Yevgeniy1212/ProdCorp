<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>Данные</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодДействия</dataPath>
			<field>ПериодДействия</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период действия</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодРегистрации</dataPath>
			<field>ПериодРегистрации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период регистрации</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидЗанятости</dataPath>
			<field>ВидЗанятости</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вид занятости</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидРасчета</dataPath>
			<field>ВидРасчета</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вид расчета</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Должность</dataPath>
			<field>Должность</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Должность</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДолжностьПоОсновномуМестуРаботы</dataPath>
			<field>ДолжностьПоОсновномуМестуРаботы</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Должность по основному месту работы</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодСтроки</dataPath>
			<field>КодСтроки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код строки</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Начислено</dataPath>
			<field>Начислено</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Начислено</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Организация</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОтработаноДней</dataPath>
			<field>ОтработаноДней</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Отработано дней</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОтработаноЧасов</dataPath>
			<field>ОтработаноЧасов</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Отработано часов</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодВключенияВФондЗаработнойПлаты</dataPath>
			<field>ПериодВключенияВФондЗаработнойПлаты</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеДляОтнесенияЗатрат</dataPath>
			<field>ПодразделениеДляОтнесенияЗатрат</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеОрганизации</dataPath>
			<field>ПодразделениеОрганизации</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеОрганизацииПоОсновномуМестуРаботы</dataPath>
			<field>ПодразделениеОрганизацииПоОсновномуМестуРаботы</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РаботаетПоДоговоруГПХ</dataPath>
			<field>РаботаетПоДоговоруГПХ</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Регистратор</dataPath>
			<field>Регистратор</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТарифныйРазряд</dataPath>
			<field>ТарифныйРазряд</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>УчитываемыеДни</dataPath>
			<field>УчитываемыеДни</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>УчитываемыеЧасы</dataPath>
			<field>УчитываемыеЧасы</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>УчтеноПриФормированииПроводок</dataPath>
			<field>УчтеноПриФормированииПроводок</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФизЛицо</dataPath>
			<field>ФизЛицо</field>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<attributeUseRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФондЗаработнойПлаты</dataPath>
			<field>ФондЗаработнойПлаты</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сотрудник</dataPath>
			<field>Сотрудник</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Начислено.Результат КАК Начислено,
	Начислено.ФондЗаработнойПлаты КАК ФондЗаработнойПлаты,
	Начислено.ОтработаноДней КАК ОтработаноДней,
	Начислено.ОтработаноЧасов КАК ОтработаноЧасов,
	Начислено.УчитываемыеДни КАК УчитываемыеДни,
	Начислено.УчитываемыеЧасы КАК УчитываемыеЧасы,
	Начислено.УчтеноПриФормированииПроводок КАК УчтеноПриФормированииПроводок,
	Начислено.Регистратор КАК Регистратор,
	ПлановыеНачисления.ФизЛицо КАК ФизЛицо,
	ПлановыеНачисления.Сотрудник КАК Сотрудник,
	ПлановыеНачисления.ВидРасчета КАК ВидРасчета,
	ПлановыеНачисления.ОбособленноеПодразделение КАК Организация,
	ПлановыеНачисления.ПериодРегистрации КАК ПериодРегистрации,
	ПлановыеНачисления.ПериодДействия,
	ПлановыеНачисления.ПериодВключенияВФондЗаработнойПлаты,
	ДанныеОНазначениях.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	ДанныеОНазначениях.Должность КАК Должность,
	ДанныеОНазначениях.ТарифныйРазряд КАК ТарифныйРазряд,
	ДанныеОНазначениях.ВидЗанятости КАК ВидЗанятости,
	ДанныеОНазначениях.ПодразделениеОрганизацииПоОсновномуМестуРаботы КАК ПодразделениеОрганизацииПоОсновномуМестуРаботы,
	ДанныеОНазначениях.ДолжностьПоОсновномуМестуРаботы КАК ДолжностьПоОсновномуМестуРаботы,
	ДанныеОНазначениях.РаботаетПоДоговоруГПХ КАК РаботаетПоДоговоруГПХ,
	ПлановыеНачисления.ПодразделениеОрганизации КАК ПодразделениеДляОтнесенияЗатрат,
	КодыСтрокДекларацииПоСН.КодСтроки
{ВЫБРАТЬ
	Организация.*,
	ПериодРегистрации,
	ПодразделениеОрганизации.*,
	Должность.*,
	Сотрудник.*,
	ВидРасчета.*,
	Начислено,
	УчтеноПриФормированииПроводок}
ИЗ
	(ВЫБРАТЬ РАЗЛИЧНЫЕ
		ПлановыеНачисления.ФизЛицо КАК ФизЛицо,
		ПлановыеНачисления.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
		ПлановыеНачисления.Сотрудник КАК Сотрудник,
		ПлановыеНачисления.ВидРасчета КАК ВидРасчета,
		ПлановыеНачисления.ПериодРегистрации КАК ПериодРегистрации,
		ПлановыеНачисления.ПериодДействия КАК ПериодДействия,
		ПлановыеНачисления.ПериодВключенияВФондЗаработнойПлаты КАК ПериодВключенияВФондЗаработнойПлаты,
		ПлановыеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации
	ИЗ
		(ВЫБРАТЬ РАЗЛИЧНЫЕ
			ОсновныеНачисленияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
			ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
			ОсновныеНачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник,
			ОсновныеНачисленияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
			ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации КАК ПериодРегистрации,
			ОсновныеНачисленияРаботниковОрганизации.ПериодДействия КАК ПериодДействия,
			ВЫБОР
				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						И ОсновныеНачисленияРаботниковОрганизации.ПериодДействия &gt;= ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ПериодДействия
				ИНАЧЕ ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
			КОНЕЦ КАК ПериодВключенияВФондЗаработнойПлаты,
			ОсновныеНачисленияРаботниковОрганизации.ПодразделениеОрганизации КАК ПодразделениеОрганизации
		ИЗ
			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
		ГДЕ
			(ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
					ИЛИ ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						И ОсновныеНачисленияРаботниковОрганизации.ПериодДействия &gt;= ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
						И (ОсновныеНачисленияРаботниковОрганизации.ПериодДействия МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода)
						И ОсновныеНачисленияРаботниковОрганизации.Результат &lt;&gt; 0)
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ РАЗЛИЧНЫЕ
			ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
			ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
			ДополнительныеНачисленияРаботниковОрганизации.Сотрудник,
			ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета,
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
			ДополнительныеНачисленияРаботниковОрганизации.ПодразделениеОрганизации
		ИЗ
			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизации
		ГДЕ
			ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ РАЗЛИЧНЫЕ
			БУОсновныеНачисления.ФизЛицо,
			БУОсновныеНачисления.ОбособленноеПодразделение,
			БУОсновныеНачисления.Сотрудник,
			БУОсновныеНачисления.ВидРасчета,
			БУОсновныеНачисления.ПериодРегистрации,
			БУОсновныеНачисления.ПериодДействия,
			ВЫБОР
				КОГДА БУОсновныеНачисления.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						И БУОсновныеНачисления.ПериодДействия &gt;= БУОсновныеНачисления.ПериодРегистрации
					ТОГДА БУОсновныеНачисления.ПериодДействия
				ИНАЧЕ БУОсновныеНачисления.ПериодРегистрации
			КОНЕЦ,
			ВЫБОР
				КОГДА БУОсновныеНачисления.СубконтоДт1 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт1 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУОсновныеНачисления.СубконтоДт2 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт2 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУОсновныеНачисления.СубконтоДт3 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт3 КАК Справочник.ПодразделенияОрганизаций)
			КОНЕЦ
		ИЗ
			РегистрРасчета.БУОсновныеНачисления КАК БУОсновныеНачисления
		ГДЕ
			БУОсновныеНачисления.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ РАЗЛИЧНЫЕ
			БУДополнительныеНачисления.ФизЛицо,
			БУДополнительныеНачисления.ОбособленноеПодразделение,
			БУДополнительныеНачисления.Сотрудник,
			БУДополнительныеНачисления.ВидРасчета,
			БУДополнительныеНачисления.ПериодРегистрации,
			БУДополнительныеНачисления.ПериодРегистрации,
			БУДополнительныеНачисления.ПериодРегистрации,
			ВЫБОР
				КОГДА БУДополнительныеНачисления.СубконтоДт1 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт1 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУДополнительныеНачисления.СубконтоДт2 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт2 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУДополнительныеНачисления.СубконтоДт3 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт3 КАК Справочник.ПодразделенияОрганизаций)
			КОНЕЦ
		ИЗ
			РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления
		ГДЕ
			БУДополнительныеНачисления.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ РАЗЛИЧНЫЕ
			СНСведенияОДоходах.ФизЛицо,
			СНСведенияОДоходах.Организация,
			ЕСТЬNULL(РаботникиОрганизации.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)),
			СНСведенияОДоходах.ВидРасчета,
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.Период, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
			ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка))
		ИЗ
			РегистрНакопления.СНСведенияОДоходах КАК СНСведенияОДоходах
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					Периоды.ПериодРегистрации КАК ПериодРегистрации,
					РаботникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
					РаботникиОрганизации.Организация КАК Организация,
					РаботникиОрганизации.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
					МАКСИМУМ(РаботникиОрганизации.Период) КАК Период
				ИЗ
					(ВЫБРАТЬ РАЗЛИЧНЫЕ
						НАЧАЛОПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации,
						КОНЕЦПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК КонецПериодаРегистрации
					ИЗ
						РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РеглПроизводственныйКалендарь
					ГДЕ
						РеглПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, -3) И КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&amp;КонецПериода, МЕСЯЦ, 3), МЕСЯЦ)) КАК Периоды
						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
						ПО (РаботникиОрганизации.Период &lt;= Периоды.КонецПериодаРегистрации)
							И (РаботникиОрганизации.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
							И РаботникиОрганизации.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				
				СГРУППИРОВАТЬ ПО
					Периоды.ПериодРегистрации,
					РаботникиОрганизации.Сотрудник.Физлицо,
					РаботникиОрганизации.Организация,
					РаботникиОрганизации.ОбособленноеПодразделение) КАК РаботникиОрганизацииСрезПоследних
				ПО СНСведенияОДоходах.ФизЛицо = РаботникиОрганизацииСрезПоследних.ФизЛицо
					И СНСведенияОДоходах.Организация = РаботникиОрганизацииСрезПоследних.ОбособленноеПодразделение
					И (НАЧАЛОПЕРИОДА(СНСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = РаботникиОрганизацииСрезПоследних.ПериодРегистрации)
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
				ПО (РаботникиОрганизацииСрезПоследних.Организация = РаботникиОрганизации.Организация)
					И (РаботникиОрганизацииСрезПоследних.ФизЛицо = РаботникиОрганизации.Сотрудник.Физлицо)
					И (РаботникиОрганизацииСрезПоследних.Период = РаботникиОрганизации.Период)
					И РаботникиОрганизации.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
					И (РаботникиОрганизации.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
		ГДЕ
			СНСведенияОДоходах.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
			И СНСведенияОДоходах.Регистратор ССЫЛКА Документ.РегистрацияПрочихДоходовВЦеляхНалогообложения) КАК ПлановыеНачисления) КАК ПлановыеНачисления
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ОсновныеНачисленияРаботниковОрганизации.Регистратор КАК Регистратор,
			ОсновныеНачисленияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
			ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
			ОсновныеНачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник,
			ОсновныеНачисленияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
			ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации КАК ПериодРегистрации,
			ОсновныеНачисленияРаботниковОрганизации.ПериодДействия КАК ПериодДействия,
			ВЫБОР
				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						И ОсновныеНачисленияРаботниковОрганизации.ПериодДействия &gt;= ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ПериодДействия
				ИНАЧЕ ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
			КОНЕЦ КАК ПериодВключенияВФондЗаработнойПлаты,
			ОсновныеНачисленияРаботниковОрганизации.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			СУММА(ВЫБОР
					КОГДА ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
						ТОГДА ОсновныеНачисленияРаботниковОрганизации.Результат
					ИНАЧЕ 0
				КОНЕЦ) КАК Результат,
			СУММА(ВЫБОР
					КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ФондВыплат.ФондЗаработнойПлаты
							И ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
							И ОсновныеНачисленияРаботниковОрганизации.ПериодДействия &gt;= ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
							И (ОсновныеНачисленияРаботниковОрганизации.ПериодДействия МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода)
						ТОГДА ОсновныеНачисленияРаботниковОрганизации.Результат
					КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ФондВыплат.ФондЗаработнойПлаты
							И (ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета &lt;&gt; ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
								ИЛИ ОсновныеНачисленияРаботниковОрганизации.ПериодДействия &lt; ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации)
							И (ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода)
						ТОГДА ОсновныеНачисленияРаботниковОрганизации.Результат
					ИНАЧЕ 0
				КОНЕЦ) КАК ФондЗаработнойПлаты,
			0 КАК УчтеноПриФормированииПроводок,
			СУММА(ОсновныеНачисленияРаботниковОрганизации.ОтработаноДней) КАК ОтработаноДней,
			СУММА(ОсновныеНачисленияРаботниковОрганизации.ОтработаноЧасов) КАК ОтработаноЧасов,
			СУММА(ОсновныеНачисленияРаботниковОрганизации.ОтработаноДней + ОсновныеНачисленияРаботниковОрганизации.УчитываемыеДни) КАК УчитываемыеДни,
			СУММА(ОсновныеНачисленияРаботниковОрганизации.ОтработаноЧасов + ОсновныеНачисленияРаботниковОрганизации.УчитываемыеЧасы) КАК УчитываемыеЧасы
		ИЗ
			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
		ГДЕ
			(ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
					ИЛИ ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						И ОсновныеНачисленияРаботниковОрганизации.ПериодДействия &gt;= ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
						И (ОсновныеНачисленияРаботниковОрганизации.ПериодДействия МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода)
						И ОсновныеНачисленияРаботниковОрганизации.Результат &lt;&gt; 0)
		
		СГРУППИРОВАТЬ ПО
			ОсновныеНачисленияРаботниковОрганизации.Регистратор,
			ОсновныеНачисленияРаботниковОрганизации.ФизЛицо,
			ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
			ОсновныеНачисленияРаботниковОрганизации.Сотрудник,
			ОсновныеНачисленияРаботниковОрганизации.ВидРасчета,
			ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации,
			ОсновныеНачисленияРаботниковОрганизации.ПериодДействия,
			ВЫБОР
				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						И ОсновныеНачисленияРаботниковОрганизации.ПериодДействия &gt;= ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ПериодДействия
				ИНАЧЕ ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации
			КОНЕЦ,
			ОсновныеНачисленияРаботниковОрганизации.ПодразделениеОрганизации
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ДополнительныеНачисленияРаботниковОрганизации.Регистратор,
			ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
			ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
			ДополнительныеНачисленияРаботниковОрганизации.Сотрудник,
			ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета,
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
			ДополнительныеНачисленияРаботниковОрганизации.ПодразделениеОрганизации,
			СУММА(ДополнительныеНачисленияРаботниковОрганизации.Результат),
			СУММА(ВЫБОР
					КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ФондВыплат.ФондЗаработнойПлаты
						ТОГДА ДополнительныеНачисленияРаботниковОрганизации.Результат
					ИНАЧЕ 0
				КОНЕЦ),
			0,
			0,
			0,
			СУММА(ВЫБОР
					КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку)
							И (ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботыФизЛиц
									И НЕ ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ)
								ИЛИ НЕ ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботыФизЛиц
									И НЕ ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ))
						ТОГДА ДополнительныеНачисленияРаботниковОрганизации.Показатель1
					КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						ТОГДА ВЫБОР
								КОГДА ДополнительныеНачисленияРаботниковОрганизации.ДатаНачалаСобытия &lt; &amp;ДатаНачалаРасчетаСреднегоЗаработкаТолькоПоРабочимДням
									ТОГДА ДополнительныеНачисленияРаботниковОрганизации.Показатель1
								КОГДА ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботыФизЛиц
											И НЕ ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ)
										ИЛИ НЕ ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботыФизЛиц
											И НЕ ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ)
									ТОГДА ДополнительныеНачисленияРаботниковОрганизации.Показатель2
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ 0
				КОНЕЦ),
			СУММА(ВЫБОР
					КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку)
							И (ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботыФизЛиц
									И ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ)
								ИЛИ НЕ ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботыФизЛиц
									И ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ))
						ТОГДА ДополнительныеНачисленияРаботниковОрганизации.Показатель1
					КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						ТОГДА ВЫБОР
								КОГДА ДополнительныеНачисленияРаботниковОрганизации.ДатаНачалаСобытия &lt; &amp;ДатаНачалаРасчетаСреднегоЗаработкаТолькоПоРабочимДням
									ТОГДА 0
								КОГДА ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботыФизЛиц
											И ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ)
										ИЛИ НЕ ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботыФизЛиц
											И ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ)
									ТОГДА ДополнительныеНачисленияРаботниковОрганизации.Показатель2
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ 0
				КОНЕЦ)
		ИЗ
			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизации
		ГДЕ
			ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		
		СГРУППИРОВАТЬ ПО
			ДополнительныеНачисленияРаботниковОрганизации.Регистратор,
			ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
			ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
			ДополнительныеНачисленияРаботниковОрганизации.Сотрудник,
			ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета,
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
			ДополнительныеНачисленияРаботниковОрганизации.ПодразделениеОрганизации,
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ)
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			СНСведенияОДоходах.Регистратор,
			СНСведенияОДоходах.ФизЛицо,
			СНСведенияОДоходах.Организация,
			ЕСТЬNULL(РаботникиОрганизации.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)),
			СНСведенияОДоходах.ВидРасчета,
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.Период, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
			ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)),
			СУММА(СНСведенияОДоходах.СуммаДохода),
			СУММА(ВЫБОР
					КОГДА СНСведенияОДоходах.ВидРасчета.ФондВыплат.ФондЗаработнойПлаты
						ТОГДА СНСведенияОДоходах.СуммаДохода
					ИНАЧЕ 0
				КОНЕЦ),
			0,
			0,
			0,
			0,
			0
		ИЗ
			РегистрНакопления.СНСведенияОДоходах КАК СНСведенияОДоходах
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					Периоды.ПериодРегистрации КАК ПериодРегистрации,
					РаботникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
					РаботникиОрганизации.Организация КАК Организация,
					РаботникиОрганизации.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
					МАКСИМУМ(РаботникиОрганизации.Период) КАК Период
				ИЗ
					(ВЫБРАТЬ РАЗЛИЧНЫЕ
						НАЧАЛОПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации,
						КОНЕЦПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК КонецПериодаРегистрации
					ИЗ
						РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РеглПроизводственныйКалендарь
					ГДЕ
						РеглПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, -3) И КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&amp;КонецПериода, МЕСЯЦ, 3), МЕСЯЦ)) КАК Периоды
						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
						ПО (РаботникиОрганизации.Период &lt;= Периоды.КонецПериодаРегистрации)
							И (РаботникиОрганизации.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
							И (РаботникиОрганизации.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) 
				
				СГРУППИРОВАТЬ ПО
					Периоды.ПериодРегистрации,
					РаботникиОрганизации.Сотрудник.Физлицо,
					РаботникиОрганизации.Организация,
					РаботникиОрганизации.ОбособленноеПодразделение) КАК РаботникиОрганизацииСрезПоследних
				ПО СНСведенияОДоходах.ФизЛицо = РаботникиОрганизацииСрезПоследних.ФизЛицо
					И СНСведенияОДоходах.Организация = РаботникиОрганизацииСрезПоследних.ОбособленноеПодразделение
					И (НАЧАЛОПЕРИОДА(СНСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = РаботникиОрганизацииСрезПоследних.ПериодРегистрации)
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
				ПО (РаботникиОрганизацииСрезПоследних.Организация = РаботникиОрганизации.Организация)
					И (РаботникиОрганизацииСрезПоследних.ФизЛицо = РаботникиОрганизации.Сотрудник.Физлицо)
					И (РаботникиОрганизацииСрезПоследних.Период = РаботникиОрганизации.Период)
					И (РаботникиОрганизации.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
					И (РаботникиОрганизации.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) 
		ГДЕ
			СНСведенияОДоходах.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
			И СНСведенияОДоходах.Регистратор ССЫЛКА Документ.РегистрацияПрочихДоходовВЦеляхНалогообложения
		
		СГРУППИРОВАТЬ ПО
			СНСведенияОДоходах.Регистратор,
			СНСведенияОДоходах.ФизЛицо,
			СНСведенияОДоходах.Организация,
			ЕСТЬNULL(РаботникиОрганизации.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)),
			СНСведенияОДоходах.ВидРасчета,
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.Период, МЕСЯЦ),
			ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)),
			НАЧАЛОПЕРИОДА(СНСведенияОДоходах.ПериодРегистрации, МЕСЯЦ)
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			БУОсновныеНачисления.Регистратор,
			БУОсновныеНачисления.ФизЛицо,
			БУОсновныеНачисления.ОбособленноеПодразделение,
			БУОсновныеНачисления.Сотрудник,
			БУОсновныеНачисления.ВидРасчета,
			БУОсновныеНачисления.ПериодРегистрации,
			БУОсновныеНачисления.ПериодДействия,
			ВЫБОР
				КОГДА БУОсновныеНачисления.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						И БУОсновныеНачисления.ПериодДействия &gt;= БУОсновныеНачисления.ПериодРегистрации
					ТОГДА БУОсновныеНачисления.ПериодДействия
				ИНАЧЕ БУОсновныеНачисления.ПериодРегистрации
			КОНЕЦ,
			ВЫБОР
				КОГДА БУОсновныеНачисления.СубконтоДт1 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт1 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУОсновныеНачисления.СубконтоДт2 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт2 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУОсновныеНачисления.СубконтоДт3 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт3 КАК Справочник.ПодразделенияОрганизаций)
			КОНЕЦ,
			0,
			0,
			СУММА(БУОсновныеНачисления.Результат),
			0,
			0,
			0,
			0
		ИЗ
			РегистрРасчета.БУОсновныеНачисления КАК БУОсновныеНачисления
		ГДЕ
			БУОсновныеНачисления.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		
		СГРУППИРОВАТЬ ПО
			БУОсновныеНачисления.Регистратор,
			БУОсновныеНачисления.ФизЛицо,
			БУОсновныеНачисления.ОбособленноеПодразделение,
			БУОсновныеНачисления.Сотрудник,
			БУОсновныеНачисления.ВидРасчета,
			БУОсновныеНачисления.ПериодРегистрации,
			БУОсновныеНачисления.ПериодДействия,
			ВЫБОР
				КОГДА БУОсновныеНачисления.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпуска)
						И БУОсновныеНачисления.ПериодДействия &gt;= БУОсновныеНачисления.ПериодРегистрации
					ТОГДА БУОсновныеНачисления.ПериодДействия
				ИНАЧЕ БУОсновныеНачисления.ПериодРегистрации
			КОНЕЦ,
			ВЫБОР
				КОГДА БУОсновныеНачисления.СубконтоДт1 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт1 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУОсновныеНачисления.СубконтоДт2 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт2 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУОсновныеНачисления.СубконтоДт3 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУОсновныеНачисления.СубконтоДт3 КАК Справочник.ПодразделенияОрганизаций)
			КОНЕЦ
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			БУДополнительныеНачисления.Регистратор,
			БУДополнительныеНачисления.ФизЛицо,
			БУДополнительныеНачисления.ОбособленноеПодразделение,
			БУДополнительныеНачисления.Сотрудник,
			БУДополнительныеНачисления.ВидРасчета,
			БУДополнительныеНачисления.ПериодРегистрации,
			БУДополнительныеНачисления.ПериодРегистрации,
			БУДополнительныеНачисления.ПериодРегистрации,
			ВЫБОР
				КОГДА БУДополнительныеНачисления.СубконтоДт1 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт1 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУДополнительныеНачисления.СубконтоДт2 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт2 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУДополнительныеНачисления.СубконтоДт3 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт3 КАК Справочник.ПодразделенияОрганизаций)
			КОНЕЦ,
			0,
			0,
			СУММА(БУДополнительныеНачисления.Результат),
			0,
			0,
			0,
			0
		ИЗ
			РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления
		ГДЕ
			БУДополнительныеНачисления.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		
		СГРУППИРОВАТЬ ПО
			БУДополнительныеНачисления.Регистратор,
			БУДополнительныеНачисления.ФизЛицо,
			БУДополнительныеНачисления.ОбособленноеПодразделение,
			БУДополнительныеНачисления.Сотрудник,
			БУДополнительныеНачисления.ВидРасчета,
			БУДополнительныеНачисления.ПериодРегистрации,
			ВЫБОР
				КОГДА БУДополнительныеНачисления.СубконтоДт1 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт1 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУДополнительныеНачисления.СубконтоДт2 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт2 КАК Справочник.ПодразделенияОрганизаций)
				КОГДА БУДополнительныеНачисления.СубконтоДт3 ССЫЛКА Справочник.ПодразделенияОрганизаций
					ТОГДА ВЫРАЗИТЬ(БУДополнительныеНачисления.СубконтоДт3 КАК Справочник.ПодразделенияОрганизаций)
			КОНЕЦ,
			БУДополнительныеНачисления.ПериодРегистрации,
			БУДополнительныеНачисления.ПериодРегистрации) КАК Начислено
		ПО (Начислено.Сотрудник = ПлановыеНачисления.Сотрудник)
			И (Начислено.ОбособленноеПодразделение = ПлановыеНачисления.ОбособленноеПодразделение)
			И (Начислено.ВидРасчета = ПлановыеНачисления.ВидРасчета)
			И (Начислено.ПериодРегистрации = ПлановыеНачисления.ПериодРегистрации)
			И (Начислено.ПериодДействия = ПлановыеНачисления.ПериодДействия)
			И (Начислено.ПериодВключенияВФондЗаработнойПлаты = ПлановыеНачисления.ПериодВключенияВФондЗаработнойПлаты)
			И (Начислено.ПодразделениеОрганизации = ПлановыеНачисления.ПодразделениеОрганизации)
		{ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ДатыПоследнихНазначений.ПериодРегистрации КАК ПериодРегистрации,
			РаботникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
			РаботникиОрганизации.Сотрудник КАК Сотрудник,
			РаботникиОрганизации.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			РаботникиОрганизации.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
			РаботникиОрганизации.Должность КАК Должность,
			РаботникиОрганизации.ТарифныйРазряд КАК ТарифныйРазряд,
			РаботникиОрганизации.Сотрудник.ВидЗанятости КАК ВидЗанятости,
			ПриказыПоОсновномуМестуРаботы.ПодразделениеОрганизации КАК ПодразделениеОрганизацииПоОсновномуМестуРаботы,
			ПриказыПоОсновномуМестуРаботы.Должность КАК ДолжностьПоОсновномуМестуРаботы,
			ЛОЖЬ КАК РаботаетПоДоговоруГПХ
		ИЗ
			(ВЫБРАТЬ
				Периоды.ПериодРегистрации КАК ПериодРегистрации,
				РаботникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
				РаботникиОрганизации.Сотрудник КАК Сотрудник,
				РаботникиОрганизации.Организация КАК Организация,
				РаботникиОрганизации.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
				МАКСИМУМ(РаботникиОрганизации.Период) КАК Период,
				МАКСИМУМ(ПриказыПоОсновномуМестуРаботы.Период) КАК ПериодПоОсновномуМестуРаботы
			ИЗ
				(ВЫБРАТЬ РАЗЛИЧНЫЕ
					НАЧАЛОПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации,
					КОНЕЦПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК КонецПериодаРегистрации
				ИЗ
					РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РеглПроизводственныйКалендарь
				ГДЕ
					РеглПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, -3) И КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&amp;КонецПериода, МЕСЯЦ, 3), МЕСЯЦ)) КАК Периоды
					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
					ПО (РаботникиОрганизации.Период &lt;= Периоды.КонецПериодаРегистрации)
						И (РаботникиОрганизации.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) 
					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПриказыПоОсновномуМестуРаботы
					ПО (ПриказыПоОсновномуМестуРаботы.Период &lt;= Периоды.КонецПериодаРегистрации)
						И (ПриказыПоОсновномуМестуРаботы.Период &lt;= РаботникиОрганизации.Период)
						И (РаботникиОрганизации.Сотрудник = ПриказыПоОсновномуМестуРаботы.Сотрудник)
						И (РаботникиОрганизации.Организация = ПриказыПоОсновномуМестуРаботы.Организация)
						И (ПриказыПоОсновномуМестуРаботы.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
						И (ПриказыПоОсновномуМестуРаботы.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение))
			
			СГРУППИРОВАТЬ ПО
				Периоды.ПериодРегистрации,
				РаботникиОрганизации.Сотрудник.Физлицо,
				РаботникиОрганизации.Сотрудник,
				РаботникиОрганизации.Организация,
				РаботникиОрганизации.ОбособленноеПодразделение) КАК ДатыПоследнихНазначений
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
				ПО ДатыПоследнихНазначений.Сотрудник = РаботникиОрганизации.Сотрудник
					И ДатыПоследнихНазначений.Организация = РаботникиОрганизации.Организация
					И (ДатыПоследнихНазначений.Период = РаботникиОрганизации.Период)
					И (РаботникиОрганизации.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) 
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПриказыПоОсновномуМестуРаботы
				ПО ДатыПоследнихНазначений.ФизЛицо = ПриказыПоОсновномуМестуРаботы.Сотрудник.Физлицо
					И ДатыПоследнихНазначений.Организация = ПриказыПоОсновномуМестуРаботы.Организация
					И (ДатыПоследнихНазначений.ПериодПоОсновномуМестуРаботы = ПриказыПоОсновномуМестуРаботы.Период)
					И (ПриказыПоОсновномуМестуРаботы.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
					И (ПриказыПоОсновномуМестуРаботы.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение))
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			АктуальныеДоговоры.ПериодРегистрации,
			ДоговорникиОрганизации.Сотрудник.Физлицо,
			ДоговорникиОрганизации.Сотрудник,
			ДоговорникиОрганизации.ПодразделениеОрганизации,
			ДоговорникиОрганизации.ОбособленноеПодразделение,
			ДоговорникиОрганизации.Должность,
			ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка),
			"По договору ГПХ",
			ЕСТЬNULL(ПриказыПоОсновномуМестуРаботы.ПодразделениеОрганизации, ДоговорникиОрганизации.ПодразделениеОрганизации),
			ЕСТЬNULL(ПриказыПоОсновномуМестуРаботы.Должность, ДоговорникиОрганизации.Должность),
			ИСТИНА
		ИЗ
			(ВЫБРАТЬ
				ПоследниеДатыДоговоров.ПериодРегистрации КАК ПериодРегистрации,
				ДоговорникиОрганизации.Организация КАК Организация,
				ДоговорникиОрганизации.Сотрудник КАК Сотрудник,
				МАКСИМУМ(ДоговорникиОрганизации.Договор) КАК Договор
			ИЗ
				(ВЫБРАТЬ
					Периоды.ПериодРегистрации КАК ПериодРегистрации,
					ДоговорникиОрганизации.Сотрудник КАК Сотрудник,
					ДоговорникиОрганизации.Организация КАК Организация,
					МАКСИМУМ(ДоговорникиОрганизации.ДатаНачала) КАК ДатаНачала
				ИЗ
					(ВЫБРАТЬ РАЗЛИЧНЫЕ
						НАЧАЛОПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации,
						КОНЕЦПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК КонецПериодаРегистрации
					ИЗ
						РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РеглПроизводственныйКалендарь
					ГДЕ
						РеглПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, -3) И КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&amp;КонецПериода, МЕСЯЦ, 3), МЕСЯЦ)) КАК Периоды
						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ДоговорникиОрганизаций КАК ДоговорникиОрганизации
						ПО (ДоговорникиОрганизации.ДатаНачала &lt;= Периоды.КонецПериодаРегистрации)
				
				СГРУППИРОВАТЬ ПО
					Периоды.ПериодРегистрации,
					ДоговорникиОрганизации.Сотрудник,
					ДоговорникиОрганизации.Организация) КАК ПоследниеДатыДоговоров
					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ДоговорникиОрганизаций КАК ДоговорникиОрганизации
					ПО ПоследниеДатыДоговоров.Организация = ДоговорникиОрганизации.Организация
						И ПоследниеДатыДоговоров.Сотрудник = ДоговорникиОрганизации.Сотрудник
						И ПоследниеДатыДоговоров.ДатаНачала = ДоговорникиОрганизации.ДатаНачала
			
			СГРУППИРОВАТЬ ПО
				ПоследниеДатыДоговоров.ПериодРегистрации,
				ДоговорникиОрганизации.Организация,
				ДоговорникиОрганизации.Сотрудник) КАК АктуальныеДоговоры
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ДоговорникиОрганизаций КАК ДоговорникиОрганизации
				ПО АктуальныеДоговоры.Организация = ДоговорникиОрганизации.Организация
					И АктуальныеДоговоры.Сотрудник = ДоговорникиОрганизации.Сотрудник
					И АктуальныеДоговоры.Договор = ДоговорникиОрганизации.Договор
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					Периоды.ПериодРегистрации КАК ПериодРегистрации,
					ПриказыПоОсновномуМестуРаботы.Сотрудник.Физлицо КАК ФизЛицо,
					ПриказыПоОсновномуМестуРаботы.Организация КАК Организация,
					МАКСИМУМ(ПриказыПоОсновномуМестуРаботы.Период) КАК Период
				ИЗ
					(ВЫБРАТЬ РАЗЛИЧНЫЕ
						НАЧАЛОПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации,
						КОНЕЦПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК КонецПериодаРегистрации
					ИЗ
						РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РеглПроизводственныйКалендарь
					ГДЕ
						РеглПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, -3) И КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&amp;КонецПериода, МЕСЯЦ, 3), МЕСЯЦ)) КАК Периоды
						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПриказыПоОсновномуМестуРаботы
						ПО (ПриказыПоОсновномуМестуРаботы.Период &lt;= Периоды.КонецПериодаРегистрации)
							И (ПриказыПоОсновномуМестуРаботы.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
							И (ПриказыПоОсновномуМестуРаботы.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение))
				
				СГРУППИРОВАТЬ ПО
					Периоды.ПериодРегистрации,
					ПриказыПоОсновномуМестуРаботы.Сотрудник.Физлицо,
					ПриказыПоОсновномуМестуРаботы.Организация) КАК ДатыПоследнихПриказовПоОсновномуМестуРаботы
				ПО (ДатыПоследнихПриказовПоОсновномуМестуРаботы.ПериодРегистрации = АктуальныеДоговоры.ПериодРегистрации)
					И АктуальныеДоговоры.Сотрудник.Физлицо = ДатыПоследнихПриказовПоОсновномуМестуРаботы.ФизЛицо
					И (ВЫБОР
						КОГДА АктуальныеДоговоры.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
							ТОГДА АктуальныеДоговоры.Организация
						ИНАЧЕ АктуальныеДоговоры.Организация.ГоловнаяОрганизация
					КОНЕЦ = ДатыПоследнихПриказовПоОсновномуМестуРаботы.Организация)
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПриказыПоОсновномуМестуРаботы
				ПО (ДатыПоследнихПриказовПоОсновномуМестуРаботы.ФизЛицо = ПриказыПоОсновномуМестуРаботы.Сотрудник.Физлицо)
					И (ДатыПоследнихПриказовПоОсновномуМестуРаботы.Организация = ПриказыПоОсновномуМестуРаботы.Организация)
					И (ДатыПоследнихПриказовПоОсновномуМестуРаботы.Период = ПриказыПоОсновномуМестуРаботы.Период)
					И (ПриказыПоОсновномуМестуРаботы.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
					И (ПриказыПоОсновномуМестуРаботы.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение))) КАК ДанныеОНазначениях
		ПО ПлановыеНачисления.ОбособленноеПодразделение = ДанныеОНазначениях.ОбособленноеПодразделение
			И ПлановыеНачисления.Сотрудник = ДанныеОНазначениях.Сотрудник
			И ПлановыеНачисления.ПериодРегистрации = ДанныеОНазначениях.ПериодРегистрации
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			КодыСтрокДекларацииПоСН.ВидРасчета КАК ВидРасчета,
			Периоды.ПериодРегистрации КАК ПериодРегистрации,
			МАКСИМУМ(КодыСтрокДекларацииПоСН.Период) КАК Период
		ИЗ
			РегистрСведений.КодыСтрокДекларацииПоСН КАК КодыСтрокДекларацииПоСН
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
					НАЧАЛОПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации,
					КОНЕЦПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК КонецПериодаРегистрации
				ИЗ
					РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РеглПроизводственныйКалендарь
				ГДЕ
					РеглПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, -3) И КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&amp;КонецПериода, МЕСЯЦ, 3), МЕСЯЦ)) КАК Периоды
				ПО КодыСтрокДекларацииПоСН.Период &lt;= Периоды.КонецПериодаРегистрации
		
		СГРУППИРОВАТЬ ПО
			КодыСтрокДекларацииПоСН.ВидРасчета,
			Периоды.ПериодРегистрации) КАК ПоследниеПериодыКодовСтрокДекларацииПоСН
		ПО ПлановыеНачисления.ВидРасчета = ПоследниеПериодыКодовСтрокДекларацииПоСН.ВидРасчета
			И ПлановыеНачисления.ПериодРегистрации = ПоследниеПериодыКодовСтрокДекларацииПоСН.ПериодРегистрации
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КодыСтрокДекларацииПоСН КАК КодыСтрокДекларацииПоСН
		ПО (ПоследниеПериодыКодовСтрокДекларацииПоСН.ВидРасчета = КодыСтрокДекларацииПоСН.ВидРасчета)
			И (ПоследниеПериодыКодовСтрокДекларацииПоСН.Период = КодыСтрокДекларацииПоСН.Период)}
{ГДЕ
	ПлановыеНачисления.ФизЛицо.* КАК ФизЛицо,
	ПлановыеНачисления.ВидРасчета.* КАК ВидРасчета,
	ПлановыеНачисления.ОбособленноеПодразделение.* КАК Организация,
	ПлановыеНачисления.ПериодРегистрации,
	ПлановыеНачисления.ПериодДействия,
	ПлановыеНачисления.ПериодВключенияВФондЗаработнойПлаты,
	ДанныеОНазначениях.ПодразделениеОрганизации.* КАК ПодразделениеОрганизации,
	ДанныеОНазначениях.Должность.* КАК Должность,
	ДанныеОНазначениях.ТарифныйРазряд.* КАК ТарифныйРазряд,
	ДанныеОНазначениях.ВидЗанятости КАК ВидЗанятости,
	ДанныеОНазначениях.ПодразделениеОрганизацииПоОсновномуМестуРаботы.* КАК ПодразделениеОрганизацииПоОсновномуМестуРаботы,
	ДанныеОНазначениях.ДолжностьПоОсновномуМестуРаботы.* КАК ДолжностьПоОсновномуМестуРаботы,
	ДанныеОНазначениях.РаботаетПоДоговоруГПХ КАК РаботаетПоДоговоруГПХ,
	ПлановыеНачисления.ПодразделениеОрганизации.* КАК ПодразделениеДляОтнесенияЗатрат,
	КодыСтрокДекларацииПоСН.КодСтроки,
	ПлановыеНачисления.Сотрудник.*}</query>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>ФИОРаботников</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодРегистрации</dataPath>
			<field>ПериодРегистрации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период регистрации</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФизЛицо</dataPath>
			<field>ФизЛицо</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Физическое лицо</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<attributeUseRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФИО</dataPath>
			<field>ФИО</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>ФИО</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
ПОМЕСТИТЬ Периоды
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ФИОФизЛиц.ФизЛицо КАК ФизЛицо,
	ДатыПоследнихДвижений.ПериодРегистрации КАК ПериодРегистрации,
	ФИОФизЛиц.Фамилия + " " + ФИОФизЛиц.Имя + " " + ФИОФизЛиц.Отчество КАК ФИО
{ВЫБРАТЬ
	ФИО,
	ФизЛицо.*,
	ПериодРегистрации}
ИЗ
	(ВЫБРАТЬ
		Периоды.ПериодРегистрации КАК ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо КАК ФизЛицо,
		МАКСИМУМ(ФИОФизЛиц.Период) КАК Период
	ИЗ
		Периоды КАК Периоды
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц КАК ФИОФизЛиц
			ПО (КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ) &gt;= ФИОФизЛиц.Период
					ИЛИ &amp;ЕстьГруппировкаПоПериодуРегистрации
						И &amp;КонецПериода &gt;= ФИОФизЛиц.Период)
	{ГДЕ
		Периоды.ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо.*}
	
	СГРУППИРОВАТЬ ПО
		Периоды.ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо) КАК ДатыПоследнихДвижений
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц КАК ФИОФизЛиц
		ПО ДатыПоследнихДвижений.ФизЛицо = ФИОФизЛиц.ФизЛицо
			И ДатыПоследнихДвижений.Период = ФИОФизЛиц.Период
{ГДЕ
	ФИОФизЛиц.ФизЛицо.*,
	ДатыПоследнихДвижений.ПериодРегистрации,
	(ФИОФизЛиц.Фамилия + " " + ФИОФизЛиц.Имя + " " + ФИОФизЛиц.Отчество) КАК ФИО}</query>
	</dataSet>
	<dataSetLink>
		<sourceDataSet>Данные</sourceDataSet>
		<destinationDataSet>ФИОРаботников</destinationDataSet>
		<sourceExpression>Сотрудник.ФизЛицо</sourceExpression>
		<destinationExpression>ФизЛицо</destinationExpression>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Данные</sourceDataSet>
		<destinationDataSet>ФИОРаботников</destinationDataSet>
		<sourceExpression>ПериодРегистрации</sourceExpression>
		<destinationExpression>ПериодРегистрации</destinationExpression>
	</dataSetLink>
	<calculatedField>
		<dataPath>ФИО</dataPath>
		<expression>ВЫБОР КОГДА ФИО ЕСТЬ NULL ТОГДА Сотрудник ИНАЧЕ ФИО КОНЕЦ </expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>ФИО</v8:content>
			</v8:item>
		</title>
	</calculatedField>
	<totalField>
		<dataPath>ОтработаноДней</dataPath>
		<expression>Сумма(ОтработаноДней)</expression>
	</totalField>
	<totalField>
		<dataPath>ОтработаноЧасов</dataPath>
		<expression>Сумма(ОтработаноЧасов)</expression>
	</totalField>
	<totalField>
		<dataPath>УчитываемыеДни</dataPath>
		<expression>Сумма(УчитываемыеДни)</expression>
	</totalField>
	<totalField>
		<dataPath>УчитываемыеЧасы</dataPath>
		<expression>Сумма(УчитываемыеЧасы)</expression>
	</totalField>
	<totalField>
		<dataPath>Начислено</dataPath>
		<expression>Сумма(Начислено)</expression>
	</totalField>
	<totalField>
		<dataPath>ФондЗаработнойПлаты</dataPath>
		<expression>Сумма(ФондЗаработнойПлаты)</expression>
	</totalField>
	<totalField>
		<dataPath>УчтеноПриФормированииПроводок</dataPath>
		<expression>Сумма(УчтеноПриФормированииПроводок)</expression>
	</totalField>
	<parameter>
		<name>ДатаНачалаРасчетаСреднегоЗаработкаТолькоПоРабочимДням</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Дата начала расчета среднего заработка только по рабочим дням</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>ЕстьГруппировкаПоПериодуРегистрации</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Есть группировка по периоду регистрации</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Начислено</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОтработаноДней</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОтработаноЧасов</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>УчитываемыеДни</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>УчитываемыеЧасы</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ФондЗаработнойПлаты</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>КонецПериода</dcscor:parameter>
					<dcscor:value xsi:type="xs:dateTime">0001-01-01T00:00:00</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>НачалоПериода</dcscor:parameter>
					<dcscor:value xsi:type="xs:dateTime">0001-01-01T00:00:00</dcscor:value>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:order>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>Сотрудник</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
			</dcsset:order>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьЗаголовок</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Заголовок</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Анализ начислений работникам организаций</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьПараметрыДанных</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьОтбор</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
			<dcsset:item xsi:type="dcsset:StructureItemGroup">
				<dcsset:groupItems>
					<dcsset:item xsi:type="dcsset:GroupItemField">
						<dcsset:field>Организация</dcsset:field>
						<dcsset:groupType>Items</dcsset:groupType>
						<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
						<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
						<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
					</dcsset:item>
				</dcsset:groupItems>
				<dcsset:order>
					<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
				</dcsset:order>
				<dcsset:selection>
					<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
				</dcsset:selection>
				<dcsset:item xsi:type="dcsset:StructureItemGroup">
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>ПодразделениеОрганизации</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
					</dcsset:selection>
				</dcsset:item>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>