Перем мСписокИсточниковФинансирования Экспорт;
Перем мСписокСтруктурныхЕдиниц Экспорт;
Перем мСписокПодразделений Экспорт;
Перем мДеревоСтруктурныхЕдиниц Экспорт;
Перем СохраненнаяНастройка Экспорт;
Перем Расшифровки Экспорт;
Перем ПромежуточныеДанные Экспорт;
Перем РежимРасшифровки Экспорт;
Перем ВедётсяУчетПоПодразделениям Экспорт;

#Если Клиент Тогда

Процедура ЗаполнитьНачальныеНастройки() Экспорт
	
	СтандартныеОтчеты.ЗаполнитьДанныеОтчета(ЭтотОбъект);
	
КонецПроцедуры

Процедура СформироватьОтчет(Результат = Неопределено, ДанныеРасшифровки = Неопределено, ВыводВФормуОтчета = Истина, ВнешниеНаборыДанных = Неопределено) Экспорт
	
	//Результат.Очистить();
	
	Настройки = КомпоновщикНастроек.ПолучитьНастройки();
	//ВыводЗаголовкаОтчета(ЭтотОбъект, Результат);
	ДоработатьКомпоновщикПередВыводом(ВнешниеНаборыДанных);
	СтандартныеОтчеты.ВывестиОтчет(ЭтотОбъект, Результат, ДанныеРасшифровки, ВыводВФормуОтчета, ВнешниеНаборыДанных);
	КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);
	
	// Выполним дополнительную обработку Результата отчета
	ОбработкаРезультатаОтчета(Результат);
	
	УправлениеОтчетами.УстановитьКолонтитулыПоУмолчанию(Результат, ПолучитьТекстЗаголовка(), Строка(глТекущийПользователь));
	
	Возврат;
	
КонецПроцедуры

// В процедуре можно доработать компоновщик перед выводом в отчет
// Изменения сохранены не будут
Процедура ДоработатьКомпоновщикПередВыводом(ВнешниеНаборыДанных) Экспорт
	
	Если ЗначениеЗаполнено(НачалоПериода) Тогда
		ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "НачалоПериода", НачалоДня(НачалоПериода));
	Иначе
		ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "НачалоПериода", Дата(1, 1, 1));
	КонецЕсли;
	Если ЗначениеЗаполнено(КонецПериода) Тогда
		ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "КонецПериода", КонецДня(КонецПериода));
	Иначе
		ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "КонецПериода", Дата(3999, 11, 1));
	КонецЕсли;
	
	ВнешниеНаборыДанных = Новый Структура;
	ВыборкаДанных = ПолучитьВыборку();
	ВнешниеНаборыДанных.Вставить("ТаблицаДанных", ВыборкаДанных);
	
	Поле = СхемаКомпоновкиДанных.НаборыДанных[0].Поля.Найти("СуммаИтого");
	Если Поле <> Неопределено Тогда
		Поле.Заголовок = "Итого "+Формат(Год(НачалоПериода), "ЧГ=0")+" год";
	КонецЕсли;
	
	//Поле = СхемаКомпоновкиДанных.НаборыДанных[0].Поля.Найти("СуммаПредыдущийПлан");
	//Если Поле <> Неопределено Тогда
	//	Поле.Заголовок = "План "+Формат(Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))), "ЧГ=0")+" года";
	//КонецЕсли;
	
	
	Поле = СхемаКомпоновкиДанных.НаборыДанных[0].Поля.Найти("СуммаПредыдущийПлан");
		Если Поле <> Неопределено Тогда
			Поле.Заголовок = "План " + Формат(Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))),"ЧГ=0")+" года";
			
			Если Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))) = 2019 Тогда

				Поле.Заголовок = "План " + Формат(Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))),"ЧГ=0") + " года (корректировка, оценка)";
				
			КонецЕсли;
			
		КонецЕсли;

	//Поле = СхемаКомпоновкиДанных.НаборыДанных[0].Поля.Найти("СуммаПредыдущийФакт");
	//Если Поле <> Неопределено Тогда
	//	Поле.Заголовок = "Оценка "+Формат(Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))), "ЧГ=0")+" года";
	//КонецЕсли;
	
	
	Поле = СхемаКомпоновкиДанных.НаборыДанных[0].Поля.Найти("СуммаПредыдущийФакт");
	Если Поле <> Неопределено Тогда
		Если Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))) = 2016 Тогда
			Поле.Заголовок = "Факт " + Формат(Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))),"ЧГ=0")+" года";
		ИначеЕсли Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))) = 2017 Тогда
			Поле.Заголовок = "Факт " + Формат(Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))),"ЧГ=0")+" года";
	    ИначеЕсли Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))) = 2018 Тогда
			Поле.Заголовок = "Факт " + Формат(Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))),"ЧГ=0")+" года";

		Иначе
			Поле.Заголовок = "Факт " + Формат(Год(НачалоДня(Дата(Год(НачалоПериода)-1,1,1))),"ЧГ=0")+" года";
		КонецЕсли;
		
	КонецЕсли;

	
	Поле = СхемаКомпоновкиДанных.НаборыДанных[0].Поля.Найти("СуммаПредществующий");
	Если Поле <> Неопределено Тогда
		Поле.Заголовок = "Факт "+Формат(Год( НачалоДня(Дата(Год(НачалоПериода)-2,1,1))), "ЧГ=0")+" года";
	КонецЕсли;
	
	Поле = СхемаКомпоновкиДанных.НаборыДанных[0].Поля.Найти("СуммаТриГодаНазад");
	Если Поле <> Неопределено Тогда
		Поле.Заголовок = "Факт "+Формат(Год( НачалоДня(Дата(Год(НачалоПериода)-3,1,1))), "ЧГ=0")+" года";
	КонецЕсли;
	
	Поле = СхемаКомпоновкиДанных.ВычисляемыеПоля.Найти("ПроцентОтклонение2");
	Если Поле <> Неопределено Тогда
		Поле.Заголовок = "% к "+Формат(Год( НачалоДня(Дата(Год(НачалоПериода)-2,1,1))), "ЧГ=0")+" года";
	КонецЕсли;

	Поле = СхемаКомпоновкиДанных.ВычисляемыеПоля.Найти("ПроцентОтклонение3");
	Если Поле <> Неопределено Тогда
		Поле.Заголовок = "План "+Формат(Год(НачалоПериода), "ЧГ=0")+" года к факту "+Формат(Год( НачалоДня(Дата(Год(НачалоПериода)-1,1,1))), "ЧГ=0")+" года, %";
	КонецЕсли;

	Поле = СхемаКомпоновкиДанных.ВычисляемыеПоля.Найти("ПланКФактуПредшествующий");
	Если Поле <> Неопределено Тогда
		Поле.Заголовок = "План "+Формат(Год(НачалоПериода), "ЧГ=0")+" года к факту "+Формат(Год( НачалоДня(Дата(Год(НачалоПериода)-2,1,1))), "ЧГ=0")+" года, %";
	КонецЕсли;

	Поле = СхемаКомпоновкиДанных.ВычисляемыеПоля.Найти("ПланКФактуТриГода");
	Если Поле <> Неопределено Тогда
		Поле.Заголовок = "План "+Формат(Год(НачалоПериода), "ЧГ=0")+" года к факту "+Формат(Год( НачалоДня(Дата(Год(НачалоПериода)-3,1,1))), "ЧГ=0")+" года, %";
	КонецЕсли;

	 
	//Предыдущий период
	
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "НачалоПредыдущегоПериода", НачалоДня(Дата(Год(НачалоПериода)-1,1,1)));
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "КонецПредыдущегоПериода", КонецДня(Дата(Год(НачалоПериода)-1,12,31)));

	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "НачалоПредществующегоПериода", НачалоДня(Дата(Год(НачалоПериода)-2,1,1)));
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "КонецПредществующегоПериода", КонецДня(Дата(Год(НачалоПериода)-2,12,31)));

	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "НачалоПериодаТриГода", НачалоДня(Дата(Год(НачалоПериода)-3,1,1)));
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "КонецПериодаТриГода", КонецДня(Дата(Год(НачалоПериода)-3,12,31)));
		

	Если мДеревоСтруктурныхЕдиниц.Колонки.Количество() = 0 Тогда 
		
		СписокСтруктурныхЕдиниц = Новый СписокЗначений;
		СписокСтруктурныхЕдиниц.ЗагрузитьЗначения(мСписокСтруктурныхЕдиниц.ВыгрузитьЗначения());
		
		Для Каждого СтрПодразделение Из мСписокПодразделений Цикл 
			СписокСтруктурныхЕдиниц.Добавить(СтрПодразделение.Значение);
		КонецЦикла;		
				
		мДеревоСтруктурныхЕдиниц = СтандартныеОтчеты.СформироватьДеревоСЕ(, СписокСтруктурныхЕдиниц);
		
	КонецЕсли;
	
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "ФормируемыйБюджет", ФормируемыйБюджет);
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "ЕдиницаИзмерения", ЕдиницаИзмерения);
	
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "ОкруглятьДоЦелых", ОкруглятьДоЦелых);
	
	ТиповыеОтчеты.ДобавитьОтборПоОрганизациямИПодразделениям(КомпоновщикНастроек, мДеревоСтруктурныхЕдиниц);
	
КонецПроцедуры

Процедура ИнициализацияОтчета() Экспорт
	
	СтандартныеОтчеты.ИнициализацияОтчета(ЭтотОбъект);
	
КонецПроцедуры

Процедура ВыводПодписиОтчета(Результат)
	
	//Макет = ПолучитьОбщийМакет("ОбщиеОбластиСтандартногоОтчета");
	//ОбластьПодписи        = Макет.ПолучитьОбласть("ПодписиПроверил");
	//Результат.Вывести(ОбластьПодписи);
	
КонецПроцедуры

Процедура ВыводЗаголовкаОтчета(ОтчетОбъект, Результат)
	
	СтандартныеОтчеты.ВыводЗаголовкаСпециализированногоОтчета(ОтчетОбъект, Результат);
			
КонецПроцедуры

Функция ПолучитьТекстЗаголовка(ОрганизацияВНачале = Истина) Экспорт 
		
	ЗаголовокОтчета = "Прогноз движения денег" + СтандартныеОтчеты.ПолучитьПредставлениеПериода(ЭтотОбъект);

	Возврат ?(ОрганизацияВНачале, ЗаголовокОтчета, ЗаголовокОтчета + " " + СтандартныеОтчеты.ПолучитьТекстОрганизация(ЭтотОбъект));
		
КонецФункции

Функция ПолучитьВыборку ()
	
	Запрос = Новый Запрос;
         
	Запрос.Текст =
	"ВЫБРАТЬ
	|	фин_СтатьиБюджета.Ссылка КАК СтатьяБюджета,
	|	""414.2"" КАК КодСтрокиБюджета
	|ПОМЕСТИТЬ ВТ_Костыль420
	|ИЗ
	|	Справочник.фин_СтатьиБюджета КАК фин_СтатьиБюджета
	|ГДЕ
	|	фин_СтатьиБюджета.Владелец = &ФормируемыйБюджет
	|	И (фин_СтатьиБюджета.КодСтрокиБюджета = ""420""
	|			ИЛИ фин_СтатьиБюджета.КодСтрокиБюджета = ""500""
	|			ИЛИ фин_СтатьиБюджета.КодСтрокиБюджета = ""VI"")
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	БюджетОбороты.Организация КАК Организация,
	|	БюджетОбороты.СтатьяБюджета КАК СтатьяБюджета,
	|	БюджетОбороты.Статус,
	|	БюджетОбороты.Регистратор КАК ДокументДвижения,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 1
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаЯнварь,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 2
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаФевраль,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 3
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаМарт,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 4
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаАпрель,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 5
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаМай,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаИюнь,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 7
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаИюль,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 8
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаАвгуст,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаСентябрь,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 10
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаОктябрь,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 11
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНоябрь,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 3
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПервыйКвартал,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
	|				ИЛИ БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета = ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаДекабрь,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаВторойКвартал,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаТретийКвартал,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
	|				ИЛИ БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета = ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаЧетвертыйКвартал,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаЗаПолугодие,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
	|				И БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета <> ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаЗаДевятьМесяцев,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
	|				ИЛИ БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета = ""414.2""
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаИтого,
	|	0 КАК СуммаИтогоФакт,
	|	0 КАК СуммаПредыдущийПлан,
	|	0 КАК СуммаПредыдущийФакт,
	|	0 КАК СуммаПредществующий,
	|	0 КАК ПризнакКоличество,
	|	"""" КАК Категория,
	|	"""" КАК Класс,
	|	0 КАК СуммаТриГодаНазад
	|ПОМЕСТИТЬ ВТ
	|ИЗ
	|	РегистрНакопления.б_Бюджет.Обороты(&Началопериода, &КонецПериода, Регистратор, Бюджет = &ФормируемыйБюджет) КАК БюджетОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	БюджетОборотыФакт.Организация,
	|	БюджетОборотыФакт.СтатьяБюджета,
	|	БюджетОборотыФакт.Статус,
	|	БюджетОборотыФакт.Регистратор,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|			ТОГДА ЕСТЬNULL(БюджетОборотыФакт.СуммаОборот, 0) / 1000000
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|					ТОГДА ЕСТЬNULL(БюджетОборотыФакт.СуммаОборот, 0) / 1000
	|				ИНАЧЕ ЕСТЬNULL(БюджетОборотыФакт.СуммаОборот, 0)
	|			КОНЕЦ
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	БюджетОборотыФакт.ПризнакКоличествоОборот,
	|	"""",
	|	"""",
	|	0
	|ИЗ
	|	РегистрНакопления.б_БюджетФакт.Обороты(&Началопериода, &КонецПериода, Регистратор, Бюджет = &ФормируемыйБюджет) КАК БюджетОборотыФакт
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	БюджетФактОбороты.Организация,
	|	БюджетФактОбороты.СтатьяБюджета,
	|	БюджетФактОбороты.Статус,
	|	БюджетФактОбороты.Регистратор,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|			ТОГДА ЕСТЬNULL(БюджетФактОбороты.СуммаОборот, 0) / 1000000
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|					ТОГДА ЕСТЬNULL(БюджетФактОбороты.СуммаОборот, 0) / 1000
	|				ИНАЧЕ ЕСТЬNULL(БюджетФактОбороты.СуммаОборот, 0)
	|			КОНЕЦ
	|	КОНЕЦ,
	|	0,
	|	БюджетФактОбороты.ПризнакКоличествоОборот,
	|	"""",
	|	"""",
	|	0
	|ИЗ
	|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПредыдущегопериода, &КонецПредыдущегоПериода, Регистратор, Бюджет = &ФормируемыйБюджет) КАК БюджетФактОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	БюджетФактОбороты_Доп.Организация,
	|	БюджетФактОбороты_Доп.СтатьяБюджета,
	|	БюджетФактОбороты_Доп.Статус,
	|	БюджетФактОбороты_Доп.Регистратор,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|			ТОГДА ЕСТЬNULL(БюджетФактОбороты_Доп.СуммаОборот, 0) / 1000000
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|					ТОГДА ЕСТЬNULL(БюджетФактОбороты_Доп.СуммаОборот, 0) / 1000
	|				ИНАЧЕ ЕСТЬNULL(БюджетФактОбороты_Доп.СуммаОборот, 0)
	|			КОНЕЦ
	|	КОНЕЦ,
	|	БюджетФактОбороты_Доп.ПризнакКоличествоОборот,
	|	"""",
	|	"""",
	|	0
	|ИЗ
	|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПредществующегоПериода, &КонецПредществующегоПериода, Регистратор, Бюджет = &ФормируемыйБюджет) КАК БюджетФактОбороты_Доп
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	БюджетФактОбороты_Доп.Организация,
	|	БюджетФактОбороты_Доп.СтатьяБюджета,
	|	БюджетФактОбороты_Доп.Статус,
	|	БюджетФактОбороты_Доп.Регистратор,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	БюджетФактОбороты_Доп.ПризнакКоличествоОборот,
	|	"""",
	|	"""",
	|	ВЫБОР
	|		КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|			ТОГДА ЕСТЬNULL(БюджетФактОбороты_Доп.СуммаОборот, 0) / 1000000
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|					ТОГДА ЕСТЬNULL(БюджетФактОбороты_Доп.СуммаОборот, 0) / 1000
	|				ИНАЧЕ ЕСТЬNULL(БюджетФактОбороты_Доп.СуммаОборот, 0)
	|			КОНЕЦ
	|	КОНЕЦ
	|ИЗ
	|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаТриГода, &КонецПериодаТриГода, Регистратор, Бюджет = &ФормируемыйБюджет) КАК БюджетФактОбороты_Доп
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	БюджетОбороты.Организация,
	|	БюджетОбороты.СтатьяБюджета,
	|	БюджетОбороты.Статус,
	|	БюджетОбороты.Регистратор,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	"""",
	|	"""",
	|	0
	|ИЗ
	|	РегистрНакопления.б_Бюджет.Обороты(&НачалоПредыдущегопериода, &КонецПредыдущегоПериода, Регистратор, Бюджет = &ФормируемыйБюджет) КАК БюджетОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	БюджетОбороты.Организация,
	|	ВТ_Костыль420.СтатьяБюджета,
	|	БюджетОбороты.Статус,
	|	БюджетОбороты.Регистратор,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 1
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 2
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 3
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 4
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 5
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 7
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 8
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 10
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 11
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 3
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 12
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 12
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(-БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 12
	|			ТОГДА ВЫБОР
	|					КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000000)
	|						ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000000
	|					ИНАЧЕ ВЫБОР
	|							КОГДА &ЕдиницаИзмерения = ЗНАЧЕНИЕ(Перечисление.ПорядкиОкругленияОтчетности.ОКР1000)
	|								ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0) / 1000
	|							ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
	|						КОНЕЦ
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	"""",
	|	"""",
	|	0
	|ИЗ
	|	ВТ_Костыль420 КАК ВТ_Костыль420
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.б_Бюджет.Обороты(
	|				&Началопериода,
	|				&КонецПериода,
	|				Регистратор,
	|				Бюджет = &ФормируемыйБюджет
	|					И СтатьяБюджета.КодСтрокиБюджета = ""414.2"") КАК БюджетОбороты
	|		ПО ВТ_Костыль420.КодСтрокиБюджета = БюджетОбороты.СтатьяБюджета.КодСтрокиБюджета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ.Организация,
	|	ВТ.СтатьяБюджета,
	|	ВТ.Статус,
	|	ВТ.ДокументДвижения,
	|	СУММА(ВТ.СуммаЯнварь) КАК СуммаЯнварь,
	|	СУММА(ВТ.СуммаФевраль) КАК СуммаФевраль,
	|	СУММА(ВТ.СуммаМарт) КАК СуммаМарт,
	|	СУММА(ВТ.СуммаАпрель) КАК СуммаАпрель,
	|	СУММА(ВТ.СуммаМай) КАК СуммаМай,
	|	СУММА(ВТ.СуммаИюнь) КАК СуммаИюнь,
	|	СУММА(ВТ.СуммаИюль) КАК СуммаИюль,
	|	СУММА(ВТ.СуммаАвгуст) КАК СуммаАвгуст,
	|	СУММА(ВТ.СуммаСентябрь) КАК СуммаСентябрь,
	|	СУММА(ВТ.СуммаОктябрь) КАК СуммаОктябрь,
	|	СУММА(ВТ.СуммаНоябрь) КАК СуммаНоябрь,
	|	СУММА(ВТ.СуммаПервыйКвартал) КАК СуммаПервыйКвартал,
	|	СУММА(ВТ.СуммаДекабрь) КАК СуммаДекабрь,
	|	СУММА(ВТ.СуммаВторойКвартал) КАК СуммаВторойКвартал,
	|	СУММА(ВТ.СуммаТретийКвартал) КАК СуммаТретийКвартал,
	|	СУММА(ВТ.СуммаЧетвертыйКвартал) КАК СуммаЧетвертыйКвартал,
	|	СУММА(ВТ.СуммаЗаПолугодие) КАК СуммаЗаПолугодие,
	|	СУММА(ВТ.СуммаЗаДевятьМесяцев) КАК СуммаЗаДевятьМесяцев,
	|	СУММА(ВТ.СуммаИтого) КАК СуммаИтого,
	|	СУММА(ВТ.СуммаИтогоФакт) КАК СуммаИтогоФакт,
	|	СУММА(ВТ.СуммаПредыдущийПлан) КАК СуммаПредыдущийПлан,
	|	СУММА(ВТ.СуммаПредыдущийФакт) КАК СуммаПредыдущийФакт,
	|	СУММА(ВТ.СуммаПредществующий) КАК СуммаПредществующий,
	|	СРЕДНЕЕ(ВТ.ПризнакКоличество) КАК ПризнакКоличество,
	|	ВТ.Категория,
	|	ВТ.Класс,
	|	СУММА(ВТ.СуммаТриГодаНазад) КАК СуммаТриГодаНазад
	|ПОМЕСТИТЬ ГруппированныеДанные
	|ИЗ
	|	ВТ КАК ВТ
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ.ДокументДвижения,
	|	ВТ.Статус,
	|	ВТ.Организация,
	|	ВТ.СтатьяБюджета,
	|	ВТ.Категория,
	|	ВТ.Класс
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ГруппированныеДанные.Организация,
	|	ГруппированныеДанные.СтатьяБюджета,
	|	ГруппированныеДанные.Статус,
	|	ГруппированныеДанные.ДокументДвижения,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЯнварь КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаЯнварь
	|	КОНЕЦ КАК СуммаЯнварь,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаФевраль КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаФевраль
	|	КОНЕЦ КАК СуммаФевраль,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаМарт КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаМарт
	|	КОНЕЦ КАК СуммаМарт,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаАпрель КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаАпрель
	|	КОНЕЦ КАК СуммаАпрель,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаМай КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаМай
	|	КОНЕЦ КАК СуммаМай,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИюнь КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаИюнь
	|	КОНЕЦ КАК СуммаИюнь,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИюль КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаИюль
	|	КОНЕЦ КАК СуммаИюль,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаАвгуст КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаАвгуст
	|	КОНЕЦ КАК СуммаАвгуст,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаСентябрь КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаСентябрь
	|	КОНЕЦ КАК СуммаСентябрь,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаОктябрь КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаОктябрь
	|	КОНЕЦ КАК СуммаОктябрь,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаНоябрь КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаНоябрь
	|	КОНЕЦ КАК СуммаНоябрь,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаДекабрь КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаДекабрь
	|	КОНЕЦ КАК СуммаДекабрь,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаПервыйКвартал КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаПервыйКвартал
	|	КОНЕЦ КАК СуммаПервыйКвартал,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаВторойКвартал КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаВторойКвартал
	|	КОНЕЦ КАК СуммаВторойКвартал,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаТретийКвартал КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаТретийКвартал
	|	КОНЕЦ КАК СуммаТретийКвартал,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЧетвертыйКвартал КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаЧетвертыйКвартал
	|	КОНЕЦ КАК СуммаЧетвертыйКвартал,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЗаПолугодие КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаЗаПолугодие
	|	КОНЕЦ КАК СуммаЗаПолугодие,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЗаДевятьМесяцев КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаЗаДевятьМесяцев
	|	КОНЕЦ КАК СуммаЗаДевятьМесяцев,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИтого КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаИтого
	|	КОНЕЦ КАК СуммаИтого,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИтогоФакт КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаИтогоФакт
	|	КОНЕЦ КАК СуммаИтогоФакт,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаПредыдущийПлан КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаПредыдущийПлан
	|	КОНЕЦ КАК СуммаПредыдущийПлан,
	|	ВЫБОР
	|		КОГДА &Оценка
	|			ТОГДА ВЫБОР
	|					КОГДА &ОкруглятьДоЦелых
	|						ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаПредыдущийПлан КАК ЧИСЛО(19, 0))
	|					ИНАЧЕ ГруппированныеДанные.СуммаПредыдущийПлан
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ОкруглятьДоЦелых
	|					ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаПредыдущийФакт КАК ЧИСЛО(19, 0))
	|				ИНАЧЕ ГруппированныеДанные.СуммаПредыдущийФакт
	|			КОНЕЦ
	|	КОНЕЦ КАК СуммаПредыдущийФакт,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаПредществующий КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаПредществующий
	|	КОНЕЦ КАК СуммаПредществующий,
	|	ВЫБОР
	|		КОГДА &ОкруглятьДоЦелых
	|			ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаТриГодаНазад КАК ЧИСЛО(19, 0))
	|		ИНАЧЕ ГруппированныеДанные.СуммаТриГодаНазад
	|	КОНЕЦ КАК СуммаТриГодаНазад,
	|	ГруппированныеДанные.ПризнакКоличество,
	|	ГруппированныеДанные.Категория,
	|	ГруппированныеДанные.Класс
	|ИЗ
	|	ГруппированныеДанные КАК ГруппированныеДанные";
	
	Запрос.УстановитьПараметр("ЕдиницаИзмерения",ЕдиницаИзмерения);
	Запрос.УстановитьПараметр("ФормируемыйБюджет",ФормируемыйБюджет);
	Запрос.УстановитьПараметр("СтатьяНачальныхОстатков",ФормируемыйБюджет.СтатьяНачальныхОстатков);
	Запрос.УстановитьПараметр("СтатьяКонечныхОстатков",ФормируемыйБюджет.СтатьяКонечныхОстатков);
	Запрос.УстановитьПараметр("Статус",Перечисления.СостоянияОбъектов.Утвержден);
	Запрос.УстановитьПараметр("НачалоПериода",НачалоДня(НачалоПериода));
	Запрос.УстановитьПараметр("КонецПериода",КонецДня(КонецПериода));
	Запрос.УстановитьПараметр("НачалоПредыдущегопериода", НачалоДня(Дата(Год(НачалоПериода)-1,1,1)));
	Запрос.УстановитьПараметр("КонецПредыдущегоПериода",КонецДня(Дата(Год(НачалоПериода)-1,12,31)));
	Запрос.УстановитьПараметр("НачалоПредществующегоПериода",НачалоДня(Дата(Год(НачалоПериода)-2,1,1)));
	Запрос.УстановитьПараметр("КонецПредществующегоПериода", КонецДня(Дата(Год(НачалоПериода)-2,12,31)));
	
	Запрос.УстановитьПараметр("НачалоПериодаТриГода",НачалоДня(Дата(Год(НачалоПериода)-3,1,1)));
	Запрос.УстановитьПараметр("КонецПериодаТриГода", КонецДня(Дата(Год(НачалоПериода)-3,12,31)));

	Запрос.УстановитьПараметр("ОкруглятьДоЦелых", ОкруглятьДоЦелых);
	Запрос.УстановитьПараметр("Оценка", Оценка);

	Возврат Запрос.Выполнить();


КонецФункции

Процедура ОбработкаРезультатаОтчета(Результат)
	
	ТиповыеОтчеты.ОбработкаРезультатаОтчета(ЭтотОбъект, Результат);

КонецПроцедуры

// Для настройки отчета (расшифровка и др.)
Процедура Настроить(Отбор, КомпоновщикНастроекОсновногоОтчета = Неопределено) Экспорт
	
	//ТиповыеОтчеты.НастроитьТиповойОтчет(ЭтотОбъект, Отбор, КомпоновщикНастроекОсновногоОтчета);
	ЗаполнитьНачальныеНастройки();
	
КонецПроцедуры

Процедура СохранитьНастройку() Экспорт
	
	СтруктураНастроек = ТиповыеОтчеты.ПолучитьСтруктуруПараметровТиповогоОтчета(ЭтотОбъект);
	
	СтруктураНастроек.Вставить("мСписокПодразделений", мСписокПодразделений);
	СтруктураНастроек.Вставить("мСписокСтруктурныхЕдиниц", мСписокСтруктурныхЕдиниц);
	СтруктураНастроек.Вставить("мДеревоСтруктурныхЕдиниц", мДеревоСтруктурныхЕдиниц);
	
	СохранениеНастроек.СохранитьНастройкуОбъекта(СохраненнаяНастройка, СтруктураНастроек);

КонецПроцедуры

// Процедура заполняет параметры отчета по элементу справочника из переменной СохраненнаяНастройка.
Процедура ПрименитьНастройку() Экспорт
	
	Если СохраненнаяНастройка.Пустая() Тогда
		Возврат;
	КонецЕсли;
	 
	СтруктураПараметров = СохраненнаяНастройка.ХранилищеНастроек.Получить();
	ТиповыеОтчеты.ПрименитьСтруктуруПараметровОтчета(ЭтотОбъект, СтруктураПараметров);
	
КонецПроцедуры


Расшифровки = Новый СписокЗначений;

НастройкаПериода = Новый НастройкаПериода;

#КонецЕсли
мСписокИсточниковФинансирования = Новый СписокЗначений;
мСписокСтруктурныхЕдиниц = Новый СписокЗначений;
мСписокПодразделений = Новый СписокЗначений;
мДеревоСтруктурныхЕдиниц = Новый ДеревоЗначений;

ВедётсяУчетПоПодразделениям = ОбщегоНазначения.ПолучитьПризнакОтображенияСтруктурныхПодразделений();

РежимРасшифровки = Ложь;