
&НаКлиенте
Процедура ПериодСравнениеПрибылиПриИзменении(Элемент)
	Отчет.ДатаНачСравнениеПрибыли 			= ДатаНачалаПериода(ПериодСравнениеПрибыли.ДатаНачала,Отчет.СценарийСравнениеПрибыли);
	Отчет.ДатаКонСравнениеПрибыли 			= ДатаОкончанияПериода(ПериодСравнениеПрибыли.ДатаОкончания,Отчет.СценарийСравнениеПрибыли);
	
	ПериодСравнениеПрибыли.ДатаНачала		= Отчет.ДатаНачСравнениеПрибыли;
	ПериодСравнениеПрибыли.ДатаОкончания	= Отчет.ДатаКонСравнениеПрибыли;
КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Функция ДатаНачалаПериода(Дата,Сценарий)
	Возврат фин_ПроцедурыМеханизмовБюджетированияКлиентСервер.ДатаНачалаПериода(Дата,Сценарий);	
КонецФункции

&НаКлиентеНаСервереБезКонтекста
Функция ДатаОкончанияПериода(Дата,Сценарий)
	Возврат фин_ПроцедурыМеханизмовБюджетированияКлиентСервер.ДатаКонцаПериода(Дата,Сценарий);	
КонецФункции

&НаКлиенте
Процедура ПериодОтчетаПриИзменении(Элемент)
	Отчет.ДатаНач 				= ДатаНачалаПериода(ПериодОтчета.ДатаНачала,Отчет.Сценарий);
	Отчет.ДатаКон 				= ДатаОкончанияПериода(ПериодОтчета.ДатаОкончания,Отчет.Сценарий);
	
	ПериодОтчета.ДатаНачала		= Отчет.ДатаНач;
	ПериодОтчета.ДатаОкончания	= Отчет.ДатаКон;
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Отчет.Сценарий = фин_ОбщегоНазначенияВызовСервераПовтИсп.ЗначениеПеременной("фин_ОсновнойСценарийПланирования");
	Отчет.СценарийСравнениеПрибыли = Отчет.Сценарий;
	
	Отчет.ДатаНач 				= ДатаНачалаПериода(НачалоГода(ТекущаяДата()),Отчет.Сценарий);
	Отчет.ДатаКон 				= ДатаОкончанияПериода(КонецГода(ТекущаяДата()),Отчет.Сценарий);
	
	ПериодОтчета.ДатаНачала		= Отчет.ДатаНач;
	ПериодОтчета.ДатаОкончания	= Отчет.ДатаКон;
	
	Если НЕ Отчет.ВыводитьБаланс
		И НЕ Отчет.ВыводитьПрибылиИУбытки Тогда // ПустаяФорма
		
		Отчет.ВыводитьБаланс						= Истина;
		Отчет.ВыводитьПрибылиИУбытки				= Истина;
		Отчет.АнализЛиквидностиИПлатежеспособности	= Истина;
		Отчет.АнализДоходностиИРентабельности		= Истина;
		Отчет.АнализОборачиваемости					= Истина;
		Отчет.АнализИспользованияКапитала			= Истина;
	КонецЕсли;
	
	УправлениеФормой(ЭтотОбъект);
	
КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Процедура УправлениеФормой(Форма)
	
	// установка видимости и доступности элементов в зависимости от значений реквизитов
	
	Элементы 	= Форма.Элементы;
	Объект 		= Форма.Отчет;
	
	Элементы.АнализЛиквидностиИПлатежеспособности.Видимость	= Объект.ВыводитьБаланс;
	Элементы.АнализДоходностиИРентабельности.Видимость		= Объект.ВыводитьПрибылиИУбытки;
	
	Элементы.АнализОборачиваемости.Видимость				= Объект.ВыводитьБаланс И Объект.ВыводитьПрибылиИУбытки;
	Элементы.АнализИспользованияКапитала.Видимость			= Объект.ВыводитьБаланс И Объект.ВыводитьПрибылиИУбытки;
	
КонецПроцедуры

&НаКлиенте
Процедура ВыводитьБалансПриИзменении(Элемент)
	Если НЕ Отчет.ВыводитьБаланс Тогда
		Отчет.АнализЛиквидностиИПлатежеспособности	= Ложь;
		Отчет.АнализИспользованияКапитала			= Ложь;
		Отчет.АнализОборачиваемости					= Ложь;
	КонецЕсли;
	УправлениеФормой(ЭтотОбъект);
КонецПроцедуры

&НаКлиенте
Процедура ВыводитьПрибылиИУбыткиПриИзменении(Элемент)
	Если НЕ Отчет.ВыводитьПрибылиИУбытки Тогда
		Отчет.АнализДоходностиИРентабельности	= Ложь;
		Отчет.АнализИспользованияКапитала		= Ложь;
		Отчет.АнализОборачиваемости				= Ложь;
	КонецЕсли;
	УправлениеФормой(ЭтотОбъект);
КонецПроцедуры

&НаКлиенте
Процедура СценарийПриИзменении(Элемент)
	ПериодОтчетаПриИзменении(Элемент);
КонецПроцедуры

&НаКлиенте
Процедура СценарийСравнениеПрибылиПриИзменении(Элемент)
	ПериодСравнениеПрибылиПриИзменении(Элемент);
КонецПроцедуры

&НаСервере
Процедура СформироватьОтчетНаСервере()
	СформироватьОтчет(Ложь);	
	//УстановитьОбработчикиИзменений();
	Расчет();
КонецПроцедуры

&НаКлиенте
Процедура СформироватьОтчетКлиент(Команда)
	Если ПроверитьЗаполнение() Тогда
		СформироватьОтчетНаСервере();
	КонецЕсли;
КонецПроцедуры

// Формирует отчет
//
&НаСервере
Процедура СформироватьОтчет(НеЗаполнять,ТолькоШаблон=Ложь)
	Перем ИтогиПоСчетам, ИтогиПоОборотам; // Результат запроса по счетам
	СтруктураДетали = Новый Соответствие;
	
	Макет = Отчеты.фин_ФинансовыйАнализДанныхБюджетирования.ПолучитьМакет("ФинансовыйАнализ");
	ДокументРезультат.Очистить(); 
	
	ДатаНач = Отчет.ДатаНач;
	ДатаКон = Отчет.ДатаКон;
	Сценарий = Отчет.Сценарий;
	
//	Действие=Новый Действие("ДокументДетализацияПриИзменении");
	
	Если Отчет.ВыводитьБаланс Тогда
		
		ОбластьОтчет=Макет.ПолучитьОбласть("Баланс");
		ОбластьОтчет.Параметры.ЗаголовокБаланса="Аггрегированный аналитический баланс (Aggregated balance sheet)"+Символы.ПС
												+" за период с "+Формат(ДатаНач,"ДФ=dd.MM.yyyy; ДП=-")
												+" по "+Формат(ДатаКон,"ДФ=dd.MM.yyyy; ДП=-")+"."
												+Символы.ПС+?(Сценарий.Пустая(),"Фактические данные",Сценарий.Наименование);
		
		ДокументРезультат.Вывести(ОбластьОтчет);
		
	КонецЕсли;
	
	Если Отчет.АнализЛиквидностиИПлатежеспособности Тогда
		
		ОбластьОтчет=Макет.ПолучитьОбласть("АнализЛиквидностиИПлатежеспособности");		
		ДокументРезультат.Вывести(ОбластьОтчет);
		
	КонецЕсли;
	
	Если Отчет.ВыводитьПрибылиИУбытки Тогда
		
		ОбластьОтчет=Макет.ПолучитьОбласть("ОтчетОПрибыляхИУбытках");
		ОбластьОтчет.Параметры.ЗаголовокПрибылиИУбытки="Сводный отчет о прибылях и убытках (Profit & Loss Statement)"+Символы.ПС
												+" за период с "+Формат(ДатаНач,"ДФ=dd.MM.yyyy; ДП=-")
												+" по "+Формат(ДатаКон,"ДФ=dd.MM.yyyy; ДП=-")+"."
												+Символы.ПС+?(Сценарий.Пустая(),"Фактические данные",Отчет.Сценарий.Наименование);
												
		ОбластьОтчет.Параметры.ОтчетныйПериод="";
		
		ОбластьОтчет.Параметры.ПрошедшийПериод=?(Отчет.СценарийСравнениеПрибыли=Сценарий,"",?(Отчет.СценарийСравнениеПрибыли.Пустая(),"Фактические данные: "+Символы.ПС,Отчет.СценарийСравнениеПрибыли.Наименование+": "+Символы.ПС))
												+"период с "+Формат(Отчет.ДатаНачСравнениеПрибыли,"ДФ=dd.MM.yyyy; ДП=-")
												+" по "+Формат(Отчет.ДатаКонСравнениеПрибыли,"ДФ=dd.MM.yyyy; ДП=-");
		
		
		ДокументРезультат.Вывести(ОбластьОтчет);
		
	КонецЕсли;	
		
	Если Отчет.АнализОборачиваемости Тогда
		
		ОбластьОтчет=Макет.ПолучитьОбласть("АнализОборачиваемости");	
		ДокументРезультат.Вывести(ОбластьОтчет);
		
	КонецЕсли;
	
	Если Отчет.АнализДоходностиИРентабельности Тогда
		
		ОбластьОтчет=Макет.ПолучитьОбласть("АнализДоходностиИРентабельности");		
		ДокументРезультат.Вывести(ОбластьОтчет);
		
	КонецЕсли;
	
	Если Отчет.АнализИспользованияКапитала Тогда
		
		ОбластьОтчет=Макет.ПолучитьОбласть("АнализИспользованияКапитала");		
		ДокументРезультат.Вывести(ОбластьОтчет);
		
	КонецЕсли;
	
	Если НеЗаполнять Тогда
		Возврат;
	КонецЕсли;
	
	Если Отчет.ВыводитьБаланс Тогда
		
		Если фин_ОбщегоНазначенияВызовСервераПовтИсп.ЗначениеПеременной("фин_ВестиУчетПоПлануСчетовБюджетирования") Тогда
		
			Если НЕ ТолькоШаблон Тогда
				
				// Получаем остатки по счетам бюджетирования
				
				Запрос=Новый Запрос;
				Запрос.Текст="ВЫБРАТЬ РАЗРЕШЕННЫЕ
				|	БюджетированиеОстаткиИОбороты.Счет КАК Счет,
				|	БюджетированиеОстаткиИОбороты.СуммаУпрНачальныйОстаток КАК СуммаУпрНачальныйОстаток,
				|	БюджетированиеОстаткиИОбороты.СуммаУпрНачальныйОстатокДт КАК СуммаУпрНачальныйОстатокДт,
				|	БюджетированиеОстаткиИОбороты.СуммаУпрНачальныйОстатокКт КАК СуммаУпрНачальныйОстатокКт,
				|	БюджетированиеОстаткиИОбороты.СуммаУпрКонечныйОстаток КАК СуммаУпрКонечныйОстаток,
				|	БюджетированиеОстаткиИОбороты.СуммаУпрКонечныйОстатокДт КАК СуммаУпрКонечныйОстатокДт,
				|	БюджетированиеОстаткиИОбороты.СуммаУпрКонечныйОстатокКт КАК СуммаУпрКонечныйОстатокКт
				|ИЗ
				|	РегистрБухгалтерии.фин_Бюджетирование.ОстаткиИОбороты(&ДатаНач, &ДатаКон, , , , , Сценарий=&Сценарий) КАК БюджетированиеОстаткиИОбороты
				|
				|ИТОГИ СУММА(СуммаУпрНачальныйОстаток), СУММА(СуммаУпрНачальныйОстатокДт), СУММА(СуммаУпрНачальныйОстатокКт), СУММА(СуммаУпрКонечныйОстаток), СУММА(СуммаУпрКонечныйОстатокДт), СУММА(СуммаУпрКонечныйОстатокКт) ПО
				|	Счет ИЕРАРХИЯ";
				
				Запрос.УстановитьПараметр("Сценарий",Сценарий);
				Запрос.УстановитьПараметр("ДатаНач",ДатаНач);
				Запрос.УстановитьПараметр("ДатаКон",ДатаКон);
				
				ИтогиПоСчетам=Запрос.Выполнить().Выгрузить();
				
			КонецЕсли;
			
		КонецЕсли;
		
		Запрос=Новый Запрос;
		Запрос.Текст="ВЫБРАТЬ РАЗРЕШЕННЫЕ
		             |	СтатьиАналитическогоБаланса.ОбластьОтчета КАК ОбластьОтчета,
		             |	СтатьиАналитическогоБаланса.Наименование КАК СтрокаАнализаНаименование,
		             |	ВЫРАЗИТЬ(СтатьиАналитическогоБаланса.НаименованиеДляОтчета КАК СТРОКА(100)) КАК СтрокаАнализаНаименованиеДляОтчета,
		             |	СтатьиАналитическогоБаланса.ОтборСчетовБюджетирования.(
		             |		Счет,
		             |		Знак,
		             |		ВидОстатка
		             |	) КАК ОтборСчетовАнализ,
		             |	ДетализацияАналитическогоБаланса.Наименование КАК СтрокаДетализацияНаименование,
		             |	ВЫРАЗИТЬ(ДетализацияАналитическогоБаланса.НаименованиеДляОтчета КАК СТРОКА(100)) КАК СтрокаДетализацияНаименованиеДляОтчета,
		             |	ДетализацияАналитическогоБаланса.ОтборСчетовБюджетирования.(
		             |		Счет,
		             |		Знак,
		             |		ВидОстатка
		             |	) КАК ОтборСчетовДетализация,
		             |	СтатьиАналитическогоБаланса.ОстаткиБюджетов.(
		             |		Ссылка,
		             |		НомерСтроки,
		             |		ФормулаРасчета,
		             |		Знак
		             |	) КАК ОстаткиБюджетовАнализ,
		             |	ДетализацияАналитическогоБаланса.ОстаткиБюджетов.(
		             |		Ссылка,
		             |		НомерСтроки,
		             |		ФормулаРасчета,
		             |		Знак
		             |	) КАК ОстаткиБюджетовДетализация
		             |ИЗ
		             |	Справочник.фин_СтатьиАналитическогоБаланса КАК СтатьиАналитическогоБаланса
		             |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.фин_ДетализацияАналитическогоБаланса КАК ДетализацияАналитическогоБаланса
		             |		ПО СтатьиАналитическогоБаланса.Ссылка = ДетализацияАналитическогоБаланса.Владелец
		             |ГДЕ
		             |	СтатьиАналитическогоБаланса.Владелец = &ВариантНастройки
		             |	И НЕ СтатьиАналитическогоБаланса.ЭтоГруппа";
		
		Запрос.УстановитьПараметр("ВариантНастройки",Отчет.ВариантНастройки);
		
		Результат=Запрос.Выполнить();
		
		Выборка=Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		ТекущееПоле="";
		СтрокДетализации=0;
				
		Пока Выборка.Следующий() Цикл
						
			Если Не Выборка.ОбластьОтчета=ТекущееПоле Тогда
				
				СуммаСтрокаНач=0;
				СуммаСтрокаКон=0;
				
				Если НЕ ТолькоШаблон Тогда
					
					Если фин_ОбщегоНазначенияВызовСервераПовтИсп.ЗначениеПеременной("фин_ВестиУчетПоПлануСчетовБюджетирования") Тогда
						ВыборкаСчетов=Выборка.ОтборСчетовАнализ.Выбрать();
						
						Пока ВыборкаСчетов.Следующий() Цикл
							
							Остатки=ПолучитьОстатки(ИтогиПоСчетам,ВыборкаСчетов.Счет,ВыборкаСчетов.Знак,ВыборкаСчетов.ВидОстатка);
							
							СуммаСтрокаНач=СуммаСтрокаНач+Остатки.СуммаНач;
							СуммаСтрокаКон=СуммаСтрокаКон+Остатки.СуммаКон;
							
						КонецЦикла;
					КонецЕсли;
					
					ВыборкаФормул=Выборка.ОстаткиБюджетовАнализ.Выбрать();
					
					Пока ВыборкаФормул.Следующий() Цикл
						
						Остатки=ПолучитьОстаткиПоФормуле(ВыборкаФормул.ФормулаРасчета,ВыборкаФормул.Знак);
						
						СуммаСтрокаНач=СуммаСтрокаНач+Остатки.СуммаНач;
						СуммаСтрокаКон=СуммаСтрокаКон+Остатки.СуммаКон;
						
					КонецЦикла;
				КонецЕсли;
				
				ОбластьНач=ДокументРезультат.Области["П008"+Выборка.ОбластьОтчета];
				ОбластьКон=ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета];
				
				ОбластьНач.Значение=СуммаСтрокаНач;
				ОбластьКон.Значение=СуммаСтрокаКон;
				
				ДокументРезультат.Области["П003"+Выборка.ОбластьОтчета].Текст=?(Выборка.СтрокаАнализаНаименованиеДляОтчета="",
																				Выборка.СтрокаАнализаНаименование,
																				Выборка.СтрокаАнализаНаименованиеДляОтчета);
				
				НомерСтроки=ОбластьНач.Верх;
				
				СтрокаОбласть=ДокументРезультат.Область("R"+НомерСтроки);
				ТекущееПоле=Выборка.ОбластьОтчета;
				СтрокДетализации=0;
				
				СтруктураДетали.Вставить(Выборка.ОбластьОтчета,0);
				
				ШрифтДетализации=Новый Шрифт(ОбластьНач,,,Истина,Ложь,Ложь,Ложь);
							
			КонецЕсли;		
			
			Если Не Выборка.СтрокаДетализацияНаименование=NULL Тогда
				
				СтрокДетализации=СтрокДетализации+1;
				
				СтруктураДетали.Вставить(Выборка.ОбластьОтчета,СтрокДетализации);
				
				Префикс=?(СтрокДетализации>1,"_"+(СтрокДетализации-1),"");
				
				СуммаДетализацияНач=0;
				СуммаДетализацияКон=0;
				
				Если НЕ ТолькоШаблон Тогда
					
					Если фин_ОбщегоНазначенияВызовСервераПовтИсп.ЗначениеПеременной("фин_ВестиУчетПоПлануСчетовБюджетирования") Тогда
						ВыборкаСчетов=Выборка.ОтборСчетовДетализация.Выбрать();
						
						Пока ВыборкаСчетов.Следующий() Цикл
							
							Остатки=ПолучитьОстатки(ИтогиПоСчетам,ВыборкаСчетов.Счет,ВыборкаСчетов.Знак,ВыборкаСчетов.ВидОстатка);
							
							СуммаДетализацияНач=СуммаДетализацияНач+Остатки.СуммаНач;
							СуммаДетализацияКон=СуммаДетализацияКон+Остатки.СуммаКон;
							
						КонецЦикла;
					КонецЕсли;
					
					
					ВыборкаФормул=Выборка.ОстаткиБюджетовДетализация.Выбрать();
					
					Пока ВыборкаФормул.Следующий() Цикл
						
						Остатки=ПолучитьОстаткиПоФормуле(ВыборкаФормул.ФормулаРасчета,ВыборкаФормул.Знак);
						
						СуммаДетализацияНач=СуммаДетализацияНач+Остатки.СуммаНач;
						СуммаДетализацияКон=СуммаДетализацияКон+Остатки.СуммаКон;
						
					КонецЦикла;
				КонецЕсли;
								
				ДокументРезультат.ВставитьОбласть(СтрокаОбласть,,ТипСмещенияТабличногоДокумента.ПоВертикали);
				
				//Текущие имена остались от скопированной строки
								
				ДокументРезультат.Области["П008"+Выборка.ОбластьОтчета+Префикс].Значение=СуммаДетализацияНач;
				//ДокументРезультат.Области["П008"+Выборка.ОбластьОтчета+Префикс].ЭлементУправления.УстановитьДействие("ПриИзменении",Действие);
				ДокументРезультат.Области["П008"+Выборка.ОбластьОтчета+Префикс].ЭлементУправления.КнопкаВыбора=Истина;
				
				ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета+Префикс].Значение=СуммаДетализацияКон;
				//ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета+Префикс].ЭлементУправления.УстановитьДействие("ПриИзменении",Действие);
				ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета+Префикс].ЭлементУправления.КнопкаВыбора=Истина;
				
				ДокументРезультат.Области["П003"+Выборка.ОбластьОтчета+Префикс].Отступ=8;
                ДокументРезультат.Области["П003"+Выборка.ОбластьОтчета+Префикс].Текст=?(Выборка.СтрокаДетализацияНаименованиеДляОтчета="",
																				Выборка.СтрокаДетализацияНаименование,
																				Выборка.СтрокаДетализацияНаименованиеДляОтчета);
				
				// Задаем новые имена
				ДокументРезультат.Области["П003"+Выборка.ОбластьОтчета+Префикс].Имя="П003"+Выборка.ОбластьОтчета+"_"+СтрокДетализации;
				ДокументРезультат.Область("R"+(НомерСтроки+СтрокДетализации-1)+"C3:R"+(НомерСтроки+СтрокДетализации-1)+"C6").Имя="П003"+Выборка.ОбластьОтчета+Префикс;

				Для Индекс=8 По 13 Цикл
					
					ТекущееИмя="П"+Формат(Индекс,"ЧЦ=3; ЧВН=")+Выборка.ОбластьОтчета+Префикс;
					
					ДокументРезультат.Области[ТекущееИмя].Имя="П"+Формат(Индекс,"ЧЦ=3; ЧВН=")+Выборка.ОбластьОтчета+"_"+СтрокДетализации;
					ДокументРезультат.Область("R"+(НомерСтроки+СтрокДетализации-1)+"C"+Индекс).Имя=ТекущееИмя;
					
				КонецЦикла;
								
				СтрокаОбласть=ДокументРезультат.Область("R"+(НомерСтроки+СтрокДетализации));
				СтрокаОбласть.Шрифт=ШрифтДетализации;
								
			КонецЕсли;
					
		КонецЦикла;
		
	КонецЕсли;
	
	МассивРегистров = фин_ОбщегоНазначенияВызовСервераПовтИсп.РегистрыФактическихДанных();
	МассивПлановыхРегистров = Новый Массив;
	МассивПлановыхРегистров.Добавить("фин_ОборотыБюджетов");
	
	Если Отчет.ВыводитьПрибылиИУбытки Тогда
		
		Если Отчет.ДатаНачСравнениеПрибыли='00010101' Тогда
			ДатаНачСравнениеПрибыли=фин_ПроцедурыМеханизмовБюджетированияКлиентСервер.ДатаНачалаПериода(фин_ПроцедурыМеханизмовБюджетированияКлиентСервер.ДобавитьИнтервал(ДатаНач,Перечисления.фин_Периодичность.Год,-1),фин_ОбщегоНазначенияВызовСервераПовтИсп.ПолучитьПериодичностьСценария(Сценарий));
			ДатаКонСравнениеПрибыли=фин_ПроцедурыМеханизмовБюджетированияКлиентСервер.ДатаКонцаПериода(фин_ПроцедурыМеханизмовБюджетированияКлиентСервер.ДобавитьИнтервал(ДатаКон,Перечисления.фин_Периодичность.Год,-1),фин_ОбщегоНазначенияВызовСервераПовтИсп.ПолучитьПериодичностьСценария(Сценарий));
		КонецЕсли;
		
		Если НЕ ТолькоШаблон Тогда
			
			// Получаем обороты по статьям
			
			Запрос=Новый Запрос;
			Запрос.Текст="ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	ОборотыПоСтатьям.ФинансовыйПоказатель КАК ФинансовыйПоказатель,
			|	ОборотыПоСтатьям.СуммаТекущая КАК СуммаТекущая,
			|	ОборотыПоСтатьям.СуммаСравнение КАК СуммаСравнение
			|ИЗ
			|	(";
			Первый = Истина;
			Для Каждого ИмяРегистра Из ?(ЗначениеЗаполнено(Сценарий),МассивПлановыхРегистров,МассивРегистров) Цикл
				Запрос.Текст = Запрос.Текст+?(Первый,"","
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|") +"
				|	ВЫБРАТЬ
				|		ОборотыБюджетовТек.ФинансовыйПоказатель КАК ФинансовыйПоказатель,
				|		ОборотыБюджетовТек.СуммаУпрОборот КАК СуммаТекущая,
				|		0 КАК СуммаСравнение
				|	ИЗ
				|		РегистрНакопления."+ИмяРегистра+".Обороты(, , ,ПериодПланирования>=&ДатаНач И ПериодПланирования<=&ДатаКон И Сценарий = &Сценарий) КАК ОборотыБюджетовТек
				|	
				|";
				Первый = Ложь;
			КонецЦикла;
			Для Каждого ИмяРегистра Из ?(ЗначениеЗаполнено(Отчет.СценарийСравнениеПрибыли),МассивПлановыхРегистров,МассивРегистров) Цикл
				Запрос.Текст = Запрос.Текст+?(Первый,"","
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|") +"
				|	ВЫБРАТЬ
				|		ОборотыБюджетовСравн.ФинансовыйПоказатель,
				|		0,
				|		ОборотыБюджетовСравн.СуммаУпрОборот
				|	ИЗ
				|		РегистрНакопления."+ИмяРегистра+".Обороты(, , ,ПериодПланирования>=&ДатаНачСравнениеПрибыли И ПериодПланирования<=&ДатаКонСравнениеПрибыли И Сценарий = &СценарийСравнениеПрибыли) КАК ОборотыБюджетовСравн
				|";
				Первый = Ложь;
			КонецЦикла;
			Запрос.Текст=Запрос.Текст+"	
			|	) КАК ОборотыПоСтатьям
			|
			|ИТОГИ СУММА(СуммаТекущая), СУММА(СуммаСравнение) ПО
			|	ФинансовыйПоказатель ИЕРАРХИЯ";
			
			Запрос.УстановитьПараметр("Сценарий",Сценарий);
			Запрос.УстановитьПараметр("СценарийСравнениеПрибыли",Отчет.СценарийСравнениеПрибыли);
			
			Запрос.УстановитьПараметр("ДатаНач",ДатаНач);
			Запрос.УстановитьПараметр("ДатаКон",ДатаКон);
			
			Запрос.УстановитьПараметр("ДатаНачСравнениеПрибыли",Отчет.ДатаНачСравнениеПрибыли);
			Запрос.УстановитьПараметр("ДатаКонСравнениеПрибыли",Отчет.ДатаКонСравнениеПрибыли);
			
			ИтогиПоОборотам=Запрос.Выполнить().Выгрузить();
			
		КонецЕсли;
		
		Запрос=Новый Запрос;
		Запрос.Текст="ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СтатьиОтчетаОПрибыляхИУбытках.ОбластьОтчета КАК ОбластьОтчета,
		|	СтатьиОтчетаОПрибыляхИУбытках.Наименование КАК СтрокаАнализаНаименование,
		|	ВЫРАЗИТЬ(СтатьиОтчетаОПрибыляхИУбытках.НаименованиеДляОтчета КАК СТРОКА(100)) КАК СтрокаАнализаНаименованиеДляОтчета,
		|	СтатьиОтчетаОПрибыляхИУбытках.ОтборСтатейОборотов.(
		|		ФинансовыйПоказатель,
		|		Знак) КАК ОтборСтатейАнализ,
		|	ДетализацияОтчетаОПрибыляхИУбытках.Наименование КАК СтрокаДетализацияНаименование,
		|	ВЫРАЗИТЬ(ДетализацияОтчетаОПрибыляхИУбытках.НаименованиеДляОтчета КАК СТРОКА(100)) КАК СтрокаДетализацияНаименованиеДляОтчета,
		|	ДетализацияОтчетаОПрибыляхИУбытках.ОтборСтатейОборотов.(
		|		ФинансовыйПоказатель,
		|		Знак) КАК ОтборСтатейДетализация
		|ИЗ
		|	Справочник.фин_СтатьиОтчетаОПрибыляхИУбытках КАК СтатьиОтчетаОПрибыляхИУбытках
		|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.фин_ДетализацияОтчетаОПрибыляхИУбытках КАК ДетализацияОтчетаОПрибыляхИУбытках
		|		ПО СтатьиОтчетаОПрибыляхИУбытках.Ссылка = ДетализацияОтчетаОПрибыляхИУбытках.Владелец
		|
		|ГДЕ
		|	СтатьиОтчетаОПрибыляхИУбытках.Владелец = &ВариантНастройки";
		
		Запрос.УстановитьПараметр("ВариантНастройки",Отчет.ВариантНастройки);
		
		Результат=Запрос.Выполнить();
		
		Выборка=Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		ТекущееПоле="";
		СтрокДетализации=0;
				
		Пока Выборка.Следующий() Цикл
						
			Если Не Выборка.ОбластьОтчета=ТекущееПоле Тогда
				
				СуммаСтрокаТек=0;
				СуммаСтрокаСравн=0;
				
				Если НЕ ТолькоШаблон Тогда
					
					ВыборкаСтатей=Выборка.ОтборСтатейАнализ.Выбрать();
					
					Пока ВыборкаСтатей.Следующий() Цикл
						
						Обороты=ПолучитьОбороты(ИтогиПоОборотам,ВыборкаСтатей.ФинансовыйПоказатель,ВыборкаСтатей.Знак);
						
						СуммаСтрокаТек=СуммаСтрокаТек+Обороты.СуммаТек;
						СуммаСтрокаСравн=СуммаСтрокаСравн+Обороты.СуммаСравн;
						
					КонецЦикла;
					
				КонецЕсли;
				
				ОбластьТек=ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета];
				ОбластьСравн=ДокументРезультат.Области["П012"+Выборка.ОбластьОтчета];
				
				ОбластьТек.Значение=СуммаСтрокаТек;
				ОбластьСравн.Значение=СуммаСтрокаСравн;
				
				ДокументРезультат.Области["П003"+Выборка.ОбластьОтчета].Текст=?(Выборка.СтрокаАнализаНаименованиеДляОтчета="",
																				Выборка.СтрокаАнализаНаименование,
																				Выборка.СтрокаАнализаНаименованиеДляОтчета);
				
				НомерСтроки=ОбластьТек.Верх;
				
				СтрокаОбласть=ДокументРезультат.Область("R"+НомерСтроки);
				ТекущееПоле=Выборка.ОбластьОтчета;
				СтрокДетализации=0;
				
				СтруктураДетали.Вставить(Выборка.ОбластьОтчета,0);
				
				ШрифтДетализации=Новый Шрифт(ОбластьНач,,,Истина,Ложь,Ложь,Ложь);
							
			КонецЕсли;		
			
			Если Не Выборка.СтрокаДетализацияНаименование=NULL Тогда
				
				СтрокДетализации=СтрокДетализации+1;
				
				СтруктураДетали.Вставить(Выборка.ОбластьОтчета,СтрокДетализации);
				
				Префикс=?(СтрокДетализации>1,"_"+(СтрокДетализации-1),"");
				
				СуммаДетализацияТек=0;
				СуммаДетализацияСравн=0;
				
				Если НЕ ТолькоШаблон Тогда
					
					ВыборкаСтатей=Выборка.ОтборСтатейДетализация.Выбрать();
					
					Пока ВыборкаСтатей.Следующий() Цикл
						
						Обороты=ПолучитьОбороты(ИтогиПоОборотам,ВыборкаСтатей.ФинансовыйПоказатель,ВыборкаСтатей.Знак);
						
						СуммаДетализацияТек=СуммаДетализацияТек+Обороты.СуммаТек;
						СуммаДетализацияСравн=СуммаДетализацияСравн+Обороты.СуммаСравн;
						
					КонецЦикла;
					
				КонецЕсли;
								
				ДокументРезультат.ВставитьОбласть(СтрокаОбласть,,ТипСмещенияТабличногоДокумента.ПоВертикали);
				
				//Текущие имена остались от скопированной строки
								
				ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета+Префикс].Значение=СуммаДетализацияТек;
				//ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета+Префикс].ЭлементУправления.УстановитьДействие("ПриИзменении",Действие);
				ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета+Префикс].ЭлементУправления.КнопкаВыбора=Истина;
				
				ДокументРезультат.Области["П012"+Выборка.ОбластьОтчета+Префикс].Значение=СуммаДетализацияСравн;
				//ДокументРезультат.Области["П012"+Выборка.ОбластьОтчета+Префикс].ЭлементУправления.УстановитьДействие("ПриИзменении",Действие);
				ДокументРезультат.Области["П012"+Выборка.ОбластьОтчета+Префикс].ЭлементУправления.КнопкаВыбора=Истина;
				
				ДокументРезультат.Области["П003"+Выборка.ОбластьОтчета+Префикс].Отступ=8;
                ДокументРезультат.Области["П003"+Выборка.ОбластьОтчета+Префикс].Текст=?(Выборка.СтрокаДетализацияНаименованиеДляОтчета="",
																				Выборка.СтрокаДетализацияНаименование,
																				Выборка.СтрокаДетализацияНаименованиеДляОтчета);
				
				// Задаем новые имена
				ДокументРезультат.Области["П003"+Выборка.ОбластьОтчета+Префикс].Имя="П003"+Выборка.ОбластьОтчета+"_"+СтрокДетализации;
				ДокументРезультат.Область("R"+(НомерСтроки+СтрокДетализации-1)+"C3:R"+(НомерСтроки+СтрокДетализации-1)+"C8").Имя="П003"+Выборка.ОбластьОтчета+Префикс;
				
				
				ДокументРезультат.Области["П010"+Выборка.ОбластьОтчета+Префикс].Имя="П010"+Выборка.ОбластьОтчета+"_"+СтрокДетализации;
				ДокументРезультат.Область("R"+(НомерСтроки+СтрокДетализации-1)+"C10:R"+(НомерСтроки+СтрокДетализации-1)+"C11").Имя="П010"+Выборка.ОбластьОтчета+Префикс;
				
				ДокументРезультат.Области["П012"+Выборка.ОбластьОтчета+Префикс].Имя="П012"+Выборка.ОбластьОтчета+"_"+СтрокДетализации;
				ДокументРезультат.Область("R"+(НомерСтроки+СтрокДетализации-1)+"C12:R"+(НомерСтроки+СтрокДетализации-1)+"C13").Имя="П012"+Выборка.ОбластьОтчета+Префикс;
				
				СтрокаОбласть=ДокументРезультат.Область("R"+(НомерСтроки+СтрокДетализации));
				СтрокаОбласть.Шрифт=ШрифтДетализации;
								
			КонецЕсли;
					
		КонецЦикла;
		
	КонецЕсли;
	
	мСтруктураДетали = Новый ФиксированноеСоответствие(СтруктураДетали);

КонецПроцедуры // СформироватьОтчет()


// Выполняет пересчет ячеек табличного документа
//
&НаСервере
Процедура Расчет()
	
	ЯчейкиРасчета=ДокументРезультат.Области;	

	Если Отчет.ВыводитьБаланс Тогда

		//*************** таблица 1 *****************************************************
			
		ЯчейкиРасчета.П0080014.Значение	= ЯчейкиРасчета.П0080015.Значение
										+ ЯчейкиРасчета.П0080016.Значение;

		ЯчейкиРасчета.П0080017.Значение	= ЯчейкиРасчета.П0080018.Значение
										+ ЯчейкиРасчета.П0080019.Значение;

		ЯчейкиРасчета.П0080020.Значение = ЯчейкиРасчета.П0080021.Значение
										+ ЯчейкиРасчета.П0080022.Значение
										+ ЯчейкиРасчета.П0080023.Значение
										+ ЯчейкиРасчета.П0080024.Значение;

		ЯчейкиРасчета.П0080026.Значение	= ЯчейкиРасчета.П0080027.Значение
										+ ЯчейкиРасчета.П0080028.Значение;

		ЯчейкиРасчета.П0080013.Значение	= ЯчейкиРасчета.П0080014.Значение
										+ ЯчейкиРасчета.П0080017.Значение
										+ ЯчейкиРасчета.П0080020.Значение;

		ЯчейкиРасчета.П0080025.Значение	= ЯчейкиРасчета.П0080026.Значение;

		ЯчейкиРасчета.П0080029.Значение	= ЯчейкиРасчета.П0080013.Значение
										+ ЯчейкиРасчета.П0080025.Значение;

		ЯчейкиРасчета.П0100014.Значение	= ЯчейкиРасчета.П0100015.Значение
										+ ЯчейкиРасчета.П0100016.Значение;

		ЯчейкиРасчета.П0100017.Значение	= ЯчейкиРасчета.П0100018.Значение
										+ ЯчейкиРасчета.П0100019.Значение;

		ЯчейкиРасчета.П0100020.Значение	= ЯчейкиРасчета.П0100021.Значение
										+ ЯчейкиРасчета.П0100022.Значение
										+ ЯчейкиРасчета.П0100023.Значение
										+ ЯчейкиРасчета.П0100024.Значение;

		ЯчейкиРасчета.П0100026.Значение	= ЯчейкиРасчета.П0100027.Значение
										+ ЯчейкиРасчета.П0100028.Значение;

		ЯчейкиРасчета.П0100013.Значение	= ЯчейкиРасчета.П0100014.Значение
										+ ЯчейкиРасчета.П0100017.Значение
										+ ЯчейкиРасчета.П0100020.Значение;

		ЯчейкиРасчета.П0100025.Значение	= ЯчейкиРасчета.П0100026.Значение;

		ЯчейкиРасчета.П0100029.Значение	= ЯчейкиРасчета.П0100013.Значение
										+ ЯчейкиРасчета.П0100025.Значение;

		Для i=13 по 29 цикл	

			ЯчейкиРасчета["П00900"+i].Значение=?(ЯчейкиРасчета.П0080029.Значение<>0,(ЯчейкиРасчета["П00800"+i].Значение/ЯчейкиРасчета["П0080029"].Значение)*100,0);
			ЯчейкиРасчета["П01100"+i].Значение=?(ЯчейкиРасчета.П0100029.Значение<>0,(ЯчейкиРасчета["П01000"+i].Значение/ЯчейкиРасчета["П0100029"].Значение)*100,0);
			ЯчейкиРасчета["П01200"+i].Значение=ЯчейкиРасчета["П01000"+i].Значение-ЯчейкиРасчета["П00800"+i].Значение;
			ЯчейкиРасчета["П01300"+i].Значение=ЯчейкиРасчета["П01100"+i].Значение-ЯчейкиРасчета["П00900"+i].Значение;
			
			СтрокДетализации=мСтруктураДетали.Получить("00"+i);
			
			Если Не СтрокДетализации=Неопределено Тогда
				
				Для Инд=1 по СтрокДетализации Цикл;
					
					ЯчейкиРасчета["П00900"+i+"_"+Инд].Значение=?(ЯчейкиРасчета.П0080029.Значение<>0,(ЯчейкиРасчета["П00800"+i+"_"+Инд].Значение/ЯчейкиРасчета["П0080029"].Значение)*100,0);
					ЯчейкиРасчета["П01100"+i+"_"+Инд].Значение=?(ЯчейкиРасчета.П0100029.Значение<>0,(ЯчейкиРасчета["П01000"+i+"_"+Инд].Значение/ЯчейкиРасчета["П0100029"].Значение)*100,0);
					ЯчейкиРасчета["П01200"+i+"_"+Инд].Значение=ЯчейкиРасчета["П01000"+i+"_"+Инд].Значение-ЯчейкиРасчета["П00800"+i+"_"+Инд].Значение;
					ЯчейкиРасчета["П01300"+i+"_"+Инд].Значение=ЯчейкиРасчета["П01100"+i+"_"+Инд].Значение-ЯчейкиРасчета["П00900"+i+"_"+Инд].Значение;
					
				КонецЦикла;
				
			КонецЕсли;

		КонецЦикла;

		ЯчейкиРасчета.П0080031.Значение	= ЯчейкиРасчета.П0080032.Значение
										+ ЯчейкиРасчета.П0080033.Значение;

		ЯчейкиРасчета.П0080034.Значение	= ЯчейкиРасчета.П0080035.Значение
										+ ЯчейкиРасчета.П0080036.Значение;

		ЯчейкиРасчета.П0080037.Значение	= ЯчейкиРасчета.П0080038.Значение
										+ ЯчейкиРасчета.П0080039.Значение
										+ ЯчейкиРасчета.П0080040.Значение;

		ЯчейкиРасчета.П0080042.Значение	= ЯчейкиРасчета.П0080043.Значение
										+ ЯчейкиРасчета.П0080044.Значение;

		ЯчейкиРасчета.П0080030.Значение	= ЯчейкиРасчета.П0080031.Значение
										+ ЯчейкиРасчета.П0080034.Значение
										+ ЯчейкиРасчета.П0080037.Значение;

		ЯчейкиРасчета.П0080041.Значение	= ЯчейкиРасчета.П0080042.Значение;

		ЯчейкиРасчета.П0080045.Значение	= ЯчейкиРасчета.П0080030.Значение
										+ ЯчейкиРасчета.П0080041.Значение;

		ЯчейкиРасчета.П0100031.Значение	= ЯчейкиРасчета.П0100032.Значение
										+ ЯчейкиРасчета.П0100033.Значение;

		ЯчейкиРасчета.П0100034.Значение	= ЯчейкиРасчета.П0100035.Значение
										+ ЯчейкиРасчета.П0100036.Значение;

		ЯчейкиРасчета.П0100037.Значение	= ЯчейкиРасчета.П0100038.Значение
										+ ЯчейкиРасчета.П0100039.Значение
										+ ЯчейкиРасчета.П0100040.Значение;

		ЯчейкиРасчета.П0100042.Значение	= ЯчейкиРасчета.П0100043.Значение
										+ ЯчейкиРасчета.П0100044.Значение;

		ЯчейкиРасчета.П0100030.Значение	= ЯчейкиРасчета.П0100031.Значение
										+ ЯчейкиРасчета.П0100034.Значение
										+ ЯчейкиРасчета.П0100037.Значение;

		ЯчейкиРасчета.П0100041.Значение	= ЯчейкиРасчета.П0100042.Значение;

		ЯчейкиРасчета.П0100045.Значение	= ЯчейкиРасчета.П0100030.Значение
										+ ЯчейкиРасчета.П0100041.Значение;

		Для i=30 по 45 цикл
				

			ЯчейкиРасчета["П00900"+i].Значение=?(ЯчейкиРасчета["П0080045"].Значение<>0,(ЯчейкиРасчета["П00800"+i].Значение/ЯчейкиРасчета["П0080045"].Значение)*100,0);
			ЯчейкиРасчета["П01100"+i].Значение=?(ЯчейкиРасчета["П0100045"].Значение<>0,(ЯчейкиРасчета["П01000"+i].Значение/ЯчейкиРасчета["П0100045"].Значение)*100,0);
			ЯчейкиРасчета["П01200"+i].Значение=ЯчейкиРасчета["П01000"+i].Значение-ЯчейкиРасчета["П00800"+i].Значение;
			ЯчейкиРасчета["П01300"+i].Значение=ЯчейкиРасчета["П01100"+i].Значение-ЯчейкиРасчета["П00900"+i].Значение;

			СтрокДетализации=мСтруктураДетали.Получить("00"+i);
			
			Если Не СтрокДетализации=Неопределено Тогда
				
				Для Инд=1 по СтрокДетализации Цикл;
					
					ЯчейкиРасчета["П00900"+i+"_"+Инд].Значение=?(ЯчейкиРасчета["П0080045"].Значение<>0,(ЯчейкиРасчета["П00800"+i+"_"+Инд].Значение/ЯчейкиРасчета["П0080045"].Значение)*100,0);
					ЯчейкиРасчета["П01100"+i+"_"+Инд].Значение=?(ЯчейкиРасчета["П0100045"].Значение<>0,(ЯчейкиРасчета["П01000"+i+"_"+Инд].Значение/ЯчейкиРасчета["П0100045"].Значение)*100,0);
					ЯчейкиРасчета["П01200"+i+"_"+Инд].Значение=ЯчейкиРасчета["П01000"+i+"_"+Инд].Значение-ЯчейкиРасчета["П00800"+i+"_"+Инд].Значение;
					ЯчейкиРасчета["П01300"+i+"_"+Инд].Значение=ЯчейкиРасчета["П01100"+i+"_"+Инд].Значение-ЯчейкиРасчета["П00900"+i+"_"+Инд].Значение;
					
				КонецЦикла;
				
			КонецЕсли;		

		КонецЦикла;
		
		Сходимость=Истина;
		
		РасхождениеНач=ЯчейкиРасчета.П0080029.Значение-ЯчейкиРасчета.П0080045.Значение;
		РасхождениеКон=ЯчейкиРасчета.П0100029.Значение-ЯчейкиРасчета.П0100045.Значение;
		
		Если ?(РасхождениеНач>0,РасхождениеНач,РасхождениеНач*(-1))>1 Тогда
			Сходимость=Ложь;
			ЯчейкиРасчета.П0080010.Значение=ЯчейкиРасчета.П0080029.Значение-ЯчейкиРасчета.П0080045.Значение;
		Иначе
			ЯчейкиРасчета.П0080010.Значение=0;
		КонецЕсли;
		
		Если ?(РасхождениеКон>0,РасхождениеКон,РасхождениеКон*(-1))>1 Тогда
			Сходимость=Ложь;
			ЯчейкиРасчета.П0100010.Значение=ЯчейкиРасчета.П0100029.Значение-ЯчейкиРасчета.П0100045.Значение;
		Иначе
			ЯчейкиРасчета.П0100010.Значение=0;
		КонецЕсли;
		
		Если НЕ Сходимость Тогда
			
			ЯчейкиРасчета.АктивПассив.Значение="Расхождение актива и пассива:";
			
		Иначе
			
			ЯчейкиРасчета.АктивПассив.Значение="";
			
		КонецЕсли;
					
	КонецЕсли;
	
	Если Отчет.ВыводитьПрибылиИУбытки Тогда

		//*************************** Форма 2 ***************************************


		ЯчейкиРасчета.П0100128.Значение	= ЯчейкиРасчета.П0100126.Значение
										- ЯчейкиРасчета.П0100127.Значение;

		ЯчейкиРасчета.П0120128.Значение	= ЯчейкиРасчета.П0120126.Значение
										- ЯчейкиРасчета.П0120127.Значение;

		ЯчейкиРасчета.П0100130.Значение	= ЯчейкиРасчета.П0100128.Значение
										- ЯчейкиРасчета.П0100129.Значение;

		ЯчейкиРасчета.П0120130.Значение	= ЯчейкиРасчета.П0120128.Значение
										- ЯчейкиРасчета.П0120129.Значение;

		ЯчейкиРасчета.П0100133.Значение	= ЯчейкиРасчета.П0100130.Значение
										- ЯчейкиРасчета.П0100131.Значение
										- ЯчейкиРасчета.П0100132.Значение;

		ЯчейкиРасчета.П0120133.Значение	= ЯчейкиРасчета.П0120130.Значение
										- ЯчейкиРасчета.П0120131.Значение
										- ЯчейкиРасчета.П0120132.Значение;

		ЯчейкиРасчета.П0100140.Значение	= ЯчейкиРасчета.П0100135.Значение
										- ЯчейкиРасчета.П0100136.Значение
										+ ЯчейкиРасчета.П0100137.Значение
										+ ЯчейкиРасчета.П0100138.Значение
										- ЯчейкиРасчета.П0100139.Значение;

		ЯчейкиРасчета.П0120140.Значение	= ЯчейкиРасчета.П0120135.Значение
										- ЯчейкиРасчета.П0120136.Значение
										+ ЯчейкиРасчета.П0120137.Значение
										+ ЯчейкиРасчета.П0120138.Значение
										- ЯчейкиРасчета.П0120139.Значение;

		ЯчейкиРасчета.П0100141.Значение	= ЯчейкиРасчета.П0100133.Значение
										+ ЯчейкиРасчета.П0100140.Значение;

		ЯчейкиРасчета.П0120141.Значение	= ЯчейкиРасчета.П0120133.Значение
										+ ЯчейкиРасчета.П0120140.Значение;

		ЯчейкиРасчета.П0100145.Значение	= ЯчейкиРасчета.П0100143.Значение
										- ЯчейкиРасчета.П0100144.Значение;

		ЯчейкиРасчета.П0120145.Значение	= ЯчейкиРасчета.П0120143.Значение
										- ЯчейкиРасчета.П0120144.Значение;


		ЯчейкиРасчета.П0100146.Значение	= ЯчейкиРасчета.П0100141.Значение
										+ ЯчейкиРасчета.П0100145.Значение;

		ЯчейкиРасчета.П0120146.Значение	= ЯчейкиРасчета.П0120141.Значение
										+ ЯчейкиРасчета.П0120145.Значение;

		ЯчейкиРасчета.П0100148.Значение	= ЯчейкиРасчета.П0100146.Значение
										- ЯчейкиРасчета.П0100147.Значение;

		ЯчейкиРасчета.П0120148.Значение	= ЯчейкиРасчета.П0120146.Значение
										- ЯчейкиРасчета.П0120147.Значение;

		ЯчейкиРасчета.П0100152.Значение	= ЯчейкиРасчета.П0100150.Значение
										- ЯчейкиРасчета.П0100151.Значение;

		ЯчейкиРасчета.П0120152.Значение	= ЯчейкиРасчета.П0120150.Значение
										- ЯчейкиРасчета.П0120151.Значение;

		ЯчейкиРасчета.П0100154.Значение	= ЯчейкиРасчета.П0100148.Значение
										+ ЯчейкиРасчета.П0100152.Значение;

		ЯчейкиРасчета.П0120154.Значение	= ЯчейкиРасчета.П0120148.Значение
										+ ЯчейкиРасчета.П0120152.Значение;

		ЯчейкиРасчета.П0100156.Значение	= ЯчейкиРасчета.П0100154.Значение
										- ЯчейкиРасчета.П0100155.Значение;

		ЯчейкиРасчета.П0120156.Значение	= ЯчейкиРасчета.П0120154.Значение
										- ЯчейкиРасчета.П0120155.Значение;	
	КонецЕсли;
								
	Если Отчет.АнализЛиквидностиИПлатежеспособности И Сходимость Тогда 	

		//*************** таблица 2 *****************************************************

		ЯчейкиРасчета.П0050054.Значение	= ЯчейкиРасчета.П0080014.Значение;
		ЯчейкиРасчета.П0050055.Значение	= ЯчейкиРасчета.П0080017.Значение;
		ЯчейкиРасчета.П0050056.Значение	= ЯчейкиРасчета.П0080020.Значение;
		ЯчейкиРасчета.П0050057.Значение	= ЯчейкиРасчета.П0080026.Значение;

		ЯчейкиРасчета.П0060054.Значение	= ЯчейкиРасчета.П0100014.Значение;
		ЯчейкиРасчета.П0060055.Значение	= ЯчейкиРасчета.П0100017.Значение;	
		ЯчейкиРасчета.П0060056.Значение	= ЯчейкиРасчета.П0100020.Значение;	
		ЯчейкиРасчета.П0060057.Значение	= ЯчейкиРасчета.П0100026.Значение;	 

		ЯчейкиРасчета.П0080054.Значение	= ЯчейкиРасчета.П0080031.Значение;	
		ЯчейкиРасчета.П0080055.Значение	= ЯчейкиРасчета.П0080034.Значение;	
		ЯчейкиРасчета.П0080056.Значение	= ЯчейкиРасчета.П0080037.Значение;	
		ЯчейкиРасчета.П0080057.Значение	= ЯчейкиРасчета.П0080042.Значение;	 

		ЯчейкиРасчета.П0090054.Значение	= ЯчейкиРасчета.П0100031.Значение;	
		ЯчейкиРасчета.П0090055.Значение	= ЯчейкиРасчета.П0100034.Значение;	
		ЯчейкиРасчета.П0090056.Значение	= ЯчейкиРасчета.П0100037.Значение;	
		ЯчейкиРасчета.П0090057.Значение	= ЯчейкиРасчета.П0100042.Значение;	

		Для i = 54 по 57 цикл
			
			ЯчейкиРасчета["П01000"+i].Значение=ЯчейкиРасчета["П00500"+i].Значение-ЯчейкиРасчета["П00800"+i].Значение;
			ЯчейкиРасчета["П01100"+i].Значение=ЯчейкиРасчета["П00600"+i].Значение-ЯчейкиРасчета["П00900"+i].Значение;
			ЯчейкиРасчета["П01200"+i].Значение=?(ЯчейкиРасчета["П00800"+i].Значение<>0,(ЯчейкиРасчета["П00500"+i].Значение/ЯчейкиРасчета["П00800"+i].Значение)*100,0);
			ЯчейкиРасчета["П01300"+i].Значение=?(ЯчейкиРасчета["П00900"+i].Значение<>0,(ЯчейкиРасчета["П00600"+i].Значение/ЯчейкиРасчета["П00900"+i].Значение)*100,0);

		КонецЦикла;

		ЯчейкиРасчета.П0070068.Значение	= (ЯчейкиРасчета.П0050054.Значение+ЯчейкиРасчета.П0050055.Значение)
										-(ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение);

		ЯчейкиРасчета.П0090068.Значение	= (ЯчейкиРасчета.П0060054.Значение+ЯчейкиРасчета.П0060055.Значение)
										-(ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение);

		ЯчейкиРасчета.П0110068.Значение	= ЯчейкиРасчета.П0090068.Значение
										- ЯчейкиРасчета.П0070068.Значение;

		ЯчейкиРасчета.П0070073.Значение	= ЯчейкиРасчета.П0050056.Значение
										- ЯчейкиРасчета.П0080056.Значение;

		ЯчейкиРасчета.П0090073.Значение	= ЯчейкиРасчета.П0060056.Значение
										- ЯчейкиРасчета.П0090056.Значение;

		ЯчейкиРасчета.П0110073.Значение	= ЯчейкиРасчета.П0090073.Значение
										- ЯчейкиРасчета.П0070073.Значение;

		//*************** таблица 3 ***************************************************** 

		ЯчейкиРасчета.П0110078.Значение	=?((ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение)<>0,
										ЯчейкиРасчета.П0050054.Значение /(ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение)
										,0);

		ЯчейкиРасчета.П0120078.Значение	=?((ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение)<>0,
										ЯчейкиРасчета.П0060054.Значение/(ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение)
										,0);

		ЯчейкиРасчета.П0110079.Значение	=?((ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение)<>0,
										(ЯчейкиРасчета.П0050054.Значение+ЯчейкиРасчета.П0050055.Значение)
										/(ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение)
										,0);

		ЯчейкиРасчета.П0120079.Значение	=?((ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение)<>0,
										(ЯчейкиРасчета.П0060054.Значение+ЯчейкиРасчета.П0060055.Значение)
										/(ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение)
										,0);

		ЯчейкиРасчета.П0110080.Значение	=?((ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение)<>0,
										(ЯчейкиРасчета.П0050054.Значение+ЯчейкиРасчета.П0050055.Значение+ЯчейкиРасчета.П0050056.Значение)
										/(ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение)
										,0);

		ЯчейкиРасчета.П0120080.Значение	=?((ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение)<>0,
										(ЯчейкиРасчета.П0060054.Значение+ЯчейкиРасчета.П0060055.Значение+ЯчейкиРасчета.П0060056.Значение)
										/(ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение)
										,0);

		ЯчейкиРасчета.П0110081.Значение	=(ЯчейкиРасчета.П0050054.Значение+ЯчейкиРасчета.П0050055.Значение+ЯчейкиРасчета.П0050056.Значение)
										-(ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение);

		ЯчейкиРасчета.П0120081.Значение	=(ЯчейкиРасчета.П0060054.Значение+ЯчейкиРасчета.П0060055.Значение+ЯчейкиРасчета.П0060056.Значение)
										-(ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение);

		ЯчейкиРасчета.П0110082.Значение	=(ЯчейкиРасчета.П0080056.Значение+ЯчейкиРасчета.П0080057.Значение)
										-ЯчейкиРасчета.П0050057.Значение;

		ЯчейкиРасчета.П0120082.Значение	=(ЯчейкиРасчета.П0090056.Значение+ЯчейкиРасчета.П0090057.Значение)
										-ЯчейкиРасчета.П0060057.Значение;

		ЯчейкиРасчета.П0110083.Значение	=?(ЯчейкиРасчета.П0110082.Значение<>0,
										ЯчейкиРасчета.П0050056.Значение/ЯчейкиРасчета.П0110082.Значение
										,0);

		ЯчейкиРасчета.П0120083.Значение	=?(ЯчейкиРасчета.П0120082.Значение<>0,
										ЯчейкиРасчета.П0060056.Значение/ЯчейкиРасчета.П0120082.Значение
										,0);

		ЯчейкиРасчета.П0110084.Значение	=?((ЯчейкиРасчета.П0050054.Значение+ЯчейкиРасчета.П0050055.Значение+ЯчейкиРасчета.П0050056.Значение)<>0,
										ЯчейкиРасчета.П0110082.Значение/
										(ЯчейкиРасчета.П0050054.Значение+ЯчейкиРасчета.П0050055.Значение+ЯчейкиРасчета.П0050056.Значение)
										,0);

		ЯчейкиРасчета.П0120084.Значение	=?((ЯчейкиРасчета.П0060054.Значение+ЯчейкиРасчета.П0060055.Значение+ЯчейкиРасчета.П0060056.Значение)<>0,
										ЯчейкиРасчета.П0120082.Значение
										/(ЯчейкиРасчета.П0060054.Значение+ЯчейкиРасчета.П0060055.Значение+ЯчейкиРасчета.П0060056.Значение),0); 

		Для i = 78 по 84 цикл
			
			ЯчейкиРасчета["П01300"+i].Значение=ЯчейкиРасчета["П01200"+i].Значение-ЯчейкиРасчета["П01100"+i].Значение;

		КонецЦикла;

		ПолныхМесяцев=фин_УправлениеБюджетированием.РассчитатьКоличествоПериодов(Отчет.ДатаНач,Отчет.ДатаКон,Перечисления.фин_Периодичность.Месяц);

		Если ПолныхМесяцев > 0 Тогда
			
			ЯчейкиРасчета.П0120085.Значение	= (ЯчейкиРасчета.П0120080.Значение
											+ (ЯчейкиРасчета.П0120080.Значение-ЯчейкиРасчета.П0110080.Значение)
											* (6/ПолныхМесяцев))/2;
			ЯчейкиРасчета.П0120086.Значение	= (ЯчейкиРасчета.П0120080.Значение
											+ (ЯчейкиРасчета.П0120080.Значение-ЯчейкиРасчета.П0110080.Значение)
											* (3/ПолныхМесяцев))/2; 
			
		КонецЕсли;

		Текст1=" ";

		Если (ЯчейкиРасчета.П0120080.Значение>=1) и (ЯчейкиРасчета.П0120084.Значение>=0.1) Тогда
			
			
			Текст1=Текст1+"      Коэффициент текущей ликвидности превышает минимально возможный на "+Формат(ЯчейкиРасчета.П0120080.Значение-1,"ЧДЦ=2")+".";
			Текст1=Текст1+" Коэффициент обеспеченности собственным оборотным капиталом превышает минимально возможный на "+Формат(ЯчейкиРасчета.П0120084.Значение-0.1,"ЧДЦ=2")+".";
			Текст1=Текст1+" Это говорит о удовлетворительной структуре активов и пассивов и платежеспособности организации."; 
			
			Если ЯчейкиРасчета.П0120086.Значение < 1 Тогда
				
				Текст1=Текст1+Символы.ПС+"      Тем не менее, значение коэффициента утраты платежеспособности "+Формат(ЯчейкиРасчета.П0120086.Значение,"ЧДЦ=2")+ ", рассчитанное на период 3 месяца,";
				Текст1=Текст1+" свидетельствует о том, что в ближайшее время предприятие может утратить возможность выполнять свои обязательства перед кредиторами.";
			
			КонецЕсли;
				
		ИначеЕсли (ЯчейкиРасчета.П0120080.Значение<1) или (ЯчейкиРасчета.П0120084.Значение<0.1) Тогда
		    
			Если (ЯчейкиРасчета.П0120080.Значение<1) Тогда
				
				Текст1=Текст1+"      Коэффициент текущей ликвидности меньше минимально возможного на "+Формат((1-ЯчейкиРасчета.П0120080.Значение),"ЧДЦ=2")+".";
				Текст1=Текст1+" Это говорит о высоком финансовом риске, связанном с тем, что организация не в состоянии оплатить свои счета. ";
				Текст1=Текст1+" Принимая во внимание различную степень ликвидности активов, притом, что большая часть активов предприятия размещена в ";
				
				Если Макс(ЯчейкиРасчета.П0060054.Значение,
					ЯчейкиРасчета.П0060055.Значение,
					ЯчейкиРасчета.П0060056.Значение,
					ЯчейкиРасчета.П0060057.Значение)=ЯчейкиРасчета.П0060054.Значение Тогда
					
					ТекстАктив=" активах абсолютной ликвидности";
				
				ИначеЕсли Макс(ЯчейкиРасчета.П0060054.Значение,
					ЯчейкиРасчета.П0060055.Значение,
					ЯчейкиРасчета.П0060056.Значение,
					ЯчейкиРасчета.П0060057.Значение)=ЯчейкиРасчета.П0060055.Значение Тогда 
					
					ТекстАктив=" активах высокой ликвидности";
					
				ИначеЕсли Макс(ЯчейкиРасчета.П0060054.Значение,
					ЯчейкиРасчета.П0060055.Значение,
					ЯчейкиРасчета.П0060056.Значение,
					ЯчейкиРасчета.П0060057.Значение)=ЯчейкиРасчета.П0060056.Значение Тогда 
					
					ТекстАктив=" активах продолжительной ликвидности";
				
				ИначеЕсли Макс(ЯчейкиРасчета.П0060054.Значение,
					ЯчейкиРасчета.П0060055.Значение,
					ЯчейкиРасчета.П0060056.Значение,
					ЯчейкиРасчета.П0060057.Значение)=ЯчейкиРасчета.П0060057.Значение Тогда 
					
					ТекстАктив=" активах низкой ликвидности";	
				
				КонецЕсли;
					
				Текст1=Текст1+ТекстАктив+",можно предположить, что не все активы могут быть реализованы в срочном порядке, а следовательно,"; 
		 
		 		Текст1=Текст1+"возникнет угроза финансовой стабильности организации."; 
		 	
		 	КонецЕсли;
		 	
		 	Если (ЯчейкиРасчета.П0120084.Значение<0.1) Тогда
		 		 
		 		Текст1=Текст1+"      Коэффициент обеспеченности собственным оборотным капиталом меньше минимально возможного на "+Формат(0.1-ЯчейкиРасчета.П0120084.Значение,"ЧДЦ=2")+".";
		 		Текст1=Текст1+" Это говорит о том, что оборотные средства предприятия практически не подкреплены свободными собственными и приравненными";
		 		Текст1=Текст1+" к ним средствами, а формируются целиком за счет заемных источников. В такой ситуации, предприятие является финансово неустойчивым.";
		 		
		 	КонецЕсли;
		 	
		 	Текст1=Текст1+" Из вышесказанного, можно сделать заключение о неудовлетворительной структуре активов и пассивов и платежеспособности организации.";
		 		
		 		Если ЯчейкиРасчета.П0120085.Значение>=1 Тогда
		 			
		 			Текст1=Текст1+"      Тем не менее, значение коэффициента восстановления платежеспособности "+Формат(ЯчейкиРасчета.П0120085.Значение,"ЧДЦ=2")+", рассчитанного на период 6 месяцев, свидетельствует";
		 			Текст1=Текст1+" о реальной возможности для предприятия восстановить свою платежеспособность";
		 		
		 		ИначеЕсли ЯчейкиРасчета.П0120085.Значение<1 Тогда
		 			
		 	        Текст1=Текст1+" Значение коэффициента восстановления платежеспособности "+Формат(ЯчейкиРасчета.П0120085.Значение,"ЧДЦ=2")+", рассчитанного на период 6 месяцев, свидетельствует";
		 			Текст1=Текст1+" о том, что у предприятия нет возможности в ближайшее время восстановить свою платежеспособность.";
		 			
		 		КонецЕсли;
			КонецЕсли;
					
		ЯчейкиРасчета.Текст1.Значение=Текст1;
		 	
		//************************* Таблица 4 *******************************

		ЯчейкиРасчета.П0110104.Значение	= ЯчейкиРасчета.П0080056.Значение
										+ ЯчейкиРасчета.П0080057.Значение
										- ЯчейкиРасчета.П0050057.Значение;

		ЯчейкиРасчета.П0120104.Значение	= ЯчейкиРасчета.П0090056.Значение
										+ ЯчейкиРасчета.П0090057.Значение
										- ЯчейкиРасчета.П0060057.Значение;

		ЯчейкиРасчета.П0110105.Значение	= ЯчейкиРасчета.П0080054.Значение
										+ ЯчейкиРасчета.П0080055.Значение
										+ ЯчейкиРасчета.П0080056.Значение
										+ ЯчейкиРасчета.П0080057.Значение
										- ЯчейкиРасчета.П0050057.Значение;

		ЯчейкиРасчета.П0120105.Значение	= ЯчейкиРасчета.П0090054.Значение
										+ ЯчейкиРасчета.П0090055.Значение
										+ ЯчейкиРасчета.П0090056.Значение
										+ ЯчейкиРасчета.П0090057.Значение
										- ЯчейкиРасчета.П0060057.Значение;

		ЯчейкиРасчета.П0110106.Значение	= ЯчейкиРасчета.П0080021.Значение
										+ ЯчейкиРасчета.П0080022.Значение
										+ ЯчейкиРасчета.П0080023.Значение;

		ЯчейкиРасчета.П0120106.Значение	= ЯчейкиРасчета.П0100021.Значение
										+ ЯчейкиРасчета.П0100022.Значение
										+ ЯчейкиРасчета.П0100023.Значение; 

		ЯчейкиРасчета.П0110107.Значение	= ЯчейкиРасчета.П0110104.Значение
										- ЯчейкиРасчета.П0110106.Значение;

		ЯчейкиРасчета.П0120107.Значение	= ЯчейкиРасчета.П0120104.Значение
										- ЯчейкиРасчета.П0120106.Значение;

		ЯчейкиРасчета.П0110108.Значение	= ЯчейкиРасчета.П0110105.Значение
										- ЯчейкиРасчета.П0110106.Значение;

		ЯчейкиРасчета.П0120108.Значение	= ЯчейкиРасчета.П0120105.Значение
										- ЯчейкиРасчета.П0120106.Значение;

		ЯчейкиРасчета.П0110109.Значение	= ?(ЯчейкиРасчета.П0080057.Значение<>0,
										( ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение+ЯчейкиРасчета.П0080056.Значение)
										/ ЯчейкиРасчета.П0080057.Значение,0);

		ЯчейкиРасчета.П0120109.Значение	= ?(ЯчейкиРасчета.П0090057.Значение<>0,
										( ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение+ЯчейкиРасчета.П0090056.Значение)
										/ ЯчейкиРасчета.П0090057.Значение,0); 

		ЯчейкиРасчета.П0110110.Значение	= ?(ЯчейкиРасчета.П0080045.Значение<>0,ЯчейкиРасчета.П0080057.Значение
										/ ЯчейкиРасчета.П0080045.Значение,0);

		ЯчейкиРасчета.П0120110.Значение	= ?(ЯчейкиРасчета.П0100045.Значение<>0,
										  ЯчейкиРасчета.П0090057.Значение
										/ ЯчейкиРасчета.П0100045.Значение,0); 

		ЯчейкиРасчета.П0110111.Значение	= ?(ЯчейкиРасчета.П0110106.Значение<>0,
										( ЯчейкиРасчета.П0080057.Значение-ЯчейкиРасчета.П0050057.Значение)
										/ ЯчейкиРасчета.П0110106.Значение,0);

		ЯчейкиРасчета.П0120111.Значение	= ?(ЯчейкиРасчета.П0120106.Значение<>0,
										( ЯчейкиРасчета.П0090057.Значение-ЯчейкиРасчета.П0060057.Значение)
										/ ЯчейкиРасчета.П0120106.Значение,0); 

		ЯчейкиРасчета.П0110112.Значение	= ?((ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение+ЯчейкиРасчета.П0080056.Значение)<>0,
										   ЯчейкиРасчета.П0080057.Значение
										/ (ЯчейкиРасчета.П0080054.Значение+ЯчейкиРасчета.П0080055.Значение+ЯчейкиРасчета.П0080056.Значение),0);

		ЯчейкиРасчета.П0120112.Значение	= ?((ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение+ЯчейкиРасчета.П0090056.Значение)<>0,
										   ЯчейкиРасчета.П0090057.Значение
										/ (ЯчейкиРасчета.П0090054.Значение+ЯчейкиРасчета.П0090055.Значение+ЯчейкиРасчета.П0090056.Значение),0);

		ЯчейкиРасчета.П0110113.Значение	= ?(ЯчейкиРасчета.П0080045.Значение<>0,
										  (ЯчейкиРасчета.П0080056.Значение+ЯчейкиРасчета.П0080057.Значение)
										/  ЯчейкиРасчета.П0080045.Значение,0);

		ЯчейкиРасчета.П0120113.Значение	= ?(ЯчейкиРасчета.П0100045.Значение<>0,
										( ЯчейкиРасчета.П0090056.Значение+ЯчейкиРасчета.П0090057.Значение)
										/ ЯчейкиРасчета.П0100045.Значение,0); 

		Для i = 104 по 113 цикл
			
			ЯчейкиРасчета["П0130"+i].Значение=ЯчейкиРасчета["П0120"+i].Значение-ЯчейкиРасчета["П0110"+i].Значение;

		КонецЦикла;

		Текст2="     По абсолютным показателям финансовой устойчивости,";
			
		ТекстАбсГруппа1=" финансовое положение предприятия устойчиво. Предприятие практически не нуждается в краткосрочном кредитовании. Собственные средства и приравненные к ним долгосрочные заемные средства";
		ТекстАбсГруппа1=ТекстАбсГруппа1+" полностью покрывают запасы и затраты. Текущие активы превышают кредиторскую задолженность.";
		ТекстАбсГруппа2=" финансовое положение предприятия неустойчивое, сопряженное с нарушением платежеспособности. предприятие вынуждено привлекать дополнительные источники покрытия запасов и затрат,";
		ТекстАбсГруппа2=ТекстАбсГруппа2+" наблюдается снижение доходности производства. Тем не менее, еще имеются возможности для  восстановления равновесия за счет пополнения";
		ТекстАбсГруппа2=ТекстАбсГруппа2+" источников собственных средств за счет сокращения дебиторской задолженности, ускорения оборачиваемости запасов."; 
		ТекстАбсГруппа3=" предприятие находится в состоянии финансового кризиса. Денежные средства, краткосрочные ценные бумаги и дебиторская задолженность не покрывают";
		ТекстАбсГруппа3=ТекстАбсГруппа3+" даже текущую кредиторскую задолженность. При неоднократном повторении подобной ситуации, может возникнуть вопрос о банкротстве предприятия";

		Если (ЯчейкиРасчета.П0110107.Значение>=0) и (ЯчейкиРасчета.П0110108.Значение>=0) Тогда
			ТипАбс1=1;
			Текст2=Текст2+" на начало периода"+ТекстАбсГруппа1;
		ИначеЕсли (ЯчейкиРасчета.П0110107.Значение<0) и (ЯчейкиРасчета.П0110108.Значение>=0) Тогда
			ТипАбс1=2;
			Текст2=Текст2+" на начало периода"+ТекстАбсГруппа2;
		ИначеЕсли (ЯчейкиРасчета.П0110107.Значение<0) и (ЯчейкиРасчета.П0110108.Значение<0) Тогда
			ТипАбс1=3;
			Текст2=Текст2+" на начало периода"+ТекстАбсГруппа3;
		КонецЕсли;

		Если (ЯчейкиРасчета.П0120107.Значение>=0) и (ЯчейкиРасчета.П0120108.Значение>=0) Тогда
			ТипАбс2=1;
			Текст3=ТекстАбсГруппа1;
		ИначеЕсли (ЯчейкиРасчета.П0120107.Значение<0) и (ЯчейкиРасчета.П0120108.Значение>=0) Тогда
			ТипАбс2=2;
			Текст3=ТекстАбсГруппа2;
		ИначеЕсли (ЯчейкиРасчета.П0120107.Значение<0) и (ЯчейкиРасчета.П0120108.Значение<0) Тогда
			ТипАбс2=3;
			Текст3=ТекстАбсГруппа3;
		КонецЕсли;

		Если ТипАбс1=ТипАбс2 Тогда
			Текст3=" финансовое положение предприятия существенно не изменилось.";
		КонецЕсли;
		Текст2=Текст2+" На конец периода,"+Текст3;     


		Текст2=Текст2+Символы.ПС+"     По интегральной методике оценки финансовой устойчивости предприятия,";

		ТекстИнт1=" организация относится к первому классу финансовой устойчивости.";
		ТекстИнт1=ТекстИнт1+" В этот класс входят предприятия, чьи кредиты и обязательства подкреплены информацией, позволяющей быть уверенными в возврате кредитов и выполнении";
		ТекстИнт1=ТекстИнт1+" других обязательств в соответствии с договорами с хорошим запасом на возможную ошибку.";
		ТекстИнт2=" организация относится ко второму классу финансовой устойчивости.";
		ТекстИнт2=ТекстИнт2+" В этот класс входят предприятия, демонстрирующие некоторый уровень риска по задолженности и обязательствам и обнаруживающие определенную слабость";
		ТекстИнт2=ТекстИнт2+" финансовых показателей и кредитоспособности. Эти организации еще не рассматриваются как рискованные.";
		ТекстИнт3=" организация относится к третьему классу финансовой устойчивости.";
		ТекстИнт3=ТекстИнт3+" В этот класс входят проблемные предприятия. Вряд ли существует угроза потери средств, но полное получение процентов, выполнение обязательств представляется сомнительным."; 
		ТекстИнт4=" организация относится к четвертому классу финансовой устойчивости.";
		ТекстИнт4=ТекстИнт4+" В этот класс входят предприятия особого внимания, т.к. имеется риск при взаимоотношениях с ними. Организации, которые могут потерять средства и проценты даже";
		ТекстИнт4=ТекстИнт4+" после принятия мер к оздоровлению бизнеса.";
		ТекстИнт5=" организация относится к пятому классу финансовой устойчивости.";
		ТекстИнт5=ТекстИнт5+" В этот класс входят предприятия высочайшего риска, практически неплатежеспособные."; 

		ТипИнтНачало=РасчетПоИнтегральнойМетодике(ЯчейкиРасчета.П0110078.Значение,
																ЯчейкиРасчета.П0110079.Значение,
																ЯчейкиРасчета.П0110080.Значение,
																ЯчейкиРасчета.П0110110.Значение,
																ЯчейкиРасчета.П0110084.Значение,
																ЯчейкиРасчета.П0110111.Значение);
		ТипИнтКонец=РасчетПоИнтегральнойМетодике(ЯчейкиРасчета.П0120078.Значение,
																ЯчейкиРасчета.П0120079.Значение,
																ЯчейкиРасчета.П0120080.Значение,
																ЯчейкиРасчета.П0120110.Значение,
																ЯчейкиРасчета.П0120084.Значение,
																ЯчейкиРасчета.П0120111.Значение); 

		Если ТипИнтНачало=1 Тогда
			Текст2=Текст2+" на начало периода,"+ТекстИнт1;
		ИначеЕсли ТипИнтНачало=2 Тогда 
			Текст2=Текст2+" на начало периода,"+ТекстИнт2;
		ИначеЕсли ТипИнтНачало=3 Тогда 
			Текст2=Текст2+" на начало периода,"+ТекстИнт3;
		ИначеЕсли ТипИнтНачало=4 Тогда 
			Текст2=Текст2+" на начало периода,"+ТекстИнт4;
		ИначеЕсли ТипИнтНачало=5 Тогда 
			Текст2=Текст2+" на начало периода,"+ТекстИнт5;
		КонецЕсли;

		Текст2=Текст2+"На конец периода,";

		Если ТипИнтНачало=ТипИнтКонец Тогда
			Текст2=Текст2+" финансовое положение предприятия существенно не изменилось.";
		Иначе
			Если ТипИнтКонец=1 Тогда
				Текст2=Текст2+ТекстИнт1;
			ИначеЕсли ТипИнтКонец=2 Тогда 
				Текст2=Текст2+ТекстИнт2;
			ИначеЕсли ТипИнтКонец=3 Тогда 
				Текст2=Текст2+ТекстИнт3;
			ИначеЕсли ТипИнтКонец=4 Тогда 
				Текст2=Текст2+ТекстИнт4;
			ИначеЕсли ТипИнтКонец=5 Тогда 
				Текст2=Текст2+ТекстИнт5;
			КонецЕсли;
			
		КонецЕсли;
		
		ЯчейкиРасчета.Текст2.Значение=Текст2;
		
	КонецЕсли;
	
	Если Отчет.АнализОборачиваемости Тогда

		//*********************** Таблица 6 ************************************


		ДнейВПериоде=Окр((Отчет.ДатаКон-Отчет.ДатаНач)/86400,0);
		РеализацияТек=ЯчейкиРасчета.П0100126.Значение;

		ЯчейкиРасчета.П0090162.Значение	=?((ЯчейкиРасчета.П0100029.Значение+ЯчейкиРасчета.П0080029.Значение)<>0,
										РеализацияТек*2
										/(ЯчейкиРасчета.П0100029.Значение+ЯчейкиРасчета.П0080029.Значение),0);

		ЯчейкиРасчета.П0110162.Значение	=?(ЯчейкиРасчета.П0090162.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090162.Значение,0);

		ЯчейкиРасчета.П0090163.Значение	=?((ЯчейкиРасчета.П0100029.Значение
										-ЯчейкиРасчета.П0100026.Значение
										+ЯчейкиРасчета.П0080029.Значение
										-ЯчейкиРасчета.П0080026.Значение)<>0,
										РеализацияТек*2
										/(ЯчейкиРасчета.П0100029.Значение
										-ЯчейкиРасчета.П0100026.Значение
										+ЯчейкиРасчета.П0080029.Значение
										-ЯчейкиРасчета.П0080026.Значение),0);

		ЯчейкиРасчета.П0110163.Значение	=?(ЯчейкиРасчета.П0090163.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090163.Значение,0);

		ЯчейкиРасчета.П0090164.Значение	=?((ЯчейкиРасчета.П0080014.Значение
										+ЯчейкиРасчета.П0080017.Значение
										+ЯчейкиРасчета.П0100014.Значение
										+ЯчейкиРасчета.П0100017.Значение)<>0,
										РеализацияТек*2
										/(ЯчейкиРасчета.П0080014.Значение
										+ЯчейкиРасчета.П0080017.Значение
										+ЯчейкиРасчета.П0100014.Значение
										+ЯчейкиРасчета.П0100017.Значение),0);

		ЯчейкиРасчета.П0110164.Значение	=?(ЯчейкиРасчета.П0090164.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090164.Значение,0);

		ЯчейкиРасчета.П0090165.Значение	=?((ЯчейкиРасчета.П0080014.Значение+ЯчейкиРасчета.П0100014.Значение)<>0,
										РеализацияТек*2
										/(ЯчейкиРасчета.П0080014.Значение+ЯчейкиРасчета.П0100014.Значение),0);

		ЯчейкиРасчета.П0110165.Значение	=?(ЯчейкиРасчета.П0090165.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090165.Значение,0);

		ЯчейкиРасчета.П0090165.Значение	=?((ЯчейкиРасчета.П0080014.Значение+ЯчейкиРасчета.П0100014.Значение)<>0,
										РеализацияТек*2/(ЯчейкиРасчета.П0080014.Значение+ЯчейкиРасчета.П0100014.Значение),0);

		ЯчейкиРасчета.П0110165.Значение	=?(ЯчейкиРасчета.П0090165.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090165.Значение,0);

		ЯчейкиРасчета.П0090166.Значение	=?((ЯчейкиРасчета.П0080021.Значение+ЯчейкиРасчета.П0100021.Значение)<>0,
										РеализацияТек*2/(ЯчейкиРасчета.П0080021.Значение+ЯчейкиРасчета.П0100021.Значение),0);

		ЯчейкиРасчета.П0110166.Значение	=?(ЯчейкиРасчета.П0090166.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090166.Значение,0);

		ЯчейкиРасчета.П0090167.Значение	=?((ЯчейкиРасчета.П0080022.Значение+ЯчейкиРасчета.П0100022.Значение)<>0,
										РеализацияТек*2/(ЯчейкиРасчета.П0080022.Значение+ЯчейкиРасчета.П0100022.Значение),0);

		ЯчейкиРасчета.П0110167.Значение	=?(ЯчейкиРасчета.П0090167.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090167.Значение,0);

		ЯчейкиРасчета.П0090170.Значение	=?((ЯчейкиРасчета.П0080018.Значение+ЯчейкиРасчета.П0100018.Значение)<>0,
										РеализацияТек*2
										/(ЯчейкиРасчета.П0080018.Значение+ЯчейкиРасчета.П0100018.Значение),0);

		ЯчейкиРасчета.П0110170.Значение	=?(ЯчейкиРасчета.П0090170.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090170.Значение,0);

		ЯчейкиРасчета.П0090171.Значение	=?((ЯчейкиРасчета.П0080031.Значение
										+ЯчейкиРасчета.П0080034.Значение
										+ЯчейкиРасчета.П0100031.Значение
										+ЯчейкиРасчета.П0100034.Значение)<>0,
										РеализацияТек*2
										/(ЯчейкиРасчета.П0080031.Значение
										+ЯчейкиРасчета.П0080034.Значение
										+ЯчейкиРасчета.П0100031.Значение
										+ЯчейкиРасчета.П0100034.Значение),0);

		ЯчейкиРасчета.П0110171.Значение	=?(ЯчейкиРасчета.П0090171.Значение<>0,
										ДнейВПериоде/ЯчейкиРасчета.П0090171.Значение,0);

		ЯчейкиРасчета.П0090172.Значение	=?((ЯчейкиРасчета.П0080042.Значение
										+ЯчейкиРасчета.П0080037.Значение
										-ЯчейкиРасчета.П0080026.Значение
										+ЯчейкиРасчета.П0100042.Значение
										+ЯчейкиРасчета.П0100037.Значение
										-ЯчейкиРасчета.П0100026.Значение)<>0,
										РеализацияТек*2
										/(ЯчейкиРасчета.П0080042.Значение
										+ЯчейкиРасчета.П0080037.Значение
										-ЯчейкиРасчета.П0080026.Значение
										+ЯчейкиРасчета.П0100042.Значение
										+ЯчейкиРасчета.П0100037.Значение
										-ЯчейкиРасчета.П0100026.Значение),0);

		ЯчейкиРасчета.П0110172.Значение	=?(ЯчейкиРасчета.П0090172.Значение<>0,ДнейВПериоде/ЯчейкиРасчета.П0090172.Значение,0);

		ЯчейкиРасчета.П0100176.Значение	=ЯчейкиРасчета.П0110166.Значение+ЯчейкиРасчета.П0110167.Значение+ЯчейкиРасчета.П0110170.Значение;

		ЯчейкиРасчета.П0100180.Значение	=ЯчейкиРасчета.П0100176.Значение-ЯчейкиРасчета.П0110171.Значение; 
		
	КонецЕсли;
	
	Если Отчет.АнализДоходностиИРентабельности Тогда
	
		//*********************** Таблицы 7,8 **************************************


		ЯчейкиРасчета.П0080190.Значение	= ЯчейкиРасчета.П0100126.Значение;
		ЯчейкиРасчета.П0080191.Значение	= ЯчейкиРасчета.П0100127.Значение;
		ЯчейкиРасчета.П0080192.Значение	= ЯчейкиРасчета.П0100128.Значение;
		ЯчейкиРасчета.П0080193.Значение	= ЯчейкиРасчета.П0100129.Значение;
		ЯчейкиРасчета.П0080194.Значение	= ЯчейкиРасчета.П0100130.Значение;
		ЯчейкиРасчета.П0080195.Значение	= ЯчейкиРасчета.П0100131.Значение;
		ЯчейкиРасчета.П0080196.Значение	= ЯчейкиРасчета.П0100132.Значение;

		ЯчейкиРасчета.П0080197.Значение	= ЯчейкиРасчета.П0100127.Значение
										+ ЯчейкиРасчета.П0100129.Значение
										+ ЯчейкиРасчета.П0100131.Значение
										+ ЯчейкиРасчета.П0100132.Значение;

		ЯчейкиРасчета.П0080198.Значение	= ЯчейкиРасчета.П0100133.Значение;
		ЯчейкиРасчета.П0080199.Значение	= ЯчейкиРасчета.П0100136.Значение;
		ЯчейкиРасчета.П0080200.Значение	= ЯчейкиРасчета.П0100146.Значение;
		ЯчейкиРасчета.П0080201.Значение	= ЯчейкиРасчета.П0100148.Значение;
		ЯчейкиРасчета.П0080202.Значение	= ЯчейкиРасчета.П0100154.Значение;
		ЯчейкиРасчета.П0080203.Значение	= ЯчейкиРасчета.П0100155.Значение;
		ЯчейкиРасчета.П0080204.Значение	= ЯчейкиРасчета.П0100156.Значение;

		ЯчейкиРасчета.П0090190.Значение	= ЯчейкиРасчета.П0120126.Значение;
		ЯчейкиРасчета.П0090191.Значение	= ЯчейкиРасчета.П0120127.Значение;
		ЯчейкиРасчета.П0090192.Значение	= ЯчейкиРасчета.П0120128.Значение;
		ЯчейкиРасчета.П0090193.Значение	= ЯчейкиРасчета.П0120129.Значение;
		ЯчейкиРасчета.П0090194.Значение	= ЯчейкиРасчета.П0120130.Значение;
		ЯчейкиРасчета.П0090195.Значение	= ЯчейкиРасчета.П0120131.Значение;
		ЯчейкиРасчета.П0090196.Значение	= ЯчейкиРасчета.П0120132.Значение;

		ЯчейкиРасчета.П0090197.Значение	= ЯчейкиРасчета.П0120127.Значение
										+ ЯчейкиРасчета.П0120129.Значение
										+ ЯчейкиРасчета.П0120131.Значение
										+ ЯчейкиРасчета.П0120132.Значение;

		ЯчейкиРасчета.П0090198.Значение	= ЯчейкиРасчета.П0120133.Значение;
		ЯчейкиРасчета.П0090199.Значение	= ЯчейкиРасчета.П0120136.Значение;
		ЯчейкиРасчета.П0090200.Значение	= ЯчейкиРасчета.П0120146.Значение;
		ЯчейкиРасчета.П0090201.Значение	= ЯчейкиРасчета.П0120148.Значение;
		ЯчейкиРасчета.П0090202.Значение	= ЯчейкиРасчета.П0120154.Значение;
		ЯчейкиРасчета.П0090203.Значение	= ЯчейкиРасчета.П0120155.Значение;
		ЯчейкиРасчета.П0090204.Значение	= ЯчейкиРасчета.П0120156.Значение;

		Для i = 190 по 204 цикл
			
			ЯчейкиРасчета["П0100"+i].Значение=ЯчейкиРасчета["П0080"+i].Значение-ЯчейкиРасчета["П0090"+i].Значение;
			Если ЯчейкиРасчета.П0080190.Значение<>0 Тогда
				ЯчейкиРасчета["П0110"+i].Значение=ЯчейкиРасчета["П0080"+i].Значение/ЯчейкиРасчета.П0080190.Значение*100;
			КонецЕсли;
			Если ЯчейкиРасчета.П0090190.Значение<>0 Тогда
				ЯчейкиРасчета["П0120"+i].Значение=ЯчейкиРасчета["П0090"+i].Значение/ЯчейкиРасчета.П0090190.Значение*100;
			КонецЕсли;
			ЯчейкиРасчета["П0130"+i].Значение=ЯчейкиРасчета["П0110"+i].Значение-ЯчейкиРасчета["П0120"+i].Значение;

		КонецЦикла;

		ЯчейкиРасчета.П0110208.Значение	= ЯчейкиРасчета.П0080192.Значение
										- ЯчейкиРасчета.П0080193.Значение
										- ЯчейкиРасчета.П0080195.Значение
										- ЯчейкиРасчета.П0080196.Значение
										- ЯчейкиРасчета.П0080199.Значение;

		ЯчейкиРасчета.П0120208.Значение	= ЯчейкиРасчета.П0090192.Значение
										- ЯчейкиРасчета.П0090193.Значение
										- ЯчейкиРасчета.П0090195.Значение
										- ЯчейкиРасчета.П0090196.Значение
										- ЯчейкиРасчета.П0090199.Значение;

		ЯчейкиРасчета.П0130208.Значение	= ЯчейкиРасчета.П0110208.Значение
										- ЯчейкиРасчета.П0120208.Значение;

		ДоляПеременных					= ?((ЯчейкиРасчета.П0080191.Значение+ЯчейкиРасчета.П0080193.Значение)<>0,
										  ЯчейкиРасчета.П0080191.Значение
										/(ЯчейкиРасчета.П0080191.Значение+ЯчейкиРасчета.П0080193.Значение),0);

		ЯчейкиРасчета.П0110209.Значение	= ?(ЯчейкиРасчета.П0100133.Значение<>0,
										  ЯчейкиРасчета.П0100128.Значение
										/ ЯчейкиРасчета.П0100133.Значение,0);

		ЯчейкиРасчета.П0120209.Значение	= ?(ЯчейкиРасчета.П0120133.Значение<>0,
										  ЯчейкиРасчета.П0120128.Значение
										/ ЯчейкиРасчета.П0120133.Значение,0);

		ЯчейкиРасчета.П0130209.Значение	= ЯчейкиРасчета.П0110209.Значение
										- ЯчейкиРасчета.П0120209.Значение;

		ЯчейкиРасчета.П0110210.Значение	= ?((ЯчейкиРасчета.П0080191.Значение
										+ ЯчейкиРасчета.П0080193.Значение
										+ ЯчейкиРасчета.П0080195.Значение
										+ ЯчейкиРасчета.П0080196.Значение)<>0,
										  ЯчейкиРасчета.П0080198.Значение
										/(ЯчейкиРасчета.П0080191.Значение
										+ ЯчейкиРасчета.П0080193.Значение
										+ ЯчейкиРасчета.П0080195.Значение
										+ ЯчейкиРасчета.П0080196.Значение),0)*100;

		ЯчейкиРасчета.П0120210.Значение	= ?((ЯчейкиРасчета.П0090191.Значение
										+ ЯчейкиРасчета.П0090193.Значение
										+ ЯчейкиРасчета.П0090195.Значение
										+ ЯчейкиРасчета.П0090196.Значение)<>0,
										  ЯчейкиРасчета.П0090198.Значение
										/(ЯчейкиРасчета.П0090191.Значение
										+ ЯчейкиРасчета.П0090193.Значение
										+ ЯчейкиРасчета.П0090195.Значение
										+ ЯчейкиРасчета.П0090196.Значение),0)*100;

		ЯчейкиРасчета.П0130210.Значение	= ЯчейкиРасчета.П0110210.Значение
										- ЯчейкиРасчета.П0120210.Значение;

		Текст3="     Маржинальный доход (вклад на покрытие, contribution margin). Является важнейшим определяющим фактором при анализе прибыльности";
		Текст3=Текст3+"  предприятия. Экономический смысл маржинального дохода заключается в том, что он обеспечивает покрытие постоянных расходов.";
		Текст3=Текст3+"  После того, как за счет полученного маржинального дохода покрыты постоянные расходы предприятия, фирма начинает получать";
		Текст3=Текст3+"  операционную прибыль.До этого, в случае недостаточности маржинального дохода, организация терпит убытки. В случае анализируемой организации,";

		ТекстМД="";

		Если ЯчейкиРасчета.П0100128.Значение >= (ЯчейкиРасчета.П0100129.Значение
											+ ЯчейкиРасчета.П0100131.Значение
											+ ЯчейкиРасчета.П0100132.Значение
											+ ЯчейкиРасчета.П0100136.Значение) Тогда
			
			ТекстМД=" маржинальный доход покрывает не только постоянные производственные, коммерческие и управленческие расходы предприятия,";
			ТекстМД=ТекстМД+" но и расходы по обслуживанию заемных средств. Это говорит о правильном выборе политики финансово - хозяйственной";
			ТекстМД=ТекстМД+" политики предприятия с точки зрения безубыточной работы.";
			
		ИначеЕсли ЯчейкиРасчета.П0100128.Значение	>=(ЯчейкиРасчета.П0100129.Значение
													+ ЯчейкиРасчета.П0100131.Значение
													+ ЯчейкиРасчета.П0100132.Значение) Тогда
		    
			ТекстМД=" маржинальный доход покрывает только постоянные производственные, коммерческие и управленческие расходы предприятия, но не";
			ТекстМД=ТекстМД+" покрывает расходы по обслуживанию заемных средств. Это говорит о безубыточной работе предприятия с точки зрения производства";
			ТекстМД=ТекстМД+" и торговли, но в области управления оборотными средствами предприятия имеются существенные недостатки. Необходимо проанализировать";
			ТекстМД=ТекстМД+" структуру активов и пассивов предприятия (см. выше), для снижения в общем объеме источников финансирования доли ""дорогих"" заемных средств (П2)";
		    ТекстМД=ТекстМД+" При невозможности снижения расходов по обслуживанию заемных средств, необходимо провести анализ безубыточности по каждой группе";
			ТекстМД=ТекстМД+" выпускаемой продукции в направлении либо увеличения объемов продаж, либо изменения структуры реализации в сторону увеличения";
		    ТекстМД=ТекстМД+" доли товаров (работ, услуг), приносящих наибольший маржинальный доход.";
			
			
		ИначеЕсли ЯчейкиРасчета.П0100128.Значение>=ЯчейкиРасчета.П0100129.Значение Тогда
		     
			ТекстМД=" маржинальный доход покрывает только постоянные производственные расходы предприятия, но не покрывает коммерческие и управленческие";
			ТекстМД=ТекстМД+" расходы. Это говорит о безубыточной работе предприятия с точки зрения производства";
			ТекстМД=ТекстМД+" но требует анализа и пересмотра в сторону уменьшения соответствующих статей расходов";
			ТекстМД=ТекстМД+" При невозможности снижения расходов, необходимо провести анализ безубыточности по каждой группе";
			ТекстМД=ТекстМД+" выпускаемой продукции. По результатам анализа, необходимо либо увеличить общий объем продаж, либо изменить структуру реализации в сторону увеличения";
		    ТекстМД=ТекстМД+" доли товаров (работ, услуг), приносящих наибольший маржинальный доход.";

		ИначеЕсли (ЯчейкиРасчета.П0100128.Значение<ЯчейкиРасчета.П0100129.Значение) и (ЯчейкиРасчета.П0100128.Значение>0) Тогда
				
			ТекстМД=" маржинальный доход не покрывает постоянные производственные расходы предприятия. Причины этого могут быть в неправильной маркетинговой политике";
			ТекстМД=ТекстМД+" предприятия. Необходимо провести анализ безубыточности по каждой группе";   
			ТекстМД=ТекстМД+" выпускаемой продукции. По результатам анализа, необходимо либо увеличить общий объем продаж, либо изменить структуру реализации в сторону увеличения";
		    ТекстМД=ТекстМД+" доли товаров (работ, услуг), приносящих наибольший маржинальный доход.";
			
		ИначеЕсли (ЯчейкиРасчета.П0100128.Значение<=0) Тогда
			
			ТекстМД=ТекстМД+" маржинальный доход отсутствует. При существующей структуре реализации, предприятие не может работать прибыльно. Дальнейшее увеличение объема продаж";
			ТекстМД=ТекстМД+" приведет к росту убытков. Необходимо провести анализ структуры себестоимости и безубыточности по каждой группе";   
			ТекстМД=ТекстМД+" выпускаемой продукции. По результатам анализа, необходимо либо пересмотреть производственную себестоимость";
			ТекстМД=ТекстМД+" выпускаемой продукции (работ, услуг), либо изменить ценовую политику предприятия, либо изменить структуру реализации в сторону увеличения";
		    ТекстМД=ТекстМД+" доли товаров (работ, услуг), приносящих наибольший маржинальный доход.";
			
		КонецЕсли;
		    
			Текст3=Текст3+ТекстМД;
			Текст3=Текст3+Символы.ПС+"     Важным критерием оценки прибыльности предприятия является отношение вклада на покрытие к операционной прибыли предприятия. Этот показатель также";
			Текст3=Текст3+" называют операционным или производственным рычагом (operating leverage). Показатель отражает величину изменения операционной прибыли";
			Текст3=Текст3+" при изменении объема реализации (при сохранении существующей структуры). Значение этого показателя, деленное на 100, показывает процент изменения";
			Текст3=Текст3+" финансового результата при изменении реализации на 1 процент. Эффект операционного рычага основан на соотношении постоянных";
			Текст3=Текст3+" и переменных расходов организации. У анализируемого предприятия,";
			
		ТекстОР="";

		Если ДоляПеременных>0.5 Тогда 
			
			ТекстОР=ТекстОР+" в составе себестоимости преобладают переменные затраты. Подобные организации характеризуются следующей динамикой прибыли в зависимости от";
			ТекстОР=ТекстОР+" изменения объема продаж: при достижении точки безубыточности, увеличение прибыли при увеличении объема продаж идет меньшими темпами, чем у";
			ТекстОР=ТекстОР+" предприятий с преобладанием постоянных затрат. Соответственно, верно и обратное: при уменьшении объемов выручки, прибыль будет снижаться достаточно медленно.";

		Иначе
			
			ТекстОР=ТекстОР+" в составе себестоимости преобладают постоянные затраты. Подобные организации характеризуются следующей динамикой прибыли в зависимости от";
			ТекстОР=ТекстОР+" изменения объема продаж: при достижении точки безубыточности, увеличение прибыли при увеличении объема продаж идет быстрее, чем у";
			ТекстОР=ТекстОР+" предприятий с преобладанием переменных затрат. Соответственно, верно и обратное: при уменьшении объемов выручки, прибыль упадет достаточно быстро.";
			ТекстОР=ТекстОР+" В условиях ухудшения конъюнктуры рынка, подобные предприятия подвержены повышенному риску";
			
		КонецЕсли;
			
		Текст3=Текст3+ТекстОР;
		
		ЯчейкиРасчета.ТекстЗ.Значение=Текст3;

		Текст4="";

		Текст4=Текст4+"     Отношение операционной прибыли к выручке: характеризует действительную рентабельность продаж. Так как этот показатель не испытывает влияния элементов, не";
		Текст4=Текст4+" относящихся к продажам (операционных, внереализационных доходов и расходов и пр.), он позволяет наиболее точно оценить эффективность производственно - торговой";
		Текст4=Текст4+" и маркетинговой деятельности организации в рамках основной деятельности. Для анализируемого предприятия,";

		ТекстСтр8="";

		ИзмОперПрибыль=ЯчейкиРасчета.П0100198.Значение;
		ИзмОперРентабельность=ЯчейкиРасчета.П0130198.Значение;

		Если (ИзмОперПрибыль>0) и (ИзмОперРентабельность>0) Тогда
			
			ТекстСтр8=ТекстСтр8+" увеличение операционной прибыли на "+Формат(ИзмОперПрибыль,"ЧДЦ=2")+" по абсолюту сопровождалось ростом рентабельности продаж на "+Формат(ИзмОперРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр8=ТекстСтр8+" В общем случае, это характеризует повышение эффективности производственно - торговой и маркетинговой деятельности предприятия.";

		ИначеЕсли (ИзмОперПрибыль<0) и (ИзмОперРентабельность>0) Тогда 
		    ТекстСтр8=ТекстСтр8+" уменьшение операционной прибыли на "+Формат(ИзмОперПрибыль,"ЧДЦ=2")+" по абсолюту сопровождалось ростом рентабельности продаж на "+Формат(ИзмОперРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр8=ТекстСтр8+" В общем случае, это характеризует эффективное управление производственно - торговой и маркетинговой деятельностью предприятия в условиях ухудшения конъюнктуры рынка.";

		ИначеЕсли (ИзмОперПрибыль>0) и (ИзмОперРентабельность<0) Тогда
		    ТекстСтр8=ТекстСтр8+" увеличение операционной прибыли на "+Формат(ИзмОперПрибыль,"ЧДЦ=2")+" по абсолюту сопровождалось снижением рентабельности продаж на "+Формат(ИзмОперРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр8=ТекстСтр8+" В общем случае, это характеризует снижение эффективности управления доходами и расходами предприятия, относящимися к продажам.";	
		ИначеЕсли (ИзмОперПрибыль<0) и (ИзмОперРентабельность<0) Тогда
		    ТекстСтр8=ТекстСтр8+" уменьшение операционной прибыли на "+Формат(ИзмОперПрибыль,"ЧДЦ=2")+" по абсолюту сопровождалось снижением рентабельности продаж на "+Формат(ИзмОперРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр8=ТекстСтр8+" В общем случае, это характеризует снижение эффективности управления доходами и расходами предприятия, относящимися к продажам";
		    ТекстСтр8=ТекстСтр8+" в условиях ухудшения конъюнктуры рынка";
		ИначеЕсли (ИзмОперПрибыль=0) и (ИзмОперРентабельность<0) Тогда
		    ТекстСтр8=ТекстСтр8+" при неизменной операционной прибыли по абсолюту, рентабельность продаж снизилась на "+Формат(ИзмОперРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр8=ТекстСтр8+" В общем случае, это характеризует снижение эффективности управления доходами и расходами предприятия, относящимися к продажам.";
		ИначеЕсли (ИзмОперПрибыль=0) и (ИзмОперРентабельность>0) Тогда
		    ТекстСтр8=ТекстСтр8+" при неизменной операционной прибыли по абсолюту, рентабельность продаж выросла на "+Формат(ИзмОперРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр8=ТекстСтр8+" В общем случае, это характеризует повышение эффективности управления доходами и расходами предприятия, относящимися к продажам.";	
		Иначе
		    ТекстСтр8=ТекстСтр8+" представленные данные не дают возможности охарактеризовать эффективность производственно - торговой";
			ТекстСтр8=ТекстСтр8+" и маркетинговой деятельности организации в рамках основной деятельности."; 
			
		КонецЕсли;

		Текст4=Текст4+ТекстСтр8;

		Текст4=Текст4+Символы.ПС+"     Отношение прибыли до налогообложения к выручке, при сопоставлении с предыдущим показателем, отражает влияние операционных";
		Текст4=Текст4+" и внереализационных доходов и расходов на конечный финансовый результат. Для анализируемого предприятия,";

		ТекстСтр10=""; 

		ВНРасх= ?(ЯчейкиРасчета.П0080198.Значение<>0,
				 (ЯчейкиРасчета.П0080200.Значение
				- ЯчейкиРасчета.П0080198.Значение)
				/ ЯчейкиРасчета.П0080198.Значение,0);

		ВНРасхПрош=?(ЯчейкиРасчета.П0090198.Значение<>0,
				(ЯчейкиРасчета.П0090200.Значение
				-ЯчейкиРасчета.П0090198.Значение)
				/ЯчейкиРасчета.П0090198.Значение,0);

		Если (ВНРасх<-0.4) или (ВНРасх>0.4) Тогда
			
			ТекстСтр10=ТекстСтр10+" операционные и внереализационные доходы и расходы составляют "+Формат(?(ВНРасх<0,(-1)*ВНРасх,ВНРасх)*100,"ЧДЦ=2")+"%";
			ТекстСтр10=ТекстСтр10+" от операционной прибыли. Такое влияние считается достаточно сильным и говорит о низком качестве и стабильности полученного конечного финансового результата.";

		Иначе
			ТекстСтр10=ТекстСтр10+" операционные и внереализационные доходы и расходы составляют "+Формат(?(ВНРасх<0,(-1)*ВНРасх,ВНРасх)*100,"ЧДЦ=2")+"%";
			ТекстСтр10=ТекстСтр10+" от операционной прибыли. Такое влияние считается приемлемым и говорит о хорошем качестве и стабильности полученного конечного финансового результата.";
		КонецЕсли;	

			
		Если (?(ВНРасх>0,ВНРасх,ВНРасх*(-1))) > (?(ВНРасхПрош>0,ВНРасхПрош,ВНРасхПрош*(-1)))тогда
		    
				ТекстСтр10=ТекстСтр10+" При этом, влияние этих расходов на операционную прибыль увеличилось по сравнению с прошлым периодом.";

		ИначеЕсли (?(ВНРасх>0,ВНРасх,ВНРасх*(-1))) < (?(ВНРасхПрош>0,ВНРасхПрош,ВНРасхПрош*(-1)))тогда	
				
				ТекстСтр10=ТекстСтр10+" При этом, влияние этих расходов на операционную прибыль уменьшилось по сравнению с прошлым периодом.";
		Иначе
				ТекстСтр10=ТекстСтр10+" При этом, влияние этих расходов на операционную прибыль по сравнению с прошлым периодом не изменилось";
			
		КонецЕсли; 
			
		Текст4=Текст4+ТекстСтр10; 

		Текст4=Текст4+Символы.ПС;

		Текст4=Текст4+"    Отношение чистой прибыли к выручке является конечным показателем в системе рентабельности продаж и отражает влияние на";
		Текст4=Текст4+" конечный финансовый результат всей совокупности доходов и расходов, включая чрезвычайные. Этот показатель является определяющей оценкой";
		Текст4=Текст4+" финансово - хозяйственной деятельности предприятия с точки зрения получения прибыли. Для анализируемой организации,";

		ТекстСтр12="";

		ИзмЧистаяПрибыль=ЯчейкиРасчета.П0100202.Значение;
		ИзмРентабельность=ЯчейкиРасчета.П0130202.Значение;

		Если (ИзмЧистаяПрибыль>0) и (ИзмРентабельность>0) Тогда
			
			ТекстСтр12=ТекстСтр12+" увеличение чистой прибыли на "+Формат(ИзмЧистаяПрибыль,"ЧДЦ=2")+" по абсолюту сопровождалось ростом рентабельности предприятия на "+Формат(ИзмРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр12=ТекстСтр12+" В общем случае, это характеризует повышение эффективности финансово - хозяйственной деятельности предприятия.";

		ИначеЕсли (ИзмЧистаяПрибыль<0) и (ИзмРентабельность>0) Тогда 
		    ТекстСтр12=ТекстСтр12+" уменьшение операционной прибыли на "+Формат(ИзмЧистаяПрибыль,"ЧДЦ=2")+" по абсолюту сопровождалось ростом рентабельности продаж на "+Формат(ИзмРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр12=ТекстСтр12+" В общем случае, это характеризует эффективное управление финансово - хозяйственной деятельностью предприятия в условиях ухудшения конъюнктуры рынка и роста непроизводственных расходов.";

		ИначеЕсли (ИзмЧистаяПрибыль>0) и (ИзмРентабельность<0) Тогда
		    ТекстСтр12=ТекстСтр12+" увеличение операционной прибыли на "+Формат(ИзмЧистаяПрибыль,"ЧДЦ=2")+" по абсолюту сопровождалось снижением рентабельности продаж на "+Формат(ИзмРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр12=ТекстСтр12+" В общем случае, это характеризует снижение эффективности финансово - хозяйственной деятельности предприятия.";	
		ИначеЕсли (ИзмЧистаяПрибыль<0) и (ИзмРентабельность<0) Тогда
		    ТекстСтр12=ТекстСтр12+" уменьшение операционной прибыли на "+Формат(ИзмЧистаяПрибыль,"ЧДЦ=2")+" по абсолюту сопровождалось снижением рентабельности продаж на "+Формат(ИзмРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр12=ТекстСтр12+" В общем случае, это характеризует снижение эффективности финансово - хозяйственной деятельности предприятия";
		    ТекстСтр12=ТекстСтр12+" в условиях ухудшения конъюнктуры рынка и роста непроизводственных расходов";
		ИначеЕсли (ИзмЧистаяПрибыль=0) и (ИзмРентабельность<0) Тогда
		    ТекстСтр12=ТекстСтр12+" при неизменной операционной прибыли по абсолюту, рентабельность продаж снизилась на "+Формат(ИзмРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр12=ТекстСтр12+" В общем случае, это характеризует снижение эффективности финансово - хозяйственной деятельности предприятия.";
		ИначеЕсли (ИзмЧистаяПрибыль=0) и (ИзмРентабельность>0) Тогда
		    ТекстСтр12=ТекстСтр12+" при неизменной операционной прибыли по абсолюту, рентабельность продаж выросла на "+Формат(ИзмРентабельность,"ЧДЦ=2")+"%.";
			ТекстСтр12=ТекстСтр12+" В общем случае, это характеризует повышение эффективности финансово - хозяйственной деятельности предприятия.";	
		Иначе
		    ТекстСтр12=ТекстСтр12+" представленные данные не дают возможности охарактеризовать эффективность финансово - хозяйственной деятельности предприятия";
			
		КонецЕсли;

		Текст4=Текст4+ТекстСтр12;
		
		ЯчейкиРасчета.Текст4.Значение=Текст4;
		
	КонецЕсли;
	
	Если Отчет.АнализИспользованияКапитала Тогда	
	
		ЯчейкиРасчета.П0100221.Значение	= ?((ЯчейкиРасчета.П0080042.Значение+ЯчейкиРасчета.П0100042.Значение)<>0,
										2* ЯчейкиРасчета.П0100154.Значение
										/ (ЯчейкиРасчета.П0080042.Значение+ЯчейкиРасчета.П0100042.Значение),0);

		ЯчейкиРасчета.П0100222.Значение	= ?((ЯчейкиРасчета.П0080029.Значение+ЯчейкиРасчета.П0100029.Значение)<>0,
										2* ЯчейкиРасчета.П0100154.Значение
										/ (ЯчейкиРасчета.П0080029.Значение+ЯчейкиРасчета.П0100029.Значение),0);

		ЯчейкиРасчета.П0100223.Значение	= ?((ЯчейкиРасчета.П0080013.Значение+ЯчейкиРасчета.П0100013.Значение)<>0,
										2* ЯчейкиРасчета.П0100154.Значение
										/ (ЯчейкиРасчета.П0080013.Значение+ЯчейкиРасчета.П0100013.Значение),0);

		ЯчейкиРасчета.П0100224.Значение	= ?((ЯчейкиРасчета.П0080025.Значение+ЯчейкиРасчета.П0100025.Значение)<>0,
										2* ЯчейкиРасчета.П0100154.Значение
										/ (ЯчейкиРасчета.П0080025.Значение+ЯчейкиРасчета.П0100025.Значение),0); 

		ЯчейкиРасчета.П0100225.Значение	= ?((ЯчейкиРасчета.П0080042.Значение+ЯчейкиРасчета.П0100042.Значение)<>0,
										2* ЯчейкиРасчета.П0100156.Значение
										/ (ЯчейкиРасчета.П0080042.Значение+ЯчейкиРасчета.П0100042.Значение),0);

		ЯчейкиРасчета.П0100226.Значение	=  ?(ЯчейкиРасчета.П0100221.Значение<>0,1/ЯчейкиРасчета.П0100221.Значение,0);
		
	КонецЕсли;
	
КонецПроцедуры  // Расчет()

//// Устанавливает обработчики для изменения ячеек табличного документа,
//// изменяемых вручную.
//&НаСервере
//Процедура УстановитьОбработчикиИзменений()
	//
	//Действие=Новый Действие("ДокументРезультатПриИзменении");
	//
	//Если ВыводитьБаланс Тогда
	//	
	//	Для Инд=14 По 44 Цикл
	//		
	//		Если СписокИтогиБаланса.НайтиПоЗначению(Инд)=Неопределено Тогда
	//		
	//		мФормаОтчета.Области["П00800"+Инд].ЭлементУправления.УстановитьДействие("ПриИзменении",Действие);
	//		мФормаОтчета.Области["П00800"+Инд].ЭлементУправления.КнопкаВыбора=Истина;

	//		мФормаОтчета.Области["П01000"+Инд].ЭлементУправления.УстановитьДействие("ПриИзменении",Действие);
	//		мФормаОтчета.Области["П01000"+Инд].ЭлементУправления.КнопкаВыбора=Истина;
	//		
	//		Если мФормаОтчета.Области["П00800"+Инд].Значение="" Тогда
	//			мФормаОтчета.Области["П00800"+Инд].Значение=0;
	//		КонецЕсли;
	//		
	//		Если мФормаОтчета.Области["П01000"+Инд].Значение="" Тогда
	//			мФормаОтчета.Области["П01000"+Инд].Значение=0;
	//		КонецЕсли;
	//	
	//		КонецЕсли;
	//		
	//	КонецЦикла;
	//			
	//КонецЕсли;
	//
	//Если ВыводитьПрибылиИУбытки Тогда
	//	
	//	Для Инд=126 По 155 Цикл
	//		
	//		Если СписокИтогиПиУ.НайтиПоЗначению(Инд)=Неопределено Тогда
	//			
	//			мФормаОтчета.Области["П0100"+Инд].ЭлементУправления.УстановитьДействие("ПриИзменении",Действие);
	//			мФормаОтчета.Области["П0100"+Инд].ЭлементУправления.КнопкаВыбора=Истина;

	//			мФормаОтчета.Области["П0120"+Инд].ЭлементУправления.УстановитьДействие("ПриИзменении",Действие);
	//			мФормаОтчета.Области["П0120"+Инд].ЭлементУправления.КнопкаВыбора=Истина;
	//			
	//			Если мФормаОтчета.Области["П0100"+Инд].Значение="" Тогда
	//				мФормаОтчета.Области["П0100"+Инд].Значение=0;
	//			КонецЕсли;
	//			
	//			Если мФормаОтчета.Области["П0120"+Инд].Значение="" Тогда
	//				мФормаОтчета.Области["П0120"+Инд].Значение=0;
	//			КонецЕсли;
	//			
	//		КонецЕсли;
	//		
	//	КонецЦикла;
	//	
	//КонецЕсли;
	//	
	
//КонецПроцедуры // УстановитьОбработчикиИзменений()

//******************************************************************************
// РасчетПоИнтегральнойМетодике(Л2,Л3,Л4,ФС2,Л5,ФС3)
//
// Параметры:
//
// Возвращаемое значение:
//  Здесь описывается возвращаемое значение.
//
// Вызывается из формул элементов диалога:
//
// Описание:
//  Здесь описывается функция.
//
Функция РасчетПоИнтегральнойМетодике(Л2,Л3,Л4,ФС2,Л5,ФС3)
	
	ВсегоБаллов=0;
	
	Если Л2>=0.5 Тогда	
		ВсегоБаллов=ВсегоБаллов+20;	
	ИначеЕсли (Л2<0.5) и (Л2>=0.1) Тогда
		ВсегоБаллов=ВсегоБаллов+20-((5-Окр(Л2*10,0,1))*4);
	КонецЕсли;
	
	Если Л3>=1.5 Тогда	
		ВсегоБаллов=ВсегоБаллов+18;	
	ИначеЕсли (Л3<1.5) и (Л3>=1) Тогда
		ВсегоБаллов=ВсегоБаллов+18-((15-Окр(Л3*10,0,1))*3);
	КонецЕсли; 
	
	Если Л4>=2 Тогда	
		ВсегоБаллов=ВсегоБаллов+16.5;	
	ИначеЕсли (Л4<2) и (Л4>=1) Тогда
		ВсегоБаллов=ВсегоБаллов+16.5-((20-Окр(Л4*10,0,1))*1.5);
	КонецЕсли;
	
	Если ФС2>=0.6 Тогда	
		ВсегоБаллов=ВсегоБаллов+17;	
	ИначеЕсли (ФС2<0.6) и (ФС2>=0.4) Тогда
		ВсегоБаллов=ВсегоБаллов+17-((60-Окр(ФС2*100,0,1))*0.8);
	КонецЕсли;
	
	Если Л5>=0.5 Тогда	
		ВсегоБаллов=ВсегоБаллов+15;	
	ИначеЕсли (Л5<0.5) и (Л5>=0.1) Тогда
		ВсегоБаллов=ВсегоБаллов+15-((5-Окр(Л5*10,0,1))*3);
	КонецЕсли;
	
	Если ФС3>=1 Тогда	
		ВсегоБаллов=ВсегоБаллов+13.5;	
	ИначеЕсли (ФС3<1) и (ФС3>=0.5) Тогда
		ВсегоБаллов=ВсегоБаллов+13.5-((10-Окр(ФС3*10,0,1))*2.5);
	КонецЕсли;
	
	Если ВсегоБаллов>=100 Тогда
		ТипОрганизации=1;
	ИначеЕсли (ВсегоБаллов<100) и (ВсегоБаллов>=66) Тогда
		ТипОрганизации=2;
	ИначеЕсли (ВсегоБаллов<66) и (ВсегоБаллов>=57) Тогда
		ТипОрганизации=3;	
	ИначеЕсли (ВсегоБаллов<57) и (ВсегоБаллов>=28.5) Тогда
		ТипОрганизации=4;
	ИначеЕсли ВсегоБаллов<28.5 Тогда
		ТипОрганизации=5;
	КонецЕсли;
	
	Возврат ТипОрганизации;
	
КонецФункции // РасчетПоИнтегральнойМетодике()

// Возвращает обороты по переданной статье
//
Функция ПолучитьОбороты(ИтогиПоОборотам,ФинансовыйПоказатель,Знак);
	
	СтрокаИтог=ИтогиПоОборотам.Найти(ФинансовыйПоказатель,"ФинансовыйПоказатель");
	
	Если НЕ СтрокаИтог=Неопределено Тогда
		
		СтруктураОборот=Новый Структура;
		СтруктураОборот.Вставить("СуммаТек",СтрокаИтог.СуммаТекущая*Знак);
		СтруктураОборот.Вставить("СуммаСравн",СтрокаИтог.СуммаСравнение*Знак);
		
	Иначе
		
		СтруктураОборот=Новый Структура;
		СтруктураОборот.Вставить("СуммаТек",0);
		СтруктураОборот.Вставить("СуммаСравн",0);
		
	КонецЕсли;
	
	Возврат СтруктураОборот;
	
КонецФункции // ПолучитьОстатки()

// Возвращает остатки по переданному счету
//
Функция ПолучитьОстатки(ИтогиПоСчетам,Счет,Знак,ВидОстатка);
	
	СтрокаИтог=ИтогиПоСчетам.Найти(Счет,"Счет");
	
	Если НЕ СтрокаИтог=Неопределено Тогда
		
		СтруктураОстаток=Новый Структура;
		СтруктураОстаток.Вставить("СуммаНач",?(ВидОстатка=Перечисления.фин_ВидыДвиженийБухгалтерии.Дебет,
											СтрокаИтог.СуммаУпрНачальныйОстатокДт,СтрокаИтог.СуммаУпрНачальныйОстатокКт)*Знак);
		СтруктураОстаток.Вставить("СуммаКон",?(ВидОстатка=Перечисления.фин_ВидыДвиженийБухгалтерии.Дебет,
											СтрокаИтог.СуммаУпрКонечныйОстатокДт,СтрокаИтог.СуммаУпрКонечныйОстатокКт)*Знак);
		
	Иначе
		
		СтруктураОстаток=Новый Структура;
		СтруктураОстаток.Вставить("СуммаНач",0);
		СтруктураОстаток.Вставить("СуммаКон",0);
		
	КонецЕсли;
	
	Возврат СтруктураОстаток;
	
КонецФункции // ПолучитьОстатки()

// Возвращает остатки по переданному счету
//
Функция ПолучитьОстаткиПоФормуле(Формула,Знак)
	
	
	СуммаУпрНачальныйОстаток 	= фин_ЗащитаПривилегированныеПроцедуры.ПолучитьРасчетПоФормуле(Формула,"Сумма",Отчет.Сценарий,Справочники.Организации.ПустаяСсылка(),Отчет.ДатаНач,Отчет.ДатаКон,'00010101',"Период",,,,,Истина,Перечисления.фин_ПризнакиПеретекающихОстатковМеждуПериодами.ОстатокНаНачалоПериода).Итог("СуммаУпрОборот");
	СуммаУпрКонечныйОстаток 	= фин_ЗащитаПривилегированныеПроцедуры.ПолучитьРасчетПоФормуле(Формула,"Сумма",Отчет.Сценарий,Справочники.Организации.ПустаяСсылка(),Отчет.ДатаНач,Отчет.ДатаКон,'00010101',"Период",,,,,Истина,Перечисления.фин_ПризнакиПеретекающихОстатковМеждуПериодами.ОстатокНаКонецПериода).Итог("СуммаУпрОборот");
	СтруктураОстаток=Новый Структура;
	СтруктураОстаток.Вставить("СуммаНач",СуммаУпрНачальныйОстаток * Знак);
	СтруктураОстаток.Вставить("СуммаКон",СуммаУпрКонечныйОстаток * Знак);
		
	
	Возврат СтруктураОстаток;
	
КонецФункции // ПолучитьОстатки()

&НаКлиенте
Процедура ДокументРезультатПриИзменении(Элемент)
	Расчет();
КонецПроцедуры
