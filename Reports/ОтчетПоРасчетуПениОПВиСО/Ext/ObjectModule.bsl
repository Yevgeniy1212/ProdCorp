#Если Клиент Тогда
////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

// Возвращает основную форму отчета, связанную с данным экземпляром отчета
//
// Параметры
//	Нет
//
Функция ПолучитьОсновнуюФорму() Экспорт
	
	ОснФорма = ПолучитьФорму();
	ОснФорма.ОбщийОтчет = ОбщийОтчет;
	ОснФорма.ЭтотОтчет = ЭтотОбъект;
	Возврат ОснФорма;
	
КонецФункции // ПолучитьОсновнуюФорму()

// Читает свойство Построитель отчета
//
// Параметры
//	Нет
//
Функция ПолучитьПостроительОтчета() Экспорт

	Возврат ОбщийОтчет.ПолучитьПостроительОтчета();

КонецФункции // ПолучитьПостроительОтчета()

// Настраивает отчет по переданной структуре параметров
//
// Параметры:
//	Нет.
//
Процедура Настроить(Параметры) Экспорт

	ОбщийОтчет.Настроить(Параметры, ЭтотОбъект);

КонецПроцедуры

// Выполняет настройку отчета по умолчанию для заданного вида отчета
//
// Параметры: 
// 
Процедура ЗаполнитьНачальныеНастройки() Экспорт
	
	ОбщийОтчет.ИмяРегистра = "-";
	ОбщийОтчет.мНазваниеОтчета = "Отчет по расчету пени по взносам и отчислениям";
	
	ПостроительОтчета = ОбщийОтчет.ПостроительОтчета;
	
	// структура представлений полей
	СтруктураПредставлениеПолей = Новый Структура();
	
	// Сроки перечисления 
	СрокиПеречисленияТекст = "
	|ВЫБРАТЬ
	|	ВложенныйЗапрос.Месяц,
	|	ВложенныйЗапрос.Организация,
	|	ВложенныйЗапрос.Вид,
	|	СрокиПеречисленияНалоговСборовОтчислений.СрокПеречисления,
	|	СрокиПеречисленияНалоговСборовОтчислений.ПорядокОпределенияСрокаПеречисления
	|ИЗ
	|	(ВЫБРАТЬ
	|		МИНИМУМ(ВложенныйЗапрос.Приоритет) КАК Приоритет,
	|		ВложенныйЗапрос.Вид,
	|		ВложенныйЗапрос.Организация,
	|		ВложенныйЗапрос.Месяц
	|	ИЗ
	|		(ВЫБРАТЬ
	|			1 КАК Приоритет,
	|			СрокиПеречисления.ВидНалога КАК Вид,
	|			СрокиПеречисления.Организация,
	|			НАЧАЛОПЕРИОДА(СрокиПеречисления.Месяц, МЕСЯЦ) КАК Месяц
	|		ИЗ
	|			РегистрСведений.СрокиПеречисленияНалоговСборовОтчислений КАК СрокиПеречисления
	|		ГДЕ
	|			СрокиПеречисления.Организация <> &парамПустаяОрганизация
	|		{ГДЕ
	|			СрокиПеречисления.Организация.* КАК Организация,
	|			СрокиПеречисления.ВидНалога.* КАК ВидВзносаОтчисления
	|		}
	|		
	|		ОБЪЕДИНИТЬ ВСЕ
	|		
	|		ВЫБРАТЬ
	|			2 КАК Приоритет,
	|			СрокиПеречисления.ВидНалога КАК Вид,
	|			Организации.Ссылка КАК Организация,
	|			НАЧАЛОПЕРИОДА(СрокиПеречисления.Месяц, МЕСЯЦ) КАК Месяц
	|		ИЗ
	|			РегистрСведений.СрокиПеречисленияНалоговСборовОтчислений КАК СрокиПеречисления
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Организации КАК Организации
	|				ПО ИСТИНА
	|		ГДЕ
	|			СрокиПеречисления.Организация = &парамПустаяОрганизация
	|		{ГДЕ
	|			Организации.Ссылка.* КАК Организация,
	|			СрокиПеречисления.ВидНалога.* КАК ВидВзносаОтчисления
	|		}
	|	) КАК ВложенныйЗапрос
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ВложенныйЗапрос.Вид,
	|		ВложенныйЗапрос.Организация,
	|		ВложенныйЗапрос.Месяц) КАК ВложенныйЗапрос
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СрокиПеречисленияНалоговСборовОтчислений КАК СрокиПеречисленияНалоговСборовОтчислений
	|		ПО ВложенныйЗапрос.Месяц = НАЧАЛОПЕРИОДА(СрокиПеречисленияНалоговСборовОтчислений.Месяц, МЕСЯЦ)
	|			И (ВЫБОР
	|				КОГДА ВложенныйЗапрос.Приоритет = 1
	|					ТОГДА СрокиПеречисленияНалоговСборовОтчислений.Организация = ВложенныйЗапрос.Организация
	|				ИНАЧЕ СрокиПеречисленияНалоговСборовОтчислений.Организация = &парамПустаяОрганизация
	|			КОНЕЦ)
	|			И (СрокиПеречисленияНалоговСборовОтчислений.ВидНалога = ВложенныйЗапрос.Вид)";
	
	// Даты расчета пени по ОПВ и СО за период
	ДатыИзмененияОПВТекст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&парамВидОПВ КАК Вид,
	|	ОПВРасчетыСФондами.Организация,
	|	ОПВРасчетыСФондами.ФизЛицо,
	|	ОПВРасчетыСФондами.ДатаНачала КАК Период
	|ИЗ
	|	РегистрНакопления.ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
	|ГДЕ
	|	ОПВРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ОПВРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ОПВРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ОПВРасчетыСФондами.ВидСтроки = &парамИсчисление
	|	И ОПВРасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|{ГДЕ
	|	ОПВРасчетыСФондами.Организация.* КАК Организация,
	|	ОПВРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ОПВРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ОПВРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОПВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОПВРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}";
	
	ДатыИзмененияСОТекст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&парамВидСО КАК Вид,
	|	СОРасчетыСФондами.Организация,
	|	СОРасчетыСФондами.ФизЛицо,
	|	СОРасчетыСФондами.ДатаНачала КАК Период
	|ИЗ
	|	РегистрНакопления.СОРасчетыСФондами КАК СОРасчетыСФондами
	|ГДЕ
	|	СОРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И СОРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И СОРасчетыСФондами.ВидДвижения = &парамПриход
	|	И СОРасчетыСФондами.ВидСтроки = &парамИсчисление
	|	И СОРасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|{ГДЕ
	|	СОРасчетыСФондами.Организация.* КАК Организация,
	|	СОРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	СОРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	СОРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СОРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}
	|";
	
	ДатыИзмененияООСМСТекст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&парамВидООСМС КАК Вид,
	|	ООСМСРасчетыСФондами.Организация,
	|	ООСМСРасчетыСФондами.ФизЛицо,
	|	ООСМСРасчетыСФондами.ДатаНачала КАК Период
	|ИЗ
	|	РегистрНакопления.ООСМСРасчетыСФондами КАК ООСМСРасчетыСФондами
	|ГДЕ
	|	ООСМСРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ООСМСРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ООСМСРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ООСМСРасчетыСФондами.ВидСтроки = &парамИсчисление
	|	И ООСМСРасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|{ГДЕ
	|	ООСМСРасчетыСФондами.Организация.* КАК Организация,
	|	ООСМСРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ООСМСРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ООСМСРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ООСМСРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}
	|";
	
	ДатыИзмененияВОСМСТекст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&парамВидВОСМС КАК Вид,
	|	ВОСМСРасчетыСФондами.Организация,
	|	ВОСМСРасчетыСФондами.ФизЛицо,
	|	ВОСМСРасчетыСФондами.ДатаНачала КАК Период
	|ИЗ
	|	РегистрНакопления.ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
	|ГДЕ
	|	ВОСМСРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ВОСМСРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ВОСМСРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ВОСМСРасчетыСФондами.ВидСтроки = &парамИсчисление
	|	И ВОСМСРасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|{ГДЕ
	|	ВОСМСРасчетыСФондами.Организация.* КАК Организация,
	|	ВОСМСРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ВОСМСРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ВОСМСРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ВОСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ВОСМСРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}";

	ДатыИзмененияОППВТекст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&парамВидОППВ КАК Вид,
	|	ОППВРасчетыСФондами.Организация,
	|	ОППВРасчетыСФондами.ФизЛицо,
	|	ОППВРасчетыСФондами.ДатаНачала КАК Период
	|ИЗ
	|	РегистрНакопления.ОППВРасчетыСФондами КАК ОППВРасчетыСФондами
	|ГДЕ
	|	ОППВРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ОППВРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ОППВРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ОППВРасчетыСФондами.ВидСтроки = &парамИсчисление
	|	И ОППВРасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|{ГДЕ
	|	ОППВРасчетыСФондами.Организация.* КАК Организация,
	|	ОППВРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ОППВРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ОППВРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОППВРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}";
	
	ДатыИзмененияОПВРТекст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&парамВидОПВР КАК Вид,
	|	ОПВРРасчетыСФондами.Организация,
	|	ОПВРРасчетыСФондами.ФизЛицо,
	|	ОПВРРасчетыСФондами.ДатаНачала КАК Период
	|ИЗ
	|	РегистрНакопления.ОПВРРасчетыСФондами КАК ОПВРРасчетыСФондами
	|ГДЕ
	|	ОПВРРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ОПВРРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ОПВРРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ОПВРРасчетыСФондами.ВидСтроки = &парамИсчисление
	|	И ОПВРРасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|{ГДЕ
	|	ОПВРРасчетыСФондами.Организация.* КАК Организация,
	|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ОПВРРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ОПВРРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОПВРРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}";

	ДатыИзмененияТекст = ДатыИзмененияОПВТекст + "
						|
						|ОБЪЕДИНИТЬ ВСЕ
						|
						|" + ДатыИзмененияСОТекст + "
						|
						|ОБЪЕДИНИТЬ ВСЕ
						|
						|" + ДатыИзмененияООСМСТекст + "
						|
						|ОБЪЕДИНИТЬ ВСЕ
						|
						|" + ДатыИзмененияВОСМСТекст + "
						|
						|ОБЪЕДИНИТЬ ВСЕ
						|
						|" + ДатыИзмененияОППВТекст + "
						|
						|ОБЪЕДИНИТЬ ВСЕ
						|
						|" + ДатыИзмененияОПВРТекст;
	
	ЗадолженностьТекст = "
	|ВЫБРАТЬ
	|	&парамВидОПВ КАК Вид,
	|	ДатыИзменения.Период,
	|	ПодлежитПеречислению.Организация,
	|	ПодлежитПеречислению.СтруктурнаяЕдиница,
	|	ПодлежитПеречислению.Налогоплательщик,
	|	ПодлежитПеречислению.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцВыплатыДоходов, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ПодлежитПеречислению.ВзносОстаток КАК Сумма
	|ИЗ
	|	РегистрНакопления.ОПВПодлежитПеречислениюВФонды.Остатки(&ДатаНач) КАК ПодлежитПеречислению
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + ДатыИзмененияОПВТекст + ") КАК ДатыИзменения
	|		ПО ПодлежитПеречислению.Организация = ДатыИзменения.Организация
	|			И ПодлежитПеречислению.ФизЛицо = ДатыИзменения.ФизЛицо
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидОПВ КАК Вид,
	|	ДатыИзменения.Период,
	|	ПодлежитПеречислению.Организация,
	|	ПодлежитПеречислению.СтруктурнаяЕдиница,
	|	ПодлежитПеречислению.Налогоплательщик,
	|	ПодлежитПеречислению.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцВыплатыДоходов, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СУММА(ВЫБОР КОГДА ПодлежитПеречислению.ВидДвижения = &парамПриход ТОГДА 1 ИНАЧЕ -1 КОНЕЦ * ПодлежитПеречислению.Взнос) КАК Сумма
	|ИЗ
	|	РегистрНакопления.ОПВПодлежитПеречислениюВФонды КАК ПодлежитПеречислению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ДатыИзмененияОПВТекст + ") КАК ДатыИзменения
	|		ПО ПодлежитПеречислению.Период >= &ДатаНач
	|			И ПодлежитПеречислению.Период < ДатыИзменения.Период
	|			И ПодлежитПеречислению.Организация = ДатыИзменения.Организация
	|			И ПодлежитПеречислению.ФизЛицо = ДатыИзменения.ФизЛицо
	|{ГДЕ
	|	ПодлежитПеречислению.Организация.* КАК Организация,
	|	ПодлежитПеречислению.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ПодлежитПеречислению.Налогоплательщик.* КАК Налогоплательщик,
	|	ПодлежитПеречислению.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода
	|}
	|
	|СГРУППИРОВАТЬ ПО
	|	ДатыИзменения.Период,
	|	ПодлежитПеречислению.Организация,
	|	ПодлежитПеречислению.СтруктурнаяЕдиница,
	|	ПодлежитПеречислению.Налогоплательщик,
	|	ПодлежитПеречислению.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцВыплатыДоходов, МЕСЯЦ),
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцНалоговогоПериода, МЕСЯЦ)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидСО КАК Вид,
	|	ДатыИзменения.Период,
	|	СОРасчетыСФондами.Организация,
	|	СОРасчетыСФондами.СтруктурнаяЕдиница,
	|	СОРасчетыСФондами.Налогоплательщик,
	|	СОРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СОРасчетыСФондами.ОтчислениеОстаток КАК Сумма
	|ИЗ
	|	РегистрНакопления.СОРасчетыСФондами.Остатки(&ДатаНач,
	|													ВидПлатежа В (&парамВидыПлатежейНалог)) КАК СОРасчетыСФондами
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + ДатыИзмененияСОТекст + ") КАК ДатыИзменения
	|		ПО СОРасчетыСФондами.Организация = ДатыИзменения.Организация
	|			И СОРасчетыСФондами.ФизЛицо = ДатыИзменения.ФизЛицо
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидСО КАК Вид,
	|	ДатыИзменения.Период,
	|	СОРасчетыСФондами.Организация,
	|	СОРасчетыСФондами.СтруктурнаяЕдиница,
	|	СОРасчетыСФондами.Налогоплательщик,
	|	СОРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СУММА(ВЫБОР КОГДА СОРасчетыСФондами.ВидДвижения = &парамПриход ТОГДА 1 ИНАЧЕ -1 КОНЕЦ * СОРасчетыСФондами.Отчисление) КАК Сумма
	|
	|ИЗ
	|	РегистрНакопления.СОРасчетыСФондами КАК СОРасчетыСФондами
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ДатыИзмененияСОТекст + ") КАК ДатыИзменения
	|		ПО СОРасчетыСФондами.Период >= &ДатаНач
	|			И СОРасчетыСФондами.Период < ДатыИзменения.Период
	|			И СОРасчетыСФондами.Организация = ДатыИзменения.Организация
	|			И СОРасчетыСФондами.ФизЛицо = ДатыИзменения.ФизЛицо
	|ГДЕ
	|	СОРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейНалог)
	|{ГДЕ
	|	СОРасчетыСФондами.Организация.* КАК Организация,
	|	СОРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	СОРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	СОРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода
	|}
	|
	|СГРУППИРОВАТЬ ПО
	|	ДатыИзменения.Период,
	|	СОРасчетыСФондами.Организация,
	|	СОРасчетыСФондами.СтруктурнаяЕдиница,
	|	СОРасчетыСФондами.Налогоплательщик,
	|	СОРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидООСМС КАК Вид,
	|	ДатыИзменения.Период,
	|	ООСМСРасчетыСФондами.Организация,
	|	ООСМСРасчетыСФондами.СтруктурнаяЕдиница,
	|	ООСМСРасчетыСФондами.Налогоплательщик,
	|	ООСМСРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ООСМСРасчетыСФондами.ОтчислениеОстаток КАК Сумма
	|ИЗ
	|	РегистрНакопления.ООСМСРасчетыСФондами.Остатки(&ДатаНач,
	|													ВидПлатежа В (&парамВидыПлатежейНалог)) КАК ООСМСРасчетыСФондами
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + ДатыИзмененияООСМСТекст + ") КАК ДатыИзменения
	|		ПО ООСМСРасчетыСФондами.Организация = ДатыИзменения.Организация
	|			И ООСМСРасчетыСФондами.ФизЛицо = ДатыИзменения.ФизЛицо
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидООСМС КАК Вид,
	|	ДатыИзменения.Период,
	|	ООСМСРасчетыСФондами.Организация,
	|	ООСМСРасчетыСФондами.СтруктурнаяЕдиница,
	|	ООСМСРасчетыСФондами.Налогоплательщик,
	|	ООСМСРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СУММА(ВЫБОР КОГДА ООСМСРасчетыСФондами.ВидДвижения = &парамПриход ТОГДА 1 ИНАЧЕ -1 КОНЕЦ * ООСМСРасчетыСФондами.Отчисление) КАК Сумма
	|
	|ИЗ
	|	РегистрНакопления.ООСМСРасчетыСФондами КАК ООСМСРасчетыСФондами
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ДатыИзмененияООСМСТекст + ") КАК ДатыИзменения
	|		ПО ООСМСРасчетыСФондами.Период >= &ДатаНач
	|			И ООСМСРасчетыСФондами.Период < ДатыИзменения.Период
	|			И ООСМСРасчетыСФондами.Организация = ДатыИзменения.Организация
	|			И ООСМСРасчетыСФондами.ФизЛицо = ДатыИзменения.ФизЛицо
	|ГДЕ
	|	ООСМСРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейНалог)
	|{ГДЕ
	|	ООСМСРасчетыСФондами.Организация.* КАК Организация,
	|	ООСМСРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ООСМСРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ООСМСРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода
	|}
	|
	|СГРУППИРОВАТЬ ПО
	|	ДатыИзменения.Период,
	|	ООСМСРасчетыСФондами.Организация,
	|	ООСМСРасчетыСФондами.СтруктурнаяЕдиница,
	|	ООСМСРасчетыСФондами.Налогоплательщик,
	|	ООСМСРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидВОСМС КАК Вид,
	|	ДатыИзменения.Период,
	|	ПодлежитПеречислению.Организация,
	|	ПодлежитПеречислению.СтруктурнаяЕдиница,
	|	ПодлежитПеречислению.Налогоплательщик,
	|	ПодлежитПеречислению.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцВыплатыДоходов, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ПодлежитПеречислению.ВзносОстаток КАК Сумма
	|ИЗ
	|	РегистрНакопления.ВОСМСПодлежитПеречислениюВФонды.Остатки(&ДатаНач) КАК ПодлежитПеречислению
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + ДатыИзмененияВОСМСТекст + ") КАК ДатыИзменения
	|		ПО ПодлежитПеречислению.Организация = ДатыИзменения.Организация
	|			И ПодлежитПеречислению.ФизЛицо = ДатыИзменения.ФизЛицо
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидВОСМС КАК Вид,
	|	ДатыИзменения.Период,
	|	ПодлежитПеречислению.Организация,
	|	ПодлежитПеречислению.СтруктурнаяЕдиница,
	|	ПодлежитПеречислению.Налогоплательщик,
	|	ПодлежитПеречислению.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцВыплатыДоходов, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СУММА(ВЫБОР КОГДА ПодлежитПеречислению.ВидДвижения = &парамПриход ТОГДА 1 ИНАЧЕ -1 КОНЕЦ * ПодлежитПеречислению.Взнос) КАК Сумма
	|ИЗ
	|	РегистрНакопления.ВОСМСПодлежитПеречислениюВФонды КАК ПодлежитПеречислению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ДатыИзмененияВОСМСТекст + ") КАК ДатыИзменения
	|		ПО ПодлежитПеречислению.Период >= &ДатаНач
	|			И ПодлежитПеречислению.Период < ДатыИзменения.Период
	|			И ПодлежитПеречислению.Организация = ДатыИзменения.Организация
	|			И ПодлежитПеречислению.ФизЛицо = ДатыИзменения.ФизЛицо
	|{ГДЕ
	|	ПодлежитПеречислению.Организация.* КАК Организация,
	|	ПодлежитПеречислению.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ПодлежитПеречислению.Налогоплательщик.* КАК Налогоплательщик,
	|	ПодлежитПеречислению.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода
	|}
	|
	|СГРУППИРОВАТЬ ПО
	|	ДатыИзменения.Период,
	|	ПодлежитПеречислению.Организация,
	|	ПодлежитПеречислению.СтруктурнаяЕдиница,
	|	ПодлежитПеречислению.Налогоплательщик,
	|	ПодлежитПеречислению.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцВыплатыДоходов, МЕСЯЦ),
	|	НАЧАЛОПЕРИОДА(ПодлежитПеречислению.МесяцНалоговогоПериода, МЕСЯЦ)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидОППВ КАК Вид,
	|	ДатыИзменения.Период,
	|	ОППВРасчетыСФондами.Организация,
	|	ОППВРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОППВРасчетыСФондами.Налогоплательщик,
	|	ОППВРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОППВРасчетыСФондами.ВзносОстаток КАК Сумма
	|ИЗ
	|	РегистрНакопления.ОППВРасчетыСФондами.Остатки(&ДатаНач,
	|													ВидПлатежа В (&парамВидыПлатежейНалог)) КАК ОППВРасчетыСФондами
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + ДатыИзмененияОППВТекст + ") КАК ДатыИзменения
	|		ПО ОППВРасчетыСФондами.Организация = ДатыИзменения.Организация
	|			И ОППВРасчетыСФондами.ФизЛицо = ДатыИзменения.ФизЛицо
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидОППВ КАК Вид,
	|	ДатыИзменения.Период,
	|	ОППВРасчетыСФондами.Организация,
	|	ОППВРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОППВРасчетыСФондами.Налогоплательщик,
	|	ОППВРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СУММА(ВЫБОР КОГДА ОППВРасчетыСФондами.ВидДвижения = &парамПриход ТОГДА 1 ИНАЧЕ -1 КОНЕЦ * ОППВРасчетыСФондами.Взнос) КАК Сумма
	|
	|ИЗ
	|	РегистрНакопления.ОППВРасчетыСФондами КАК ОППВРасчетыСФондами
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ДатыИзмененияОППВТекст + ") КАК ДатыИзменения
	|		ПО ОППВРасчетыСФондами.Период >= &ДатаНач
	|			И ОППВРасчетыСФондами.Период < ДатыИзменения.Период
	|			И ОППВРасчетыСФондами.Организация = ДатыИзменения.Организация
	|			И ОППВРасчетыСФондами.ФизЛицо = ДатыИзменения.ФизЛицо
	|ГДЕ
	|	ОППВРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейНалог)
	|{ГДЕ
	|	ОППВРасчетыСФондами.Организация.* КАК Организация,
	|	ОППВРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ОППВРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ОППВРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода
	|}
	|
	|СГРУППИРОВАТЬ ПО
	|	ДатыИзменения.Период,
	|	ОППВРасчетыСФондами.Организация,
	|	ОППВРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОППВРасчетыСФондами.Налогоплательщик,
	|	ОППВРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидОПВР КАК Вид,
	|	ДатыИзменения.Период,
	|	ОПВРРасчетыСФондами.Организация,
	|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОПВРРасчетыСФондами.Налогоплательщик,
	|	ОПВРРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОПВРРасчетыСФондами.ВзносОстаток КАК Сумма
	|ИЗ
	|	РегистрНакопления.ОПВРРасчетыСФондами.Остатки(&ДатаНач,
	|													ВидПлатежа В (&парамВидыПлатежейНалог)) КАК ОПВРРасчетыСФондами
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + ДатыИзмененияОПВРТекст + ") КАК ДатыИзменения
	|		ПО ОПВРРасчетыСФондами.Организация = ДатыИзменения.Организация
	|			И ОПВРРасчетыСФондами.ФизЛицо = ДатыИзменения.ФизЛицо
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидОПВР КАК Вид,
	|	ДатыИзменения.Период,
	|	ОПВРРасчетыСФондами.Организация,
	|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОПВРРасчетыСФондами.Налогоплательщик,
	|	ОПВРРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцВыплатыДоходов,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СУММА(ВЫБОР КОГДА ОПВРРасчетыСФондами.ВидДвижения = &парамПриход ТОГДА 1 ИНАЧЕ -1 КОНЕЦ * ОПВРРасчетыСФондами.Взнос) КАК Сумма
	|
	|ИЗ
	|	РегистрНакопления.ОПВРРасчетыСФондами КАК ОПВРРасчетыСФондами
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ДатыИзмененияОПВРТекст + ") КАК ДатыИзменения
	|		ПО ОПВРРасчетыСФондами.Период >= &ДатаНач
	|			И ОПВРРасчетыСФондами.Период < ДатыИзменения.Период
	|			И ОПВРРасчетыСФондами.Организация = ДатыИзменения.Организация
	|			И ОПВРРасчетыСФондами.ФизЛицо = ДатыИзменения.ФизЛицо
	|ГДЕ
	|	ОПВРРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейНалог)
	|{ГДЕ
	|	ОПВРРасчетыСФондами.Организация.* КАК Организация,
	|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ОПВРРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ОПВРРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода
	|}
	|
	|СГРУППИРОВАТЬ ПО
	|	ДатыИзменения.Период,
	|	ОПВРРасчетыСФондами.Организация,
	|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОПВРРасчетыСФондами.Налогоплательщик,
	|	ОПВРРасчетыСФондами.ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ)
    |";
	
	// определим просроченную задолженность
	ПросроченнаяЗадолженностьТекст = "
	|ВЫБРАТЬ
	|	Задолженность.Вид,
	|	Задолженность.Период,
	|	Задолженность.Организация,
	|	Задолженность.СтруктурнаяЕдиница,
	|	Задолженность.Налогоплательщик,
	|	Задолженность.ФизЛицо,
	|	Задолженность.МесяцНалоговогоПериода,
	|	СУММА(Задолженность.Сумма) КАК Сумма
	|ИЗ
	|	(" + ЗадолженностьТекст + ") КАК Задолженность
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + СрокиПеречисленияТекст + ") КАК СрокиПеречисления
	|		ПО Задолженность.Вид = СрокиПеречисления.Вид
	|			И Задолженность.Организация = СрокиПеречисления.Организация
	|			И ((Задолженность.МесяцВыплатыДоходов = СрокиПеречисления.Месяц
	|					И СрокиПеречисления.ПорядокОпределенияСрокаПеречисления = &парамПоМесяцуВыплатыДоходов) 
	|				ИЛИ (Задолженность.МесяцНалоговогоПериода = СрокиПеречисления.Месяц
	|					И СрокиПеречисления.ПорядокОпределенияСрокаПеречисления = &парамПоМесяцуНалоговогоПериода))
	|ГДЕ
	|	Задолженность.Период > СрокиПеречисления.СрокПеречисления
	|{ГДЕ
	|	Задолженность.Вид.* КАК ВидВзносаОтчисления
	|}
	|
	|СГРУППИРОВАТЬ ПО
	|	Задолженность.Вид,
	|	Задолженность.Период,
	|	Задолженность.ФизЛицо,
	|	Задолженность.Организация,
	|	Задолженность.СтруктурнаяЕдиница,
	|	Задолженность.Налогоплательщик,
	|	Задолженность.МесяцНалоговогоПериода
	|
	|ИМЕЮЩИЕ СУММА(Задолженность.Сумма) > 0
	|";
	
	ЗначенияПараметровРасчетаТекст = "
	|ВЫБРАТЬ
	|	ДатыИзменения.Период,
	|	ДатыИзменения.Вид,
	|	ДатыИзменения.Организация,
	|	СтавкаРефинансированияНБ.Размер КАК СтавкаРефинансирования,
	|	КоэффициентыСтавкиРефинансирования.Коэффициент
	|ИЗ
	|	(ВЫБРАТЬ
	|			ДатыИзменения.Период,
	|			ДатыИзменения.Вид,
	|			ДатыИзменения.Организация,
	|			МАКСИМУМ(СтавкаРефинансированияНБ.Период) КАК ПериодСтавки,
	|			МАКСИМУМ(ВЫБОР
	|						КОГДА КоэффициентыСтавкиРефинансирования.Организация = ДатыИзменения.Организация
	|							ТОГДА КоэффициентыСтавкиРефинансирования.Период
	|						ИНАЧЕ NULL
	|					 КОНЕЦ) КАК ПериодКоэффициентаОрг,
	|			МАКСИМУМ(ВЫБОР
	|						КОГДА КоэффициентыСтавкиРефинансирования.Организация = &парамПустаяОрганизация
	|							ТОГДА КоэффициентыСтавкиРефинансирования.Период
	|						ИНАЧЕ NULL
	|					 КОНЕЦ) КАК ПериодКоэффициентаОбщ
	|		ИЗ
	|			(" + ДатыИзмененияТекст + ") КАК ДатыИзменения
	|
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкаРефинансированияНБ КАК СтавкаРефинансированияНБ
	|				ПО СтавкаРефинансированияНБ.Период <= ДатыИзменения.Период
	|
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КоэффициентыСтавкиРефинансированияНБДляРасчетаПени КАК КоэффициентыСтавкиРефинансирования
	|				ПО КоэффициентыСтавкиРефинансирования.Период <= ДатыИзменения.Период
	|					И КоэффициентыСтавкиРефинансирования.ВидНалога = ДатыИзменения.Вид
	|
	|		СГРУППИРОВАТЬ ПО
	|			ДатыИзменения.Период,
	|			ДатыИзменения.Вид,
	|			ДатыИзменения.Организация) КАК ДатыИзменения
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкаРефинансированияНБ КАК СтавкаРефинансированияНБ
	|		ПО ДатыИзменения.ПериодСтавки = СтавкаРефинансированияНБ.Период
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КоэффициентыСтавкиРефинансированияНБДляРасчетаПени КАК КоэффициентыСтавкиРефинансирования
	|		ПО КоэффициентыСтавкиРефинансирования.ВидНалога = ДатыИзменения.Вид
	|			И ВЫБОР
	|				КОГДА НЕ (ДатыИзменения.ПериодКоэффициентаОрг ЕСТЬ NULL) 
	|					ТОГДА ДатыИзменения.ПериодКоэффициентаОрг = КоэффициентыСтавкиРефинансирования.Период
	|							И КоэффициентыСтавкиРефинансирования.Организация = ДатыИзменения.Организация
	|					ИНАЧЕ ДатыИзменения.ПериодКоэффициентаОбщ = КоэффициентыСтавкиРефинансирования.Период
	|							И КоэффициентыСтавкиРефинансирования.Организация = &парамПустаяОрганизация
	|			КОНЕЦ
	|";
	
	// сумма фактически начисленной пени
	РасчетыСФондамиТекст = "
	|ВЫБРАТЬ
	|	&парамВидОПВ КАК Вид,
	|	ОПВРасчетыСФондами.ВидПлатежа,
	|	ОПВРасчетыСФондами.ФизЛицо,
	|	ОПВРасчетыСФондами.Организация,
	|	ОПВРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОПВРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ОПВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОПВРасчетыСФондами.ДатаНачала,
	|	ОПВРасчетыСФондами.ДатаОкончания,
	|	СУММА(ОПВРасчетыСФондами.Взнос) КАК ФактСуммаПени,
	|	ОПВРасчетыСФондами.Регистратор
	|ИЗ
	|	РегистрНакопления.ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
	|ГДЕ
	|	ОПВРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ОПВРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ОПВРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ОПВРасчетыСФондами.ВидСтроки = &парамИсчисление
	|{ГДЕ
	|	ОПВРасчетыСФондами.Организация.* КАК Организация,
	|	ОПВРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ОПВРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ОПВРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОПВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОПВРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}
	|СГРУППИРОВАТЬ ПО
	|	ОПВРасчетыСФондами.ВидПлатежа,
	|	ОПВРасчетыСФондами.ФизЛицо,
	|	ОПВРасчетыСФондами.Организация,
	|	ОПВРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОПВРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ОПВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ),
	|	ОПВРасчетыСФондами.ДатаНачала,
	|	ОПВРасчетыСФондами.ДатаОкончания,
	|	ОПВРасчетыСФондами.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидСО КАК Вид,
	|	СОРасчетыСФондами.ВидПлатежа,
	|	СОРасчетыСФондами.ФизЛицо,
	|	СОРасчетыСФондами.Организация,
	|	СОРасчетыСФондами.СтруктурнаяЕдиница,
	|	СОРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СОРасчетыСФондами.ДатаНачала,
	|	СОРасчетыСФондами.ДатаОкончания,
	|	СУММА(СОРасчетыСФондами.Отчисление) КАК ФактСуммаПени,
	|	СОРасчетыСФондами.Регистратор	
	|ИЗ
	|	РегистрНакопления.СОРасчетыСФондами КАК СОРасчетыСФондами
	|ГДЕ
	|	СОРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И СОРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И СОРасчетыСФондами.ВидДвижения = &парамПриход
	|	И СОРасчетыСФондами.ВидСтроки = &парамИсчисление
	|{ГДЕ
	|	СОРасчетыСФондами.Организация.* КАК Организация,
	|	СОРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	СОРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	СОРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	СОРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}
	|СГРУППИРОВАТЬ ПО
	|	СОРасчетыСФондами.ВидПлатежа,
	|	СОРасчетыСФондами.ФизЛицо,	
	|	СОРасчетыСФондами.Организация,
	|	СОРасчетыСФондами.СтруктурнаяЕдиница,
	|	СОРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(СОРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ),
	|	СОРасчетыСФондами.ДатаНачала,
	|	СОРасчетыСФондами.ДатаОкончания,
	|	СОРасчетыСФондами.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидООСМС КАК Вид,
	|	ООСМСРасчетыСФондами.ВидПлатежа,
	|	ООСМСРасчетыСФондами.ФизЛицо,
	|	ООСМСРасчетыСФондами.Организация,
	|	ООСМСРасчетыСФондами.СтруктурнаяЕдиница,
	|	ООСМСРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ООСМСРасчетыСФондами.ДатаНачала,
	|	ООСМСРасчетыСФондами.ДатаОкончания,
	|	СУММА(ООСМСРасчетыСФондами.Отчисление) КАК ФактСуммаПени,
	|	ООСМСРасчетыСФондами.Регистратор	
	|ИЗ
	|	РегистрНакопления.ООСМСРасчетыСФондами КАК ООСМСРасчетыСФондами
	|ГДЕ
	|	ООСМСРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ООСМСРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ООСМСРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ООСМСРасчетыСФондами.ВидСтроки = &парамИсчисление
	|{ГДЕ
	|	ООСМСРасчетыСФондами.Организация.* КАК Организация,
	|	ООСМСРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ООСМСРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ООСМСРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ООСМСРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}
	|СГРУППИРОВАТЬ ПО
	|	ООСМСРасчетыСФондами.ВидПлатежа,
	|	ООСМСРасчетыСФондами.ФизЛицо,	
	|	ООСМСРасчетыСФондами.Организация,
	|	ООСМСРасчетыСФондами.СтруктурнаяЕдиница,
	|	ООСМСРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ООСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ),
	|	ООСМСРасчетыСФондами.ДатаНачала,
	|	ООСМСРасчетыСФондами.ДатаОкончания,
	|	ООСМСРасчетыСФондами.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидВОСМС КАК Вид,
	|	ВОСМСРасчетыСФондами.ВидПлатежа,
	|	ВОСМСРасчетыСФондами.ФизЛицо,
	|	ВОСМСРасчетыСФондами.Организация,
	|	ВОСМСРасчетыСФондами.СтруктурнаяЕдиница,
	|	ВОСМСРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ВОСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ВОСМСРасчетыСФондами.ДатаНачала,
	|	ВОСМСРасчетыСФондами.ДатаОкончания,
	|	СУММА(ВОСМСРасчетыСФондами.Взнос) КАК ФактСуммаПени,
	|	ВОСМСРасчетыСФондами.Регистратор
	|ИЗ
	|	РегистрНакопления.ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
	|ГДЕ
	|	ВОСМСРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ВОСМСРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ВОСМСРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ВОСМСРасчетыСФондами.ВидСтроки = &парамИсчисление
	|{ГДЕ
	|	ВОСМСРасчетыСФондами.Организация.* КАК Организация,
	|	ВОСМСРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ВОСМСРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ВОСМСРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ВОСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ВОСМСРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}
	|СГРУППИРОВАТЬ ПО
	|	ВОСМСРасчетыСФондами.ВидПлатежа,
	|	ВОСМСРасчетыСФондами.ФизЛицо,
	|	ВОСМСРасчетыСФондами.Организация,
	|	ВОСМСРасчетыСФондами.СтруктурнаяЕдиница,
	|	ВОСМСРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ВОСМСРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ),
	|	ВОСМСРасчетыСФондами.ДатаНачала,
	|	ВОСМСРасчетыСФондами.ДатаОкончания,
	|	ВОСМСРасчетыСФондами.Регистратор
   	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидОППВ КАК Вид,
	|	ОППВРасчетыСФондами.ВидПлатежа,
	|	ОППВРасчетыСФондами.ФизЛицо,
	|	ОППВРасчетыСФондами.Организация,
	|	ОППВРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОППВРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОППВРасчетыСФондами.ДатаНачала,
	|	ОППВРасчетыСФондами.ДатаОкончания,
	|	СУММА(ОППВРасчетыСФондами.Взнос) КАК ФактСуммаПени,
	|	ОППВРасчетыСФондами.Регистратор	
	|ИЗ
	|	РегистрНакопления.ОППВРасчетыСФондами КАК ОППВРасчетыСФондами
	|ГДЕ
	|	ОППВРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ОППВРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ОППВРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ОППВРасчетыСФондами.ВидСтроки = &парамИсчисление
	|{ГДЕ
	|	ОППВРасчетыСФондами.Организация.* КАК Организация,
	|	ОППВРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ОППВРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ОППВРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОППВРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}
	|СГРУППИРОВАТЬ ПО
	|	ОППВРасчетыСФондами.ВидПлатежа,
	|	ОППВРасчетыСФондами.ФизЛицо,	
	|	ОППВРасчетыСФондами.Организация,
	|	ОППВРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОППВРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ОППВРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ),
	|	ОППВРасчетыСФондами.ДатаНачала,
	|	ОППВРасчетыСФондами.ДатаОкончания,
	|	ОППВРасчетыСФондами.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&парамВидОПВР КАК Вид,
	|	ОПВРРасчетыСФондами.ВидПлатежа,
	|	ОПВРРасчетыСФондами.ФизЛицо,
	|	ОПВРРасчетыСФондами.Организация,
	|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОПВРРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОПВРРасчетыСФондами.ДатаНачала,
	|	ОПВРРасчетыСФондами.ДатаОкончания,
	|	СУММА(ОПВРРасчетыСФондами.Взнос) КАК ФактСуммаПени,
	|	ОПВРРасчетыСФондами.Регистратор	
	|ИЗ
	|	РегистрНакопления.ОПВРРасчетыСФондами КАК ОПВРРасчетыСФондами
	|ГДЕ
	|	ОПВРРасчетыСФондами.Период МЕЖДУ &ДатаНач И &ДатаКон
	|	И ОПВРРасчетыСФондами.ВидПлатежа В (&парамВидыПлатежейПени)
	|	И ОПВРРасчетыСФондами.ВидДвижения = &парамПриход
	|	И ОПВРРасчетыСФондами.ВидСтроки = &парамИсчисление
	|{ГДЕ
	|	ОПВРРасчетыСФондами.Организация.* КАК Организация,
	|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	ОПВРРасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	ОПВРРасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	ОПВРРасчетыСФондами.ВидПлатежа КАК ВидПлатежа
	|}
	|СГРУППИРОВАТЬ ПО
	|	ОПВРРасчетыСФондами.ВидПлатежа,
	|	ОПВРРасчетыСФондами.ФизЛицо,	
	|	ОПВРРасчетыСФондами.Организация,
	|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница,
	|	ОПВРРасчетыСФондами.Налогоплательщик,
	|	НАЧАЛОПЕРИОДА(ОПВРРасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ),
	|	ОПВРРасчетыСФондами.ДатаНачала,
	|	ОПВРРасчетыСФондами.ДатаОкончания,
	|	ОПВРРасчетыСФондами.Регистратор
	|";
	
	// Окончательный текст запроса
	ТекстЗапроса = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	РасчетыСФондами.Вид КАК ВидВзносаОтчисления,
	|	РасчетыСФондами.ВидПлатежа,
	|	РасчетыСФондами.ФизЛицо,
	|	РасчетыСФондами.Организация,
	|	РасчетыСФондами.СтруктурнаяЕдиница,
	|	РасчетыСФондами.Налогоплательщик,
	|	РасчетыСФондами.МесяцНалоговогоПериода,
	|	ВЫБОР
	|		КОГДА РасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|			ТОГДА ""Автоматический расчет""
	|		ИНАЧЕ ""Ручной ввод""
	|	КОНЕЦ КАК СпособРасчетаПени,
	|	РасчетыСФондами.ДатаНачала,
	|	РасчетыСФондами.ДатаОкончания,
	|	ВЫБОР
	|		КОГДА РасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|			ТОГДА РАЗНОСТЬДАТ(РасчетыСФондами.ДатаНачала, РасчетыСФондами.ДатаОкончания, ДЕНЬ) + 1
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ДнейПросрочки,
	|	ВЫБОР  
	|		КОГДА РасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|			ТОГДА РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(РасчетыСФондами.ДатаНачала, ГОД), КОНЕЦПЕРИОДА(РасчетыСФондами.ДатаНачала, ГОД), ДЕНЬ) + 1
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ДнейВГоду,
	|	РасчетыСФондами.ФактСуммаПени,
	|	ЕСТЬNULL(ПросроченнаяЗадолженность.Сумма, 0) КАК СуммаПросроченнойЗадолженности,
	|	ЕСТЬNULL(ПараметрыРасчета.СтавкаРефинансирования, 0) КАК СтавкаРефинансирования,
	|	ЕСТЬNULL(ПараметрыРасчета.Коэффициент, 0) КАК КоэффициентСтавкиРефинансирования
	|
	|{ВЫБРАТЬ
	|	РасчетыСФондами.Вид КАК ВидВзносаОтчисления,
	|	РасчетыСФондами.ВидПлатежа,
	|	РасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	РасчетыСФондами.Организация.* КАК Организация,
	|	РасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	РасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	РасчетыСФондами.МесяцНалоговогоПериода,
	|	ВЫБОР
	|		КОГДА РасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|			ТОГДА ""Автоматический расчет""
	|		ИНАЧЕ ""Ручной ввод""
	|	КОНЕЦ КАК СпособРасчетаПени,
	|	РасчетыСФондами.ДатаНачала,
	|	РасчетыСФондами.ДатаОкончания,
	|	РасчетыСФондами.Регистратор
	|	//СВОЙСТВА
	|}
	|
	|ИЗ
	|	(" + РасчетыСФондамиТекст + ") КАК РасчетыСФондами
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + ПросроченнаяЗадолженностьТекст + ") КАК ПросроченнаяЗадолженность
	|		ПО РасчетыСФондами.Вид = ПросроченнаяЗадолженность.Вид
	|			И РасчетыСФондами.ДатаНачала = ПросроченнаяЗадолженность.Период
	|			И РасчетыСФондами.ФизЛицо = ПросроченнаяЗадолженность.ФизЛицо
	|			И РасчетыСФондами.Организация = ПросроченнаяЗадолженность.Организация
	|			И РасчетыСФондами.СтруктурнаяЕдиница = ПросроченнаяЗадолженность.СтруктурнаяЕдиница
	|			И РасчетыСФондами.Налогоплательщик = ПросроченнаяЗадолженность.Налогоплательщик
	|			И РасчетыСФондами.МесяцНалоговогоПериода = ПросроченнаяЗадолженность.МесяцНалоговогоПериода
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (" + ЗначенияПараметровРасчетаТекст + ") КАК ПараметрыРасчета
	|		ПО РасчетыСФондами.Вид = ПараметрыРасчета.Вид
	|			И РасчетыСФондами.Организация = ПараметрыРасчета.Организация
	|			И РасчетыСФондами.ДатаНачала = ПараметрыРасчета.Период
	|	//СОЕДИНЕНИЯ
	|{ГДЕ
	|	РасчетыСФондами.Организация.* КАК Организация,
	|	РасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	РасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	РасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	НАЧАЛОПЕРИОДА(РасчетыСФондами.МесяцНалоговогоПериода, МЕСЯЦ) КАК МесяцНалоговогоПериода,
	|	РасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
	|	РасчетыСФондами.Вид.* КАК ВидВзносаОтчисления,
	|	РасчетыСФондами.Регистратор
	|	//СВОЙСТВА
	|	//КАТЕГОРИИ
	|}
	|
	|{УПОРЯДОЧИТЬ ПО
	|	РасчетыСФондами.Вид.* КАК ВидВзносаОтчисления,
	|	РасчетыСФондами.ВидПлатежа,
	|	РасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	РасчетыСФондами.Организация.* КАК Организация,
	|	РасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	РасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	РасчетыСФондами.МесяцНалоговогоПериода,
	|	ВЫБОР
	|		КОГДА РасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|			ТОГДА ""Автоматический расчет""
	|		ИНАЧЕ ""Ручной ввод""
	|	КОНЕЦ КАК СпособРасчетаПени,
	|	РасчетыСФондами.ДатаНачала,
	|	РасчетыСФондами.ДатаОкончания,
	|	РасчетыСФондами.Регистратор
	|	//СВОЙСТВА
	|}
	|
	|ИТОГИ 
	|	СУММА(ФактСуммаПени)
	|ПО ОБЩИЕ
	|
	|{ИТОГИ ПО
	|	РасчетыСФондами.Вид.* КАК ВидВзносаОтчисления,
	|	РасчетыСФондами.ВидПлатежа,
	|	РасчетыСФондами.ФизЛицо.* КАК ФизЛицо,
	|	РасчетыСФондами.Организация.* КАК Организация,
	|	РасчетыСФондами.СтруктурнаяЕдиница.* КАК СтруктурнаяЕдиница,
	|	РасчетыСФондами.Налогоплательщик.* КАК Налогоплательщик,
	|	РасчетыСФондами.МесяцНалоговогоПериода,
	|	ВЫБОР
	|		КОГДА РасчетыСФондами.ДатаНачала <> &парамПустаяДата
	|			ТОГДА ""Автоматический расчет""
	|		ИНАЧЕ ""Ручной ввод""
	|	КОНЕЦ КАК СпособРасчетаПени,
	|	РасчетыСФондами.Регистратор
	|	//СВОЙСТВА
	|}
	|";
	
	ПостроительОтчета.Текст = ТекстЗапроса;							  
							  
	//представление полей запроса
	СтруктураПредставлениеПолей.Вставить("ФизЛицо", "Сотрудник");
	СтруктураПредставлениеПолей.Вставить("МесяцНалоговогоПериода", "Месяц налогового периода");
	СтруктураПредставлениеПолей.Вставить("ВидПлатежа", "Вид платежа");
	СтруктураПредставлениеПолей.Вставить("ВидВзносаОтчисления", "Взнос, отчисление");
	СтруктураПредставлениеПолей.Вставить("СпособРасчетаПени", "Способ расчета пени");
	СтруктураПредставлениеПолей.Вставить("ДатаНачала", "Дата начала периода расчета");
	СтруктураПредставлениеПолей.Вставить("ДатаОкончания", "Дата окончания периода расчета");
	СтруктураПредставлениеПолей.Вставить("СтруктурнаяЕдиница", "Структурная единица");
	
	Если ОбщийОтчет.ИспользоватьСвойстваИКатегории Тогда
		
		// Свойства и категории, назначаемые пользователем:
		ТаблицаПолей = Новый ТаблицаЗначений;
		ТаблицаПолей.Колонки.Добавить("ПутьКДанным");  // описание поля запроса поля, для которого добавляются свойства и категории. Используется в условии соединения с регистром сведений, хранящим значения свойств или категорий
		ТаблицаПолей.Колонки.Добавить("Представление");// представление поля, для которого добавляются свойства и категории. 
		ТаблицаПолей.Колонки.Добавить("Назначение");   // назначение свойств/категорий объектов для данного поля
		ТаблицаПолей.Колонки.Добавить("ТипЗначения");  // тип значения поля, для которого добавляются свойства и категории. Используется, если не установлено назначение
		ТаблицаПолей.Колонки.Добавить("НетКатегорий"); // признак НЕиспользования категорий для объекта
		
		НоваяСтрока = ТаблицаПолей.Добавить();
		НоваяСтрока.ПутьКДанным = "РасчетыСФондами.ФизЛицо";
		НоваяСтрока.Представление = "Сотрудник";
		НоваяСтрока.Назначение = ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ФизическиеЛица;
			
		
		НоваяСтрока = ТаблицаПолей.Добавить();
		НоваяСтрока.ПутьКДанным = "РасчетыСФондами.Организация";
		НоваяСтрока.Представление = "Организация";
		НоваяСтрока.Назначение = ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_Организации;
		
		// Добавим строки запроса, необходимые для использования свойств и категорий
		ТекстПоляКатегорий = "";
		ТекстПоляСвойств = "";
		
		УправлениеОтчетами.ДобавитьВТекстСвойстваИКатегории(ТаблицаПолей, ТекстЗапроса, СтруктураПредставлениеПолей, 
		ОбщийОтчет.мСоответствиеНазначений, ПостроительОтчета.Параметры
		,, ТекстПоляКатегорий, ТекстПоляСвойств,,,,,,ОбщийОтчет.мСтруктураДляОтбораПоКатегориям);		
		
		ПостроительОтчета.Текст = ТекстЗапроса;
				
		УправлениеОтчетами.УстановитьТипыЗначенийСвойствИКатегорийДляОтбора(ПостроительОтчета, ТекстПоляКатегорий, ТекстПоляСвойств, ОбщийОтчет.мСоответствиеНазначений, СтруктураПредставлениеПолей);
		
	КонецЕсли;

	УправлениеОтчетами.ЗаполнитьПредставленияПолей(СтруктураПредставлениеПолей, ПостроительОтчета);
	
	// формат полей
	ОбщийОтчет.СтруктураФорматаПолей.Вставить("МесяцНалоговогоПериода", "ДФ='ММММ гггг'");
	ОбщийОтчет.СтруктураФорматаПолей.Вставить("ДатаНачала", "ДФ='дд.ММ.гггг'");
	ОбщийОтчет.СтруктураФорматаПолей.Вставить("ДатаОкончания", "ДФ='дд.ММ.гггг'");
	
	// группировки по умолчанию
	ПостроительОтчета.ИзмеренияСтроки.Добавить("Организация");
	ПостроительОтчета.ИзмеренияСтроки.Добавить("ВидВзносаОтчисления");
	ПостроительОтчета.ИзмеренияСтроки.Добавить("СпособРасчетаПени");
	ПостроительОтчета.ИзмеренияСтроки.Добавить("ФизЛицо");
	
	// список показателей и форматы их представления
	ОбщийОтчет.ЗаполнитьПоказатели("СуммаПросроченнойЗадолженности", "Задолженность на дату начала", Истина, "ЧЦ=15; ЧДЦ=2");
	ОбщийОтчет.ЗаполнитьПоказатели("КоэффициентСтавкиРефинансирования", "Коэффициент", Истина, "ЧЦ=15; ЧДЦ=2");	
	ОбщийОтчет.ЗаполнитьПоказатели("СтавкаРефинансирования", "Ставка рефинан-ния", Истина, "ЧЦ=15; ЧДЦ=2");	
	ОбщийОтчет.ЗаполнитьПоказатели("ДнейПросрочки", "Дней просрочки", Истина, "ЧЦ=15");
	ОбщийОтчет.ЗаполнитьПоказатели("ДнейВГоду", "Дней в году", Истина, "ЧЦ=15");
	ОбщийОтчет.ЗаполнитьПоказатели("ФактСуммаПени", "Сумма пени", Истина, "ЧЦ=15; ЧДЦ=2");
	
	// отборы по умолчанию
	МассивОтбора = Новый Массив;
	МассивОтбора.Добавить("Организация");
	МассивОтбора.Добавить("ВидВзносаОтчисления");
	МассивОтбора.Добавить("ФизЛицо");
	УправлениеОтчетами.ЗаполнитьОтбор(МассивОтбора, ПостроительОтчета);
	
	// поля по умолчанию
	ПостроительОтчета.ВыбранныеПоля.Очистить();
	ПостроительОтчета.ВыбранныеПоля.Добавить("МесяцНалоговогоПериода");
	ПостроительОтчета.ВыбранныеПоля.Добавить("ДатаНачала");
	ПостроительОтчета.ВыбранныеПоля.Добавить("ДатаОкончания");
	
	// сортировка по умолчанию
	ПостроительОтчета.Порядок.Добавить("Организация.Наименование");
	ПостроительОтчета.Порядок.Добавить("ФизЛицо.Наименование");
	ПостроительОтчета.Порядок.Добавить("МесяцНалоговогоПериода");
	ПостроительОтчета.Порядок.Добавить("ДатаНачала");
	ПостроительОтчета.Порядок.Добавить("ДатаОкончания");

	УправлениеОтчетами.УпорядочитьПоляПостроителяОтчета(ПостроительОтчета);
	
	// настройки отчета
	ОбщийОтчет.РаскрашиватьИзмерения = Истина;
	ОбщийОтчет.ВыводитьИтогиПоВсемУровням = Истина;
	ОбщийОтчет.ВыводитьПоказателиВСтроку = Истина;
	ОбщийОтчет.мРежимВводаПериода = 0; // произвольный период
	
КонецПроцедуры

// Выполняет запрос и формирует табличный документ-результат отчета
// в соответствии с настройками, заданными значениями реквизитов отчета.
//
// Параметры:
//	ДокументРезультат - табличный документ, формируемый отчетом,
//	ЕстьОшибки - флаг того, что при формировании произошли ошибки
//
//Процедура СформироватьОтчет(ДокументРезультат, ЕстьОшибки = Ложь) Экспорт
Процедура СформироватьОтчет(ДокументРезультат, ПоказыватьЗаголовок = Ложь, ВысотаЗаголовка = 0, ТолькоЗаголовок = Ложь) Экспорт

	МассивВидовПлатежейПени = Новый Массив();
	МассивВидовПлатежейПени.Добавить(Перечисления.ВидыПлатежейВБюджетИФонды.ПениАкт);
	МассивВидовПлатежейПени.Добавить(Перечисления.ВидыПлатежейВБюджетИФонды.ПениСам);
	
	МассивВидовПлатежейНалог = Новый Массив();
	МассивВидовПлатежейНалог.Добавить(Перечисления.ВидыПлатежейВБюджетИФонды.Налог);
	МассивВидовПлатежейНалог.Добавить(Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт);
	МассивВидовПлатежейНалог.Добавить(Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам);

	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамВидыПлатежейПени", МассивВидовПлатежейПени);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамВидыПлатежейНалог", МассивВидовПлатежейНалог);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамПустаяОрганизация", Справочники.Организации.ПустаяСсылка());
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамВидОПВ", Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамВидСО", Справочники.НалогиСборыОтчисления.ОбязательныеСоциальныеОтчисления);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамВидООСМС", Справочники.НалогиСборыОтчисления.ОтчисленияОбязательноеСоциальноеМедицинскоеСтрахование);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамВидВОСМС", Справочники.НалогиСборыОтчисления.ВзносыОбязательноеСоциальноеМедицинскоеСтрахование);
   	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамВидОППВ", Справочники.НалогиСборыОтчисления.ОбязательныеПрофессиональныеПенсионныеВзносы);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамВидОПВР", Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносыРаботодателя);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамПриход", ВидДвиженияНакопления.Приход);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамИсчисление", Перечисления.РасчетыСБюджетомФондамиВидСтроки.Исчисление);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамПустаяДата", '00010101');
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамПоМесяцуВыплатыДоходов", Перечисления.ПорядокОпределенияСрокаПеречисления.ПоМесяцуВыплатыДоходов);
	ОбщийОтчет.ПостроительОтчета.Параметры.Вставить("парамПоМесяцуНалоговогоПериода", Перечисления.ПорядокОпределенияСрокаПеречисления.ПоМесяцуНалоговогоПериода);

	ОбщийОтчет.СформироватьОтчет(ДокументРезультат, ПоказыватьЗаголовок, ВысотаЗаголовка, ТолькоЗаголовок);

КонецПроцедуры

#КонецЕсли