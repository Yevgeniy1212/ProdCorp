Перем ДанныеРасшифровки Экспорт;
Перем СохраненнаяНастройка Экспорт;

Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	УстановитьПривилегированныйРежим(Истина);
	Для Каждого Реквизит Из Метаданные().Реквизиты Цикл
		//Если Реквизит.Имя = "Период" Тогда
		//	Продолжить;
		//КонецЕсли;
		КомпоновщикНастроек.Настройки.ПараметрыДанных.УстановитьЗначениеПараметра(Реквизит.Имя,?(Реквизит.Имя="КонецПериода",КонецДня(КонецПериода),ЭтотОбъект[Реквизит.Имя]));
	КонецЦикла;
	Отчеты.дог_АнализЗадолженностиБУПоДоговоруВРазрезеПериодов.ДоработатьКомпоновщикПередВыводом(КомпоновщикНастроек,ОтображатьДанныеПоПодчиненнымДоговорамКонтрагента,ДоговорКонтрагента);
	Набор = СхемаКомпоновкиДанных.НаборыДанных.Найти("Основной");
	Набор.Запрос = СтрЗаменить(Набор.Запрос,"МЕСЯЦ",ПериодичностьОтчета);
	Набор.Запрос = СтрЗаменить(Набор.Запрос,"Месяц",ПериодичностьОтчета);
	СтандартнаяОбработка = Ложь;
	////Вывод
	КомпоновщикМакетаСКД = Новый КомпоновщикМакетаКомпоновкиДанных();
	ДанныеРасшифровки = Новый ДанныеРасшифровкиКомпоновкиДанных;
	МакетСКД = КомпоновщикМакетаСКД.Выполнить(СхемаКомпоновкиДанных,КомпоновщикНастроек.ПолучитьНастройки(),ДанныеРасшифровки);
	
	ПроцессорСКД = Новый ПроцессорКомпоновкиДанных();
	ПроцессорСКД.Инициализировать(МакетСКД,,ДанныеРасшифровки,Истина);
	
	ПроцессорВыводаСКД = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент();
	ДокументРезультат.Очистить();
	ПроцессорВыводаСКД.УстановитьДокумент(ДокументРезультат);
	ПроцессорВыводаСКД.Вывести(ПроцессорСКД);
	
	УстановитьПривилегированныйРежим(Ложь);
КонецПроцедуры
 
Процедура Скомпоновать(ДокументРезультат) Экспорт
	СкомпоноватьРезультат(ДокументРезультат,ДанныеРасшифровки);	
КонецПроцедуры