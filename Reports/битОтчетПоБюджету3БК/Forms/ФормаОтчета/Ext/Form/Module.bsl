
&НаСервере
Процедура СформироватьНаСервере()
	
	
	#Область Запрос
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	БюджетОбороты.СтатьяБюджета КАК СтатьяБюджета,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 1
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЯнварь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 2
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаФевраль,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 3
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаМарт,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 4
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаАпрель,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 5
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаМай,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаИюнь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаИюль,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 8
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаАвгуст,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаСентябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаОктябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 11
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаНоябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаДекабрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 4
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаПервыйКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 3
		|				И МЕСЯЦ(БюджетОбороты.Период) < 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаВторойКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 6
		|				И МЕСЯЦ(БюджетОбороты.Период) < 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаТретийКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 9
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЧетвертыйКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЗаПолугодие,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЗаДевятьМесяцев,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|	КОНЕЦ КАК СуммаИтого,
		|	0 КАК СуммаПервПериод,
		|	0 КАК СуммаФактТриГодаНазад,
		|	0 КАК СуммаПредществующийГод,
		|	0 КАК СуммаПланПредыдущийГод,
		|	0 КАК СуммаФактПредыдущий,
		|	БюджетОбороты.ИсточникФинансирования КАК ИсточникФинансирования,
		|	БюджетОбороты.СтатьяБюджета.ФинансовыйПоказатель КАК ФинансовыйПоказатель
		|ПОМЕСТИТЬ Данные
		|ИЗ
		|	РегистрНакопления.б_Бюджет.Обороты(&Началопериода, &КонецПериода, Регистратор, ) КАК БюджетОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПредыдущий, &КонецПериодаПредыдущий, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПредществующий, &КонецПериодаПредществующий, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаТриГодаНазад, &КонецПериодаТриГодаНазад, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПервПериод, &КонецПериодаПервПериод, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетОбороты.СуммаОборот,
		|	0,
		|	б_БюджетОбороты.ИсточникФинансирования,
		|	б_БюджетОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_Бюджет.Обороты(&НачалоПериодаПредыдущий, &КонецПериодаПредыдущий, , ) КАК б_БюджетОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 1
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 2
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 3
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 4
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 5
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 6
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 8
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 9
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 11
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 12
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 4
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 3
		|				И МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 6
		|				И МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 9
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , Регистратор, ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий <> &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериода И &КонецПериода
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредыдущий И &КонецПериодаПредыдущий
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредществующий И &КонецПериодаПредществующий
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаТриГодаНазад И &КонецПериодаТриГодаНазад
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПервПериод И &КонецПериодаПервПериод
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий <> &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредыдущий И &КонецПериодаПредыдущий
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Данные.СтатьяБюджета,
		|	СУММА(Данные.СуммаЯнварь) КАК СуммаЯнварь,
		|	СУММА(Данные.СуммаФевраль) КАК СуммаФевраль,
		|	СУММА(Данные.СуммаМарт) КАК СуммаМарт,
		|	СУММА(Данные.СуммаАпрель) КАК СуммаАпрель,
		|	СУММА(Данные.СуммаМай) КАК СуммаМай,
		|	СУММА(Данные.СуммаИюнь) КАК СуммаИюнь,
		|	СУММА(Данные.СуммаИюль) КАК СуммаИюль,
		|	СУММА(Данные.СуммаАвгуст) КАК СуммаАвгуст,
		|	СУММА(Данные.СуммаСентябрь) КАК СуммаСентябрь,
		|	СУММА(Данные.СуммаОктябрь) КАК СуммаОктябрь,
		|	СУММА(Данные.СуммаНоябрь) КАК СуммаНоябрь,
		|	СУММА(Данные.СуммаДекабрь) КАК СуммаДекабрь,
		|	СУММА(Данные.СуммаПервыйКвартал) КАК СуммаПервыйКвартал,
		|	СУММА(Данные.СуммаВторойКвартал) КАК СуммаВторойКвартал,
		|	СУММА(Данные.СуммаТретийКвартал) КАК СуммаТретийКвартал,
		|	СУММА(Данные.СуммаЧетвертыйКвартал) КАК СуммаЧетвертыйКвартал,
		|	СУММА(Данные.СуммаЗаПолугодие) КАК СуммаЗаПолугодие,
		|	СУММА(Данные.СуммаЗаДевятьМесяцев) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(Данные.СуммаИтого) КАК СуммаИтого,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПервПериод, 0)) КАК СуммаПервПериод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаФактТриГодаНазад, 0)) КАК СуммаФактТриГодаНазад,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПредществующийГод, 0)) КАК СуммаПредществующийГод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПланПредыдущийГод, 0)) КАК СуммаПланПредыдущийГод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаФактПредыдущий, 0)) КАК СуммаФактПредыдущий,
		|	ВЫБОР
		|		КОГДА Данные.ИсточникФинансирования = ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.ПустаяСсылка)
		|			ТОГДА ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|		ИНАЧЕ Данные.ИсточникФинансирования
		|	КОНЕЦ КАК ИсточникФинансирования,
		|	Данные.ФинансовыйПоказатель
		|ПОМЕСТИТЬ ГруппированныеДанные
		|ИЗ
		|	Данные КАК Данные
		|
		|СГРУППИРОВАТЬ ПО
		|	Данные.СтатьяБюджета,
		|	ВЫБОР
		|		КОГДА Данные.ИсточникФинансирования = ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.ПустаяСсылка)
		|			ТОГДА ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|		ИНАЧЕ Данные.ИсточникФинансирования
		|	КОНЕЦ,
		|	Данные.ФинансовыйПоказатель
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ГруппированныеДанные.ФинансовыйПоказатель КАК СтатьяБюджета,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЯнварь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЯнварь
		|		КОНЕЦ) КАК СуммаЯнварь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаФевраль КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаФевраль
		|		КОНЕЦ) КАК СуммаФевраль,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаМарт КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаМарт
		|		КОНЕЦ) КАК СуммаМарт,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаАпрель КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаАпрель
		|		КОНЕЦ) КАК СуммаАпрель,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаМай КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаМай
		|		КОНЕЦ) КАК СуммаМай,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИюнь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИюнь
		|		КОНЕЦ) КАК СуммаИюнь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИюль КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИюль
		|		КОНЕЦ) КАК СуммаИюль,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаАвгуст КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаАвгуст
		|		КОНЕЦ) КАК СуммаАвгуст,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаСентябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаСентябрь
		|		КОНЕЦ) КАК СуммаСентябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаОктябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаОктябрь
		|		КОНЕЦ) КАК СуммаОктябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаНоябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаНоябрь
		|		КОНЕЦ) КАК СуммаНоябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаДекабрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаДекабрь
		|		КОНЕЦ) КАК СуммаДекабрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаПервыйКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаПервыйКвартал
		|		КОНЕЦ) КАК СуммаПервыйКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаВторойКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаВторойКвартал
		|		КОНЕЦ) КАК СуммаВторойКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаТретийКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаТретийКвартал
		|		КОНЕЦ) КАК СуммаТретийКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЧетвертыйКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЧетвертыйКвартал
		|		КОНЕЦ) КАК СуммаЧетвертыйКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЗаПолугодие КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЗаПолугодие
		|		КОНЕЦ) КАК СуммаЗаПолугодие,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЗаДевятьМесяцев КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЗаДевятьМесяцев
		|		КОНЕЦ) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИтого КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИтого
		|		КОНЕЦ) КАК СуммаИтого,
		|	ГруппированныеДанные.ФинансовыйПоказатель.КодСтрокиБюджета КАК КодБО,
		|	СУММА(ГруппированныеДанные.СуммаПервПериод) КАК СуммаПервПериод,
		|	СУММА(ГруппированныеДанные.СуммаФактТриГодаНазад) КАК СуммаФактТриГодаНазад,
		|	СУММА(ГруппированныеДанные.СуммаПредществующийГод) КАК СуммаПредществующийГод,
		|	СУММА(ГруппированныеДанные.СуммаПланПредыдущийГод) КАК СуммаПланПредыдущийГод,
		|	СУММА(ГруппированныеДанные.СуммаФактПредыдущий) КАК СуммаФактПредыдущий,
		|	ГруппированныеДанные.ИсточникФинансирования
		|ПОМЕСТИТЬ Итог
		|ИЗ
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	ГруппированныеДанные.ИсточникФинансирования,
		|	ГруппированныеДанные.ФинансовыйПоказатель,
		|	ГруппированныеДанные.ФинансовыйПоказатель.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Заемные)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.СредстваРеспубликанскогоБюджета)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Итог.СтатьяБюджета КАК СтатьяБюджета,
		|	ЕСТЬNULL(Итог.ИсточникФинансирования, ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)) КАК ИсточникФинансирования,
		|	СУММА(Итог.СуммаЯнварь) КАК СуммаЯнварь,
		|	СУММА(Итог.СуммаФевраль) КАК СуммаФевраль,
		|	СУММА(Итог.СуммаМарт) КАК СуммаМарт,
		|	СУММА(Итог.СуммаАпрель) КАК СуммаАпрель,
		|	СУММА(Итог.СуммаМай) КАК СуммаМай,
		|	СУММА(Итог.СуммаИюнь) КАК СуммаИюнь,
		|	СУММА(Итог.СуммаИюль) КАК СуммаИюль,
		|	СУММА(Итог.СуммаАвгуст) КАК СуммаАвгуст,
		|	СУММА(Итог.СуммаСентябрь) КАК СуммаСентябрь,
		|	СУММА(Итог.СуммаОктябрь) КАК СуммаОктябрь,
		|	СУММА(Итог.СуммаНоябрь) КАК СуммаНоябрь,
		|	СУММА(Итог.СуммаДекабрь) КАК СуммаДекабрь,
		|	СУММА(Итог.СуммаПервыйКвартал) КАК СуммаПервыйКвартал,
		|	СУММА(Итог.СуммаВторойКвартал) КАК СуммаВторойКвартал,
		|	СУММА(Итог.СуммаТретийКвартал) КАК СуммаТретийКвартал,
		|	СУММА(Итог.СуммаЧетвертыйКвартал) КАК СуммаЧетвертыйКвартал,
		|	СУММА(Итог.СуммаЗаПолугодие) КАК СуммаЗаПолугодие,
		|	СУММА(Итог.СуммаЗаДевятьМесяцев) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(Итог.СуммаИтого) КАК СуммаИтого,
		|	СУММА(Итог.СуммаПервПериод) КАК СуммаПервПериод,
		|	СУММА(Итог.СуммаФактТриГодаНазад) КАК СуммаФактТриГодаНазад,
		|	СУММА(Итог.СуммаПредществующийГод) КАК СуммаПредществующийГод,
		|	СУММА(Итог.СуммаПланПредыдущийГод) КАК СуммаПланПредыдущийГод,
		|	СУММА(Итог.СуммаФактПредыдущий) КАК СуммаФактПредыдущий,
		|	ЕСТЬNULL(Итог.ИсточникФинансирования.Код, ""000000003"") КАК КодИсточника,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПредществующийГод <> 0
		|				ТОГДА Итог.СуммаПланПредыдущийГод / Итог.СуммаПредществующийГод * 100
		|		КОНЕЦ) КАК СуммаПредыдущий,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПланПредыдущийГод <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаПланПредыдущийГод * 100
		|		КОНЕЦ) КАК СуммаИтогоФакт,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПредществующийГод <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаПредществующийГод * 100
		|		КОНЕЦ) КАК СуммаПланКФактуПредш,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаФактТриГодаНазад <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаФактТриГодаНазад * 100
		|		КОНЕЦ) КАК СуммаПредществующий,
		|	Итог.КодБО КАК КодБО
		|ИЗ
		|	Итог КАК Итог
		|
		|СГРУППИРОВАТЬ ПО
		|	Итог.СтатьяБюджета,
		|	ЕСТЬNULL(Итог.ИсточникФинансирования, ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)),
		|	ЕСТЬNULL(Итог.ИсточникФинансирования.Код, ""000000003""),
		|	Итог.КодБО
		|
		|УПОРЯДОЧИТЬ ПО
		|	КодБО,
		|	КодИсточника
		|ИТОГИ
		|	СУММА(СуммаЯнварь),
		|	СУММА(СуммаФевраль),
		|	СУММА(СуммаМарт),
		|	СУММА(СуммаАпрель),
		|	СУММА(СуммаМай),
		|	СУММА(СуммаИюнь),
		|	СУММА(СуммаИюль),
		|	СУММА(СуммаАвгуст),
		|	СУММА(СуммаСентябрь),
		|	СУММА(СуммаОктябрь),
		|	СУММА(СуммаНоябрь),
		|	СУММА(СуммаДекабрь),
		|	СУММА(СуммаПервыйКвартал),
		|	СУММА(СуммаВторойКвартал),
		|	СУММА(СуммаТретийКвартал),
		|	СУММА(СуммаЧетвертыйКвартал),
		|	СУММА(СуммаЗаПолугодие),
		|	СУММА(СуммаЗаДевятьМесяцев),
		|	СУММА(СуммаИтого),
		|	СУММА(СуммаПервПериод),
		|	СУММА(СуммаФактТриГодаНазад),
		|	СУММА(СуммаПредществующийГод),
		|	СУММА(СуммаПланПредыдущийГод),
		|	СУММА(СуммаФактПредыдущий),
		|	СУММА(СуммаПредыдущий),
		|	СУММА(СуммаИтогоФакт),
		|	СУММА(СуммаПланКФактуПредш),
		|	СУММА(СуммаПредществующий)
		|ПО
		|	ОБЩИЕ,
		|	СтатьяБюджета ТОЛЬКО ИЕРАРХИЯ
		|АВТОУПОРЯДОЧИВАНИЕ";
	
	#КОнецОбласти
	
	КапитальныеВложения = Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("КапитальныеВложения").Значение; 
	НачалоПериода       = Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("НачалоПериода").Значение.Дата;
	КонецПериода        = КонецДня(Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("КонецПериода").Значение);
	
	Запрос.УстановитьПараметр("КапитальныеВложения", КапитальныеВложения);
	Запрос.УстановитьПараметр("КонецПериода", КонецПериода);
	Запрос.УстановитьПараметр("Началопериода", НачалоПериода);
	Запрос.УстановитьПараметр("ОкруглятьДоЦелых", Истина);
	
	Запрос.УстановитьПараметр("НачалоПериодаПредыдущий", ДобавитьМесяц(НачалоГода(НачалоПериода), -12));
	Запрос.УстановитьПараметр("КонецПериодаПредыдущий", ДобавитьМесяц(КонецГода(КонецПериода), -12));
	Запрос.УстановитьПараметр("НачалоПериодаПредществующий", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*2));
	Запрос.УстановитьПараметр("КонецПериодаПредществующий", ДобавитьМесяц(КонецГода(КонецПериода), -12*2));
	Запрос.УстановитьПараметр("НачалоПериодаТриГодаНазад", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*3));
	Запрос.УстановитьПараметр("КонецПериодаТриГодаНазад", ДобавитьМесяц(КонецГода(КонецПериода), -12*3));
	Запрос.УстановитьПараметр("НачалоПериодаПервПериод", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*4));
	Запрос.УстановитьПараметр("КонецПериодаПервПериод", ДобавитьМесяц(КонецГода(КонецПериода), -12*4));

	Запрос.УстановитьПараметр("СценарийФакт", Справочники.СценарииПланирования.Факт);

	
	Если ЭтотОбъект.Отчет.ПоКварталам = Истина Тогда
		Макет = Отчеты.битОтчетПоБюджету3БК.ПолучитьМакет("ПоКварталам");
	Иначе
		Макет = Отчеты.битОтчетПоБюджету3БК.ПолучитьМакет("Макет");
	КонецЕсли;
	
		
	ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
	ОбластьШапкаТаблицы = Макет.ПолучитьОбласть("Шапка");
	ОбластьГруппа = Макет.ПолучитьОбласть("Группа");
	ОбластьГруппаОС = Макет.ПолучитьОбласть("ГруппаОС");
	ОбластьСтрокаОС = Макет.ПолучитьОбласть("СтрокаОС");
	
	ОбластьСтрокаИсточникиИтог = Макет.ПолучитьОбласть("СтрокаИсточникиИтог");
	ОбластьСтрокаИсточникиИтог2 = Макет.ПолучитьОбласть("СтрокаИсточникиИтог");

	ОбластьСтрокаИсточникиЗаемные = Макет.ПолучитьОбласть("СтрокаИсточникиЗаемные");
	ОбластьСтрокаИсточникиРБ = Макет.ПолучитьОбласть("СтрокаИсточникиРБ");
	ОбластьСтрокаИсточникиСобственные = Макет.ПолучитьОбласть("СтрокаИсточникиСобственные");

	ОбластьГруппаИтог = Макет.ПолучитьОбласть("ГруппаИтог");
	
	ОбластьГруппаЗаемные = Макет.ПолучитьОбласть("ГруппаЗаемные");
	ОбластьГруппаРБ = Макет.ПолучитьОбласть("ГруппаРБ");
	ОбластьГруппаСобственные = Макет.ПолучитьОбласть("ГруппаСобственные");
	
	ОбластьГруппаВТомЧисле = Макет.ПолучитьОбласть("СтрокаВТомЧисле");

	Результат.Очистить();
	
	ТекущГод = Год(НачалоПериода);

	ОбластьШапкаТаблицы.Параметры.ПериодФормирования = "на " + Формат(ТекущГод,"ЧГ=0") + " год";
	ОбластьШапкаТаблицы.Параметры.ТекущГод = Формат(ТекущГод,"ЧГ=0");

	ОбластьШапкаТаблицы.Параметры.ПланКФактуПредыдущий     = "План " + Формат(ТекущГод,"ЧГ=0")+ " года к факту "+ Формат(ТекущГод-1,"ЧГ=0") +" года, %";;
	ОбластьШапкаТаблицы.Параметры.ПланКФактуПредществующий = "План " + Формат(ТекущГод,"ЧГ=0")+ " года к факту "+ Формат(ТекущГод-2,"ЧГ=0") +" года, %";
	ОбластьШапкаТаблицы.Параметры.ПланКФактуТриГодаНазад   = "План " + Формат(ТекущГод,"ЧГ=0")+ " года к факту "+ Формат(ТекущГод-3,"ЧГ=0") +" года, %";
	
	ОбластьШапкаТаблицы.Параметры.ПервПериод = Формат(ДобавитьМесяц(НачалоГода(НачалоПериода), -12*3), "ДФ=""дд.ММ.гггг""");
	ОбластьШапкаТаблицы.Параметры.ФактТриГодаНазад = "" + Формат(ДобавитьМесяц(НачалоГода(НачалоПериода), -12*3), "ДФ=""гггг""");
	ОбластьШапкаТаблицы.Параметры.ПредществующийГод = "" + Формат(ДобавитьМесяц(НачалоГода(НачалоПериода), -12*2), "ДФ=""гггг""");
	ОбластьШапкаТаблицы.Параметры.ПредыдущийГод = "" + Формат(ДобавитьМесяц(НачалоГода(НачалоПериода), -12*1), "ДФ=""гггг""");

	Если (ТекущГод - 1) = 2016 ИЛИ (ТекущГод - 1) = 2017 ИЛИ (ТекущГод - 1) = 2018 Тогда
		ОбластьШапкаТаблицы.Параметры.ОценкаФакт = "факт";
	Иначе
		ОбластьШапкаТаблицы.Параметры.ОценкаФакт = "факт";
	КонецЕсли;

	Если (ТекущГод - 1) = 2019 Тогда
		ОбластьШапкаТаблицы.Параметры.ПланКорректировка = "план (корректировка, оценка)";
	Иначе
		ОбластьШапкаТаблицы.Параметры.ПланКорректировка = "план";
	КонецЕсли;


	Результат.Вывести(ОбластьШапкаТаблицы);
	Результат.НачатьАвтогруппировкуСтрок();
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаОбщийИтог = РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	МассивСтатей = Новый Массив;
	МассивСтатейПоИсточникам = Новый Массив;

	Итератор = 0;
	Пока ВыборкаОбщийИтог.Следующий() Цикл		
	
		ВыборкаСтатьяБюджета = ВыборкаОбщийИтог.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаСтатьяБюджета.Следующий() Цикл
			
			Если ВыборкаСтатьяБюджета.СтатьяБюджета.Код = "000000001" ИЛИ ВыборкаСтатьяБюджета.СтатьяБюджета.Код = "ПРПР00623" ИЛИ МассивСтатей.Найти(ВыборкаСтатьяБюджета.СтатьяБюджета) <> Неопределено Тогда
				Продолжить;
			КонецЕсли;
			
			МассивСтатей.Добавить(ВыборкаСтатьяБюджета.СтатьяБюджета);
			
			Если ВыборкаСтатьяБюджета.СтатьяБюджета.Наименование = "Всего инвестиций" Тогда
				ОбластьГруппаИтог.Параметры.Заполнить(ВыборкаСтатьяБюджета);
				Результат.Вывести(ОбластьГруппаИтог, ВыборкаСтатьяБюджета.Уровень());
			Иначе
				
				Если ВыборкаСтатьяБюджета.СтатьяБюджета.Класс = Истина Тогда
					
					ОбластьГруппаВТомЧисле.Параметры.Заполнить(ВыборкаСтатьяБюджета);
					Результат.Вывести(ОбластьГруппаВТомЧисле, ВыборкаСтатьяБюджета.Уровень());

				ИначеЕсли ВыборкаСтатьяБюджета.СтатьяБюджета.Категория2Уровня = Истина Тогда
					
					ОбластьГруппаОС.Параметры.Заполнить(ВыборкаСтатьяБюджета);
					ОбластьГруппаОС.Параметры.ГруппаОС = ВыборкаСтатьяБюджета.СтатьяБюджета;
					
					Результат.Вывести(ОбластьГруппаОС, ВыборкаСтатьяБюджета.Уровень());

				Иначе
					
					ОбластьГруппа.Параметры.Заполнить(ВыборкаСтатьяБюджета);
					ОбластьГруппа.Параметры.ГруппаВерхУровня = ВыборкаСтатьяБюджета.СтатьяБюджета;
					ОбластьГруппа.Параметры.КодСтроки = ВыборкаСтатьяБюджета.СтатьяБюджета.КодСтрокиБюджета;    
					Результат.Вывести(ОбластьГруппа, ВыборкаСтатьяБюджета.Уровень());
					
				КонецЕсли;
				
			КонецЕсли;
						
			ВыборкаДетальныеЗаписи = ВыборкаСтатьяБюджета.Выбрать();
			
			Итератор2 = 0;
			ИтогоПоГруппе = 0;
			
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				
				Если ВыборкаДетальныеЗаписи.СтатьяБюджета.Наименование = "Всего инвестиций" Тогда

					Если ВыборкаДетальныеЗаписи.ИсточникФинансирования = Справочники.битИсточникиФинансирования.Заемные Тогда
						Область = ОбластьГруппаЗаемные;
					ИначеЕсли ВыборкаДетальныеЗаписи.ИсточникФинансирования = Справочники.битИсточникиФинансирования.собственные Тогда
						Область = ОбластьГруппаСобственные;
					ИначеЕсли ВыборкаДетальныеЗаписи.ИсточникФинансирования = Справочники.битИсточникиФинансирования.СредстваРеспубликанскогоБюджета Тогда
						Область = ОбластьГруппаРБ;
						Область.Параметры.ГруппаВерхУровня = ВыборкаДетальныеЗаписи.СтатьяБюджета;
						Область.Параметры.КодСтроки = ВыборкаДетальныеЗаписи.СтатьяБюджета.КодСтрокиБюджета;
					КонецЕсли;
					
					РасчетИтогаПоИсточнику(ВыборкаДетальныеЗаписи.СтатьяБюджета, Макет, Результат, ВыборкаДетальныеЗаписи.ИсточникФинансирования, Область);
					//Область.Параметры.Заполнить(ВыборкаДетальныеЗаписи);
					//Результат.Вывести(Область, ВыборкаДетальныеЗаписи.Уровень());
				КонецЕсли;

				//Если ВыборкаДетальныеЗаписи.СтатьяБюджета.Родитель.Наименование = "Всего инвестиций" Тогда
				
				Если ВыборкаДетальныеЗаписи.СтатьяБюджета.Подкласс = Ложь Тогда
					
					Если ВыборкаДетальныеЗаписи.СтатьяБюджета.ЭтоГруппа = Истина Тогда
						 Продолжить;
					КонецЕсли;
					
					Если МассивСтатейПоИсточникам.Найти(ВыборкаДетальныеЗаписи.СтатьяБюджета) = Неопределено Тогда
						РасчетИтога(ВыборкаДетальныеЗаписи.СтатьяБюджета, Макет, Результат);
					КонецЕсли;
						
					МассивСтатейПоИсточникам.Добавить(ВыборкаДетальныеЗаписи.СтатьяБюджета);
					 															
					Если ВыборкаДетальныеЗаписи.ИсточникФинансирования = Справочники.битИсточникиФинансирования.Заемные Тогда
						Область = ОбластьСтрокаИсточникиЗаемные;
					ИначеЕсли ВыборкаДетальныеЗаписи.ИсточникФинансирования = Справочники.битИсточникиФинансирования.Собственные Тогда
						Область = ОбластьСтрокаИсточникиСобственные;
					ИначеЕсли ВыборкаДетальныеЗаписи.ИсточникФинансирования = Справочники.битИсточникиФинансирования.СредстваРеспубликанскогоБюджета Тогда
						Область = ОбластьСтрокаИсточникиРБ;
						Область.Параметры.СтрокаПоИсточникам = ВыборкаДетальныеЗаписи.СтатьяБюджета;
						Область.Параметры.КодСтроки = ВыборкаДетальныеЗаписи.СтатьяБюджета.КодСтрокиБюджета;
					КонецЕсли;
					  					
					Область.Параметры.Заполнить(ВыборкаДетальныеЗаписи);
					Результат.Вывести(Область, ВыборкаДетальныеЗаписи.Уровень());
					    
				Иначе 
					
					Если ВыборкаДетальныеЗаписи.ИсточникФинансирования <> Справочники.битИсточникиФинансирования.Собственные  Тогда
						Продолжить;
					КонецЕсли;
					
					Если МассивСтатей.Найти(ВыборкаДетальныеЗаписи.СтатьяБюджета) <> Неопределено  Тогда
						Продолжить;
					КонецЕсли;

					ОбластьСтрокаОС.Параметры.Заполнить(ВыборкаДетальныеЗаписи);
					ОбластьСтрокаОС.Параметры.СТрокаОС = ВыборкаДетальныеЗаписи.СтатьяБюджета;
					Результат.Вывести(ОбластьСтрокаОС, ВыборкаДетальныеЗаписи.Уровень());
					
					МассивСтатей.Добавить(ВыборкаДетальныеЗаписи.СтатьяБюджета);

				КонецЕсли;
	
				КонецЦикла;
			КонецЦикла;
		
		КонецЦикла;
	
	Результат.ЗакончитьАвтогруппировкуСтрок();
	
	Результат.ФиксацияСлева = 4;
	
	Результат.ФиксацияСверху = 8;

	
	ОбластьПодвал.Параметры.Руководитель = ОбщегоНазначения.ФамилияИнициалыФизЛица(Справочники.бит_ОтветственныеЛицаБюджет.РуководительОрганизации.Сотрудник.Физлицо);
	ОбластьПодвал.Параметры.РуководительДолжность = Справочники.бит_ОтветственныеЛицаБюджет.РуководительОрганизации.Должность;
	ОбластьПодвал.Параметры.РуководительФД = ОбщегоНазначения.ФамилияИнициалыФизЛица(Справочники.бит_ОтветственныеЛицаБюджет.РуководительФД.Сотрудник.Физлицо);
	ОбластьПодвал.Параметры.РуководительФДДолжность = Справочники.бит_ОтветственныеЛицаБюджет.РуководительФД.Должность;
	ОбластьПодвал.Параметры.Исполнитель = ОбщегоНазначения.ФамилияИнициалыФизЛица(Справочники.бит_ОтветственныеЛицаБюджет.Исполнитель.Сотрудник.Физлицо);
	ОбластьПодвал.Параметры.Телефон = Справочники.бит_ОтветственныеЛицаБюджет.Исполнитель.Комментарий;


	Результат.Вывести(ОбластьПодвал);

КонецПроцедуры

Процедура РасчетИтога(СтатьяБюджета, Макет, Результат)
	
		
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	БюджетОбороты.СтатьяБюджета КАК СтатьяБюджета,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 1
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЯнварь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 2
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаФевраль,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 3
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаМарт,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 4
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаАпрель,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 5
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаМай,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаИюнь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаИюль,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 8
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаАвгуст,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаСентябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаОктябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 11
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаНоябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаДекабрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 4
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаПервыйКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 3
		|				И МЕСЯЦ(БюджетОбороты.Период) < 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаВторойКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 6
		|				И МЕСЯЦ(БюджетОбороты.Период) < 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаТретийКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 9
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЧетвертыйКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЗаПолугодие,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЗаДевятьМесяцев,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|	КОНЕЦ КАК СуммаИтого,
		|	0 КАК СуммаПервПериод,
		|	0 КАК СуммаФактТриГодаНазад,
		|	0 КАК СуммаПредществующийГод,
		|	0 КАК СуммаПланПредыдущийГод,
		|	0 КАК СуммаФактПредыдущий,
		|	БюджетОбороты.ИсточникФинансирования КАК ИсточникФинансирования,
		|	БюджетОбороты.СтатьяБюджета.ФинансовыйПоказатель КАК ФинансовыйПоказатель
		|ПОМЕСТИТЬ Данные
		|ИЗ
		|	РегистрНакопления.б_Бюджет.Обороты(&Началопериода, &КонецПериода, Регистратор, ) КАК БюджетОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПредыдущий, &КонецПериодаПредыдущий, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПредществующий, &КонецПериодаПредществующий, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаТриГодаНазад, &КонецПериодаТриГодаНазад, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПервПериод, &КонецПериодаПервПериод, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетОбороты.СуммаОборот,
		|	0,
		|	б_БюджетОбороты.ИсточникФинансирования,
		|	б_БюджетОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_Бюджет.Обороты(&НачалоПериодаПредыдущий, &КонецПериодаПредыдущий, , ) КАК б_БюджетОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 1
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 2
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 3
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 4
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 5
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 6
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 8
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 9
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 11
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 12
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 4
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 3
		|				И МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 6
		|				И МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 9
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , Регистратор, ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий <> &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериода И &КонецПериода
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредыдущий И &КонецПериодаПредыдущий
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредществующий И &КонецПериодаПредществующий
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаТриГодаНазад И &КонецПериодаТриГодаНазад
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПервПериод И &КонецПериодаПервПериод
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий <> &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредыдущий И &КонецПериодаПредыдущий
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Данные.СтатьяБюджета,
		|	СУММА(Данные.СуммаЯнварь) КАК СуммаЯнварь,
		|	СУММА(Данные.СуммаФевраль) КАК СуммаФевраль,
		|	СУММА(Данные.СуммаМарт) КАК СуммаМарт,
		|	СУММА(Данные.СуммаАпрель) КАК СуммаАпрель,
		|	СУММА(Данные.СуммаМай) КАК СуммаМай,
		|	СУММА(Данные.СуммаИюнь) КАК СуммаИюнь,
		|	СУММА(Данные.СуммаИюль) КАК СуммаИюль,
		|	СУММА(Данные.СуммаАвгуст) КАК СуммаАвгуст,
		|	СУММА(Данные.СуммаСентябрь) КАК СуммаСентябрь,
		|	СУММА(Данные.СуммаОктябрь) КАК СуммаОктябрь,
		|	СУММА(Данные.СуммаНоябрь) КАК СуммаНоябрь,
		|	СУММА(Данные.СуммаДекабрь) КАК СуммаДекабрь,
		|	СУММА(Данные.СуммаПервыйКвартал) КАК СуммаПервыйКвартал,
		|	СУММА(Данные.СуммаВторойКвартал) КАК СуммаВторойКвартал,
		|	СУММА(Данные.СуммаТретийКвартал) КАК СуммаТретийКвартал,
		|	СУММА(Данные.СуммаЧетвертыйКвартал) КАК СуммаЧетвертыйКвартал,
		|	СУММА(Данные.СуммаЗаПолугодие) КАК СуммаЗаПолугодие,
		|	СУММА(Данные.СуммаЗаДевятьМесяцев) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(Данные.СуммаИтого) КАК СуммаИтого,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПервПериод, 0)) КАК СуммаПервПериод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаФактТриГодаНазад, 0)) КАК СуммаФактТриГодаНазад,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПредществующийГод, 0)) КАК СуммаПредществующийГод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПланПредыдущийГод, 0)) КАК СуммаПланПредыдущийГод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаФактПредыдущий, 0)) КАК СуммаФактПредыдущий,
		|	ВЫБОР
		|		КОГДА Данные.ИсточникФинансирования = ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.ПустаяСсылка)
		|			ТОГДА ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|		ИНАЧЕ Данные.ИсточникФинансирования
		|	КОНЕЦ КАК ИсточникФинансирования,
		|	Данные.ФинансовыйПоказатель
		|ПОМЕСТИТЬ ГруппированныеДанные
		|ИЗ
		|	Данные КАК Данные
		|
		|СГРУППИРОВАТЬ ПО
		|	Данные.СтатьяБюджета,
		|	ВЫБОР
		|		КОГДА Данные.ИсточникФинансирования = ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.ПустаяСсылка)
		|			ТОГДА ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|		ИНАЧЕ Данные.ИсточникФинансирования
		|	КОНЕЦ,
		|	Данные.ФинансовыйПоказатель
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ГруппированныеДанные.ФинансовыйПоказатель КАК СтатьяБюджета,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЯнварь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЯнварь
		|		КОНЕЦ) КАК СуммаЯнварь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаФевраль КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаФевраль
		|		КОНЕЦ) КАК СуммаФевраль,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаМарт КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаМарт
		|		КОНЕЦ) КАК СуммаМарт,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаАпрель КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаАпрель
		|		КОНЕЦ) КАК СуммаАпрель,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаМай КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаМай
		|		КОНЕЦ) КАК СуммаМай,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИюнь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИюнь
		|		КОНЕЦ) КАК СуммаИюнь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИюль КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИюль
		|		КОНЕЦ) КАК СуммаИюль,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаАвгуст КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаАвгуст
		|		КОНЕЦ) КАК СуммаАвгуст,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаСентябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаСентябрь
		|		КОНЕЦ) КАК СуммаСентябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаОктябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаОктябрь
		|		КОНЕЦ) КАК СуммаОктябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаНоябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаНоябрь
		|		КОНЕЦ) КАК СуммаНоябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаДекабрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаДекабрь
		|		КОНЕЦ) КАК СуммаДекабрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаПервыйКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаПервыйКвартал
		|		КОНЕЦ) КАК СуммаПервыйКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаВторойКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаВторойКвартал
		|		КОНЕЦ) КАК СуммаВторойКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаТретийКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаТретийКвартал
		|		КОНЕЦ) КАК СуммаТретийКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЧетвертыйКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЧетвертыйКвартал
		|		КОНЕЦ) КАК СуммаЧетвертыйКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЗаПолугодие КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЗаПолугодие
		|		КОНЕЦ) КАК СуммаЗаПолугодие,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЗаДевятьМесяцев КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЗаДевятьМесяцев
		|		КОНЕЦ) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИтого КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИтого
		|		КОНЕЦ) КАК СуммаИтого,
		|	ГруппированныеДанные.ФинансовыйПоказатель.КодСтрокиБюджета КАК КодБО,
		|	СУММА(ГруппированныеДанные.СуммаПервПериод) КАК СуммаПервПериод,
		|	СУММА(ГруппированныеДанные.СуммаФактТриГодаНазад) КАК СуммаФактТриГодаНазад,
		|	СУММА(ГруппированныеДанные.СуммаПредществующийГод) КАК СуммаПредществующийГод,
		|	СУММА(ГруппированныеДанные.СуммаПланПредыдущийГод) КАК СуммаПланПредыдущийГод,
		|	СУММА(ГруппированныеДанные.СуммаФактПредыдущий) КАК СуммаФактПредыдущий,
		|	ГруппированныеДанные.ИсточникФинансирования
		|ПОМЕСТИТЬ Итог
		|ИЗ
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	ГруппированныеДанные.ИсточникФинансирования,
		|	ГруппированныеДанные.ФинансовыйПоказатель,
		|	ГруппированныеДанные.ФинансовыйПоказатель.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Заемные)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.СредстваРеспубликанскогоБюджета)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Итог.СтатьяБюджета КАК СтатьяБюджета,
		|	СУММА(Итог.СуммаЯнварь) КАК СуммаЯнварь,
		|	СУММА(Итог.СуммаФевраль) КАК СуммаФевраль,
		|	СУММА(Итог.СуммаМарт) КАК СуммаМарт,
		|	СУММА(Итог.СуммаАпрель) КАК СуммаАпрель,
		|	СУММА(Итог.СуммаМай) КАК СуммаМай,
		|	СУММА(Итог.СуммаИюнь) КАК СуммаИюнь,
		|	СУММА(Итог.СуммаИюль) КАК СуммаИюль,
		|	СУММА(Итог.СуммаАвгуст) КАК СуммаАвгуст,
		|	СУММА(Итог.СуммаСентябрь) КАК СуммаСентябрь,
		|	СУММА(Итог.СуммаОктябрь) КАК СуммаОктябрь,
		|	СУММА(Итог.СуммаНоябрь) КАК СуммаНоябрь,
		|	СУММА(Итог.СуммаДекабрь) КАК СуммаДекабрь,
		|	СУММА(Итог.СуммаПервыйКвартал) КАК СуммаПервыйКвартал,
		|	СУММА(Итог.СуммаВторойКвартал) КАК СуммаВторойКвартал,
		|	СУММА(Итог.СуммаТретийКвартал) КАК СуммаТретийКвартал,
		|	СУММА(Итог.СуммаЧетвертыйКвартал) КАК СуммаЧетвертыйКвартал,
		|	СУММА(Итог.СуммаЗаПолугодие) КАК СуммаЗаПолугодие,
		|	СУММА(Итог.СуммаЗаДевятьМесяцев) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(Итог.СуммаИтого) КАК СуммаИтого,
		|	СУММА(Итог.СуммаПервПериод) КАК СуммаПервПериод,
		|	СУММА(Итог.СуммаФактТриГодаНазад) КАК СуммаФактТриГодаНазад,
		|	СУММА(Итог.СуммаПредществующийГод) КАК СуммаПредществующийГод,
		|	СУММА(Итог.СуммаПланПредыдущийГод) КАК СуммаПланПредыдущийГод,
		|	СУММА(Итог.СуммаФактПредыдущий) КАК СуммаФактПредыдущий,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПредществующийГод <> 0
		|				ТОГДА Итог.СуммаПланПредыдущийГод / Итог.СуммаПредществующийГод * 100
		|		КОНЕЦ) КАК СуммаПредыдущий,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПланПредыдущийГод <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаПланПредыдущийГод * 100
		|		КОНЕЦ) КАК СуммаИтогоФакт,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПредществующийГод <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаПредществующийГод * 100
		|		КОНЕЦ) КАК СуммаПланКФактуПредш,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаФактТриГодаНазад <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаФактТриГодаНазад * 100
		|		КОНЕЦ) КАК СуммаПредществующий,
		|	Итог.КодБО КАК КодБО
		|ИЗ
		|	Итог КАК Итог
		|ГДЕ
		|	Итог.СтатьяБюджета = &СтатьяБюджета
		|
		|СГРУППИРОВАТЬ ПО
		|	Итог.СтатьяБюджета,
		|	Итог.КодБО
		|
		|УПОРЯДОЧИТЬ ПО
		|	КодБО
		|АВТОУПОРЯДОЧИВАНИЕ";
	
	НачалоПериода       = Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("НачалоПериода").Значение.Дата;
	КонецПериода        = КонецДня(Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("КонецПериода").Значение);
	Сценарий            = Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("Сценарий").Значение;
	
	КапитальныеВложения = Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("КапитальныеВложения").Значение; 
	
	Запрос.УстановитьПараметр("КапитальныеВложения", КапитальныеВложения);

	Запрос.УстановитьПараметр("СтатьяБюджета", СтатьяБюджета);
	
	Запрос.УстановитьПараметр("КонецПериода", КонецПериода);
	Запрос.УстановитьПараметр("Началопериода", НачалоПериода);
	Запрос.УстановитьПараметр("ОкруглятьДоЦелых", Истина);
	
	Запрос.УстановитьПараметр("НачалоПериодаПредыдущий", ДобавитьМесяц(НачалоГода(НачалоПериода), -12));
	Запрос.УстановитьПараметр("КонецПериодаПредыдущий", ДобавитьМесяц(КонецГода(КонецПериода), -12));
	Запрос.УстановитьПараметр("НачалоПериодаПредществующий", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*2));
	Запрос.УстановитьПараметр("КонецПериодаПредществующий", ДобавитьМесяц(КонецГода(КонецПериода), -12*2));
	Запрос.УстановитьПараметр("НачалоПериодаТриГодаНазад", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*3));
	Запрос.УстановитьПараметр("КонецПериодаТриГодаНазад", ДобавитьМесяц(КонецГода(КонецПериода), -12*3));
	Запрос.УстановитьПараметр("НачалоПериодаПервПериод", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*4));
	Запрос.УстановитьПараметр("КонецПериодаПервПериод", ДобавитьМесяц(КонецГода(КонецПериода), -12*4));

	Запрос.УстановитьПараметр("СценарийФакт", Справочники.СценарииПланирования.Факт);

	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	ОбластьСтрокаИсточникиИтог = Макет.ПолучитьОбласть("СтрокаИсточникиИтог");
	ОбластьСтрокаИсточникиИтог1 = Макет.ПолучитьОбласть("СтрокаИсточникиИтог");

	Если РезультатЗапроса.Пустой() Тогда
		Результат.Вывести(ОбластьСтрокаИсточникиИтог1, ВыборкаДетальныеЗаписи.Уровень());
	КонецЕсли;
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		
		ОбластьСтрокаИсточникиИтог.Параметры.Заполнить(ВыборкаДетальныеЗаписи);
		Результат.Вывести(ОбластьСтрокаИсточникиИтог);
		
	КонецЦикла;
			
КонецПроцедуры

Процедура РасчетИтогаПоИсточнику(СтатьяБюджета, Макет, Результат, Источник, Область)
	
		
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	БюджетОбороты.СтатьяБюджета КАК СтатьяБюджета,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 1
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЯнварь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 2
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаФевраль,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 3
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаМарт,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 4
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаАпрель,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 5
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаМай,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 6
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаИюнь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаИюль,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 8
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаАвгуст,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 9
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаСентябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаОктябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 11
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаНоябрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаДекабрь,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 4
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаПервыйКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 3
		|				И МЕСЯЦ(БюджетОбороты.Период) < 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаВторойКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 6
		|				И МЕСЯЦ(БюджетОбороты.Период) < 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаТретийКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) > 9
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЧетвертыйКвартал,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 7
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЗаПолугодие,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) < 10
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК СуммаЗаДевятьМесяцев,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(БюджетОбороты.Период) = 12
		|			ТОГДА ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|		ИНАЧЕ ЕСТЬNULL(БюджетОбороты.СуммаОборот, 0)
		|	КОНЕЦ КАК СуммаИтого,
		|	0 КАК СуммаПервПериод,
		|	0 КАК СуммаФактТриГодаНазад,
		|	0 КАК СуммаПредществующийГод,
		|	0 КАК СуммаПланПредыдущийГод,
		|	0 КАК СуммаФактПредыдущий,
		|	БюджетОбороты.ИсточникФинансирования КАК ИсточникФинансирования,
		|	БюджетОбороты.СтатьяБюджета.ФинансовыйПоказатель КАК ФинансовыйПоказатель
		|ПОМЕСТИТЬ Данные
		|ИЗ
		|	РегистрНакопления.б_Бюджет.Обороты(&Началопериода, &КонецПериода, Регистратор, ) КАК БюджетОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПредыдущий, &КонецПериодаПредыдущий, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПредществующий, &КонецПериодаПредществующий, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаТриГодаНазад, &КонецПериодаТриГодаНазад, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетФактОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.СуммаОборот,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетФактОбороты.ИсточникФинансирования,
		|	б_БюджетФактОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_БюджетФакт.Обороты(&НачалоПериодаПервПериод, &КонецПериодаПервПериод, , ) КАК б_БюджетФактОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	б_БюджетОбороты.СтатьяБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	б_БюджетОбороты.СуммаОборот,
		|	0,
		|	б_БюджетОбороты.ИсточникФинансирования,
		|	б_БюджетОбороты.СтатьяБюджета.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.б_Бюджет.Обороты(&НачалоПериодаПредыдущий, &КонецПериодаПредыдущий, , ) КАК б_БюджетОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 1
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 2
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 3
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 4
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 5
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 6
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 8
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 9
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 11
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) = 12
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 4
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 3
		|				И МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 6
		|				И МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) > 9
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 7
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА МЕСЯЦ(фин_ОборотыБюджетовОбороты.ПериодПланирования) < 10
		|			ТОГДА ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ЕСТЬNULL(фин_ОборотыБюджетовОбороты.СуммаУпрОборот, 0),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , Регистратор, ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий <> &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериода И &КонецПериода
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредыдущий И &КонецПериодаПредыдущий
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредществующий И &КонецПериодаПредществующий
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаТриГодаНазад И &КонецПериодаТриГодаНазад
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий = &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПервПериод И &КонецПериодаПервПериод
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	фин_ОборотыБюджетовОбороты.СуммаУпрОборот,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные),
		|	фин_ОборотыБюджетовОбороты.ФинансовыйПоказатель
		|ИЗ
		|	РегистрНакопления.фин_ОборотыБюджетов.Обороты(, , , ) КАК фин_ОборотыБюджетовОбороты
		|ГДЕ
		|	фин_ОборотыБюджетовОбороты.Сценарий <> &СценарийФакт
		|	И фин_ОборотыБюджетовОбороты.ПериодПланирования МЕЖДУ &НачалоПериодаПредыдущий И &КонецПериодаПредыдущий
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Данные.СтатьяБюджета,
		|	СУММА(Данные.СуммаЯнварь) КАК СуммаЯнварь,
		|	СУММА(Данные.СуммаФевраль) КАК СуммаФевраль,
		|	СУММА(Данные.СуммаМарт) КАК СуммаМарт,
		|	СУММА(Данные.СуммаАпрель) КАК СуммаАпрель,
		|	СУММА(Данные.СуммаМай) КАК СуммаМай,
		|	СУММА(Данные.СуммаИюнь) КАК СуммаИюнь,
		|	СУММА(Данные.СуммаИюль) КАК СуммаИюль,
		|	СУММА(Данные.СуммаАвгуст) КАК СуммаАвгуст,
		|	СУММА(Данные.СуммаСентябрь) КАК СуммаСентябрь,
		|	СУММА(Данные.СуммаОктябрь) КАК СуммаОктябрь,
		|	СУММА(Данные.СуммаНоябрь) КАК СуммаНоябрь,
		|	СУММА(Данные.СуммаДекабрь) КАК СуммаДекабрь,
		|	СУММА(Данные.СуммаПервыйКвартал) КАК СуммаПервыйКвартал,
		|	СУММА(Данные.СуммаВторойКвартал) КАК СуммаВторойКвартал,
		|	СУММА(Данные.СуммаТретийКвартал) КАК СуммаТретийКвартал,
		|	СУММА(Данные.СуммаЧетвертыйКвартал) КАК СуммаЧетвертыйКвартал,
		|	СУММА(Данные.СуммаЗаПолугодие) КАК СуммаЗаПолугодие,
		|	СУММА(Данные.СуммаЗаДевятьМесяцев) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(Данные.СуммаИтого) КАК СуммаИтого,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПервПериод, 0)) КАК СуммаПервПериод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаФактТриГодаНазад, 0)) КАК СуммаФактТриГодаНазад,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПредществующийГод, 0)) КАК СуммаПредществующийГод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаПланПредыдущийГод, 0)) КАК СуммаПланПредыдущийГод,
		|	СУММА(ЕСТЬNULL(Данные.СуммаФактПредыдущий, 0)) КАК СуммаФактПредыдущий,
		|	ВЫБОР
		|		КОГДА Данные.ИсточникФинансирования = ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.ПустаяСсылка)
		|			ТОГДА ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|		ИНАЧЕ Данные.ИсточникФинансирования
		|	КОНЕЦ КАК ИсточникФинансирования,
		|	Данные.ФинансовыйПоказатель
		|ПОМЕСТИТЬ ГруппированныеДанные
		|ИЗ
		|	Данные КАК Данные
		|
		|СГРУППИРОВАТЬ ПО
		|	Данные.СтатьяБюджета,
		|	ВЫБОР
		|		КОГДА Данные.ИсточникФинансирования = ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.ПустаяСсылка)
		|			ТОГДА ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|		ИНАЧЕ Данные.ИсточникФинансирования
		|	КОНЕЦ,
		|	Данные.ФинансовыйПоказатель
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ГруппированныеДанные.ФинансовыйПоказатель КАК СтатьяБюджета,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЯнварь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЯнварь
		|		КОНЕЦ) КАК СуммаЯнварь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаФевраль КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаФевраль
		|		КОНЕЦ) КАК СуммаФевраль,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаМарт КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаМарт
		|		КОНЕЦ) КАК СуммаМарт,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаАпрель КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаАпрель
		|		КОНЕЦ) КАК СуммаАпрель,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаМай КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаМай
		|		КОНЕЦ) КАК СуммаМай,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИюнь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИюнь
		|		КОНЕЦ) КАК СуммаИюнь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИюль КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИюль
		|		КОНЕЦ) КАК СуммаИюль,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаАвгуст КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаАвгуст
		|		КОНЕЦ) КАК СуммаАвгуст,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаСентябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаСентябрь
		|		КОНЕЦ) КАК СуммаСентябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаОктябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаОктябрь
		|		КОНЕЦ) КАК СуммаОктябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаНоябрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаНоябрь
		|		КОНЕЦ) КАК СуммаНоябрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаДекабрь КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаДекабрь
		|		КОНЕЦ) КАК СуммаДекабрь,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаПервыйКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаПервыйКвартал
		|		КОНЕЦ) КАК СуммаПервыйКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаВторойКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаВторойКвартал
		|		КОНЕЦ) КАК СуммаВторойКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаТретийКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаТретийКвартал
		|		КОНЕЦ) КАК СуммаТретийКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЧетвертыйКвартал КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЧетвертыйКвартал
		|		КОНЕЦ) КАК СуммаЧетвертыйКвартал,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЗаПолугодие КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЗаПолугодие
		|		КОНЕЦ) КАК СуммаЗаПолугодие,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаЗаДевятьМесяцев КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаЗаДевятьМесяцев
		|		КОНЕЦ) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(ВЫБОР
		|			КОГДА &ОкруглятьДоЦелых
		|				ТОГДА ВЫРАЗИТЬ(ГруппированныеДанные.СуммаИтого КАК ЧИСЛО(19, 0))
		|			ИНАЧЕ ГруппированныеДанные.СуммаИтого
		|		КОНЕЦ) КАК СуммаИтого,
		|	ГруппированныеДанные.ФинансовыйПоказатель.КодСтрокиБюджета КАК КодБО,
		|	СУММА(ГруппированныеДанные.СуммаПервПериод) КАК СуммаПервПериод,
		|	СУММА(ГруппированныеДанные.СуммаФактТриГодаНазад) КАК СуммаФактТриГодаНазад,
		|	СУММА(ГруппированныеДанные.СуммаПредществующийГод) КАК СуммаПредществующийГод,
		|	СУММА(ГруппированныеДанные.СуммаПланПредыдущийГод) КАК СуммаПланПредыдущийГод,
		|	СУММА(ГруппированныеДанные.СуммаФактПредыдущий) КАК СуммаФактПредыдущий,
		|	ГруппированныеДанные.ИсточникФинансирования
		|ПОМЕСТИТЬ Итог
		|ИЗ
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	ГруппированныеДанные.ИсточникФинансирования,
		|	ГруппированныеДанные.ФинансовыйПоказатель,
		|	ГруппированныеДанные.ФинансовыйПоказатель.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Заемные)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	СУММА(0),
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.СредстваРеспубликанскогоБюджета)
		|ИЗ
		|	Справочник.фин_ФинансовыеПоказатели КАК фин_ФинансовыеПоказатели,
		|	ГруппированныеДанные КАК ГруппированныеДанные
		|ГДЕ
		|	фин_ФинансовыеПоказатели.Ссылка В ИЕРАРХИИ(&КапитальныеВложения)
		|	И ГруппированныеДанные.ФинансовыйПоказатель В ИЕРАРХИИ(&КапитальныеВложения)
		|
		|СГРУППИРОВАТЬ ПО
		|	фин_ФинансовыеПоказатели.Ссылка,
		|	фин_ФинансовыеПоказатели.КодСтрокиБюджета
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЕСТЬNULL(Итог.ИсточникФинансирования, ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)) КАК ИсточникФинансирования,
		|	СУММА(Итог.СуммаЯнварь) КАК СуммаЯнварь,
		|	СУММА(Итог.СуммаФевраль) КАК СуммаФевраль,
		|	СУММА(Итог.СуммаМарт) КАК СуммаМарт,
		|	СУММА(Итог.СуммаАпрель) КАК СуммаАпрель,
		|	СУММА(Итог.СуммаМай) КАК СуммаМай,
		|	СУММА(Итог.СуммаИюнь) КАК СуммаИюнь,
		|	СУММА(Итог.СуммаИюль) КАК СуммаИюль,
		|	СУММА(Итог.СуммаАвгуст) КАК СуммаАвгуст,
		|	СУММА(Итог.СуммаСентябрь) КАК СуммаСентябрь,
		|	СУММА(Итог.СуммаОктябрь) КАК СуммаОктябрь,
		|	СУММА(Итог.СуммаНоябрь) КАК СуммаНоябрь,
		|	СУММА(Итог.СуммаДекабрь) КАК СуммаДекабрь,
		|	СУММА(Итог.СуммаПервыйКвартал) КАК СуммаПервыйКвартал,
		|	СУММА(Итог.СуммаВторойКвартал) КАК СуммаВторойКвартал,
		|	СУММА(Итог.СуммаТретийКвартал) КАК СуммаТретийКвартал,
		|	СУММА(Итог.СуммаЧетвертыйКвартал) КАК СуммаЧетвертыйКвартал,
		|	СУММА(Итог.СуммаЗаПолугодие) КАК СуммаЗаПолугодие,
		|	СУММА(Итог.СуммаЗаДевятьМесяцев) КАК СуммаЗаДевятьМесяцев,
		|	СУММА(Итог.СуммаИтого) КАК СуммаИтого,
		|	СУММА(Итог.СуммаПервПериод) КАК СуммаПервПериод,
		|	СУММА(Итог.СуммаФактТриГодаНазад) КАК СуммаФактТриГодаНазад,
		|	СУММА(Итог.СуммаПредществующийГод) КАК СуммаПредществующийГод,
		|	СУММА(Итог.СуммаПланПредыдущийГод) КАК СуммаПланПредыдущийГод,
		|	СУММА(Итог.СуммаФактПредыдущий) КАК СуммаФактПредыдущий,
		|	ЕСТЬNULL(Итог.ИсточникФинансирования.Код, ""000000003"") КАК КодИсточника,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПредществующийГод <> 0
		|				ТОГДА Итог.СуммаПланПредыдущийГод / Итог.СуммаПредществующийГод * 100
		|		КОНЕЦ) КАК СуммаПредыдущий,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПланПредыдущийГод <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаПланПредыдущийГод * 100
		|		КОНЕЦ) КАК СуммаИтогоФакт,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаПредществующийГод <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаПредществующийГод * 100
		|		КОНЕЦ) КАК СуммаПланКФактуПредш,
		|	СУММА(ВЫБОР
		|			КОГДА Итог.СуммаФактТриГодаНазад <> 0
		|				ТОГДА Итог.СуммаИтого / Итог.СуммаФактТриГодаНазад * 100
		|		КОНЕЦ) КАК СуммаПредществующий
		|ИЗ
		|	Итог КАК Итог
		|ГДЕ
		|	Итог.СтатьяБюджета В ИЕРАРХИИ(&СтатьяБюджета)
		|	И Итог.ИсточникФинансирования = &Источник
		|
		|СГРУППИРОВАТЬ ПО
		|	ЕСТЬNULL(Итог.ИсточникФинансирования, ЗНАЧЕНИЕ(Справочник.битИсточникиФинансирования.Собственные)),
		|	ЕСТЬNULL(Итог.ИсточникФинансирования.Код, ""000000003"")
		|
		|УПОРЯДОЧИТЬ ПО
		|	КодИсточника
		|АВТОУПОРЯДОЧИВАНИЕ";
	
	НачалоПериода       = Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("НачалоПериода").Значение.Дата;
	КонецПериода        = КонецДня(Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("КонецПериода").Значение);
	Сценарий            = Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("Сценарий").Значение;
	
	
	Запрос.УстановитьПараметр("СтатьяБюджета", СтатьяБюджета);
	Запрос.УстановитьПараметр("Сценарий", Сценарий);
	Запрос.УстановитьПараметр("СценарийФакт", Справочники.СценарииПланирования.Факт);
	Запрос.УстановитьПараметр("Источник", Источник);
	
	Запрос.УстановитьПараметр("КонецПериода", КонецПериода);
	Запрос.УстановитьПараметр("Началопериода", НачалоПериода);
	Запрос.УстановитьПараметр("ОкруглятьДоЦелых", Истина);
	
	Запрос.УстановитьПараметр("НачалоПериодаПредыдущий", ДобавитьМесяц(НачалоГода(НачалоПериода), -12));
	Запрос.УстановитьПараметр("КонецПериодаПредыдущий", ДобавитьМесяц(КонецГода(КонецПериода), -12));
	Запрос.УстановитьПараметр("НачалоПериодаПредществующий", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*2));
	Запрос.УстановитьПараметр("КонецПериодаПредществующий", ДобавитьМесяц(КонецГода(КонецПериода), -12*2));
	Запрос.УстановитьПараметр("НачалоПериодаТриГодаНазад", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*3));
	Запрос.УстановитьПараметр("КонецПериодаТриГодаНазад", ДобавитьМесяц(КонецГода(КонецПериода), -12*3));
	Запрос.УстановитьПараметр("НачалоПериодаПервПериод", ДобавитьМесяц(НачалоГода(НачалоПериода), -12*4));
	Запрос.УстановитьПараметр("КонецПериодаПервПериод", ДобавитьМесяц(КонецГода(КонецПериода), -12*4));

	
	КапитальныеВложения = Отчет.КомпоновщикНастроек.ПолучитьНастройки().ПараметрыДанных.Элементы.Найти("КапитальныеВложения").Значение; 
	
	Запрос.УстановитьПараметр("КапитальныеВложения", КапитальныеВложения);

	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
	Если РезультатЗапроса.Пустой() Тогда
		Результат.Вывести(Область, ВыборкаДетальныеЗаписи.Уровень());
	КонецЕсли;
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		
		Область.Параметры.Заполнить(ВыборкаДетальныеЗаписи);
		Результат.Вывести(Область);
		
	КонецЦикла;
			
КонецПроцедуры

&НаКлиенте
Процедура Сформировать(Команда)
	СформироватьНаСервере();
КонецПроцедуры

&НаКлиенте
Процедура РезультатПриАктивизацииОбласти(Элемент)
		
	Если ТипЗнч(Результат.ВыделенныеОбласти) = Тип("ВыделенныеОбластиТабличногоДокумента") Тогда
		ИнтервалОжидания = ?(ПолучитьСкоростьКлиентскогоСоединения() = СкоростьКлиентскогоСоединения.Низкая, 1, 0.2);
		ПодключитьОбработчикОжидания("Подключаемый_РезультатПриАктивизацииОбластиПодключаемый", ИнтервалОжидания, Истина);
	КонецЕсли;

КонецПроцедуры

&НаКлиенте
Процедура Подключаемый_РезультатПриАктивизацииОбластиПодключаемый()
	
	//НеобходимоВычислятьНаСервере = Ложь;
	//БухгалтерскиеОтчетыКлиент.ВычислитьСуммуВыделенныхЯчеекТабличногоДокумента(
	//	ПолеСумма, Результат, КэшВыделеннойОбласти, НеобходимоВычислятьНаСервере);
	//
	//Если НеобходимоВычислятьНаСервере Тогда
	//	ВычислитьСуммуВыделенныхЯчеекТабличногоДокументаВКонтекстеНаСервере();
	//КонецЕсли;
	//
	//ОтключитьОбработчикОжидания("Подключаемый_РезультатПриАктивизацииОбластиПодключаемый");
	
КонецПроцедуры

&НаСервере
Процедура ВычислитьСуммуВыделенныхЯчеекТабличногоДокументаВКонтекстеНаСервере()
	
	//ПолеСумма = БухгалтерскиеОтчетыВызовСервера.ВычислитьСуммуВыделенныхЯчеекТабличногоДокумента(
	//	Результат, КэшВыделеннойОбласти);
	//
КонецПроцедуры
 
