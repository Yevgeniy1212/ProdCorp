
&НаСервере
Процедура СформироватьНаСервере()
	
	СтрокВШапке = Результат.ФиксацияСверху;
	КоличествоКолонок = Результат.ШиринаТаблицы;
	
	ОбластьШапки = Результат.Область(СтрокВШапке,,СтрокВШапке);
	ОбластьПриемник = Результат.Область(СтрокВШапке+1,,СтрокВШапке+1);
	Результат.ВставитьОбласть(ОбластьШапки, ОбластьПриемник, ТипСмещенияТабличногоДокумента.ПоГоризонтали, Ложь);
	
	Для Ном =1 По КоличествоКолонок Цикл
		ТекОбласть = Результат.Область(СтрокВШапке+1, Ном);
		
		Если КоличествоКолонок = 31 Тогда
			Если Ном = 31 Тогда
				ТекОбласть.Текст = "31=10/7";
			ИначеЕсли Ном = 30 Тогда
				ТекОбласть.Текст = "30=10/5";
	        ИначеЕсли Ном = 29 Тогда
				ТекОбласть.Текст = "29=10/4";
			ИначеЕсли Ном = 8 Тогда
				ТекОбласть.Текст = "8=7/6";
	        ИначеЕсли Ном = 9 Тогда
				ТекОбласть.Текст = "9=7/5";	
			Иначе
				ТекОбласть.Текст = "" + Ном;
			КонецЕсли;
		ИначеЕсли КоличествоКолонок = 19 Тогда
			
			Если Ном = 17 Тогда
				ТекОбласть.Текст = "17=10/7";
			ИначеЕсли Ном = 18 Тогда
				ТекОбласть.Текст = "18=10/5";
	        ИначеЕсли Ном = 19 Тогда
				ТекОбласть.Текст = "19=10/4";
			ИначеЕсли Ном = 8 Тогда
				ТекОбласть.Текст = "8=7/6";
	        ИначеЕсли Ном = 9 Тогда
				ТекОбласть.Текст = "9=7/5";	
			Иначе
				ТекОбласть.Текст = "" + Ном;
			КонецЕсли;
		ИначеЕсли КоличествоКолонок = 17 Тогда
			
			Если Ном = 15 Тогда
				ТекОбласть.Текст = "15=8/6";
			ИначеЕсли Ном = 16 Тогда
				ТекОбласть.Текст = "16=8/5";
	        ИначеЕсли Ном = 17 Тогда
				ТекОбласть.Текст = "17=8/4";
			Иначе
				ТекОбласть.Текст = "" + Ном;
			КонецЕсли;
	    ИначеЕсли КоличествоКолонок = 16 Тогда
			
			Если Ном = 14 Тогда
				ТекОбласть.Текст = "14=7/6";
			ИначеЕсли Ном = 15 Тогда
				ТекОбласть.Текст = "15=7/5";
	        ИначеЕсли Ном = 16 Тогда
				ТекОбласть.Текст = "16=7/4";
			Иначе
				ТекОбласть.Текст = "" + Ном;
			КонецЕсли;

		Иначе
			ТекОбласть.Текст = "" + Ном;
		КонецЕсли;	
		
		Линия = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная,1);
		
		ТекОбласть.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Центр;
		ТекОбласть.ЦветФона = Новый Цвет(203, 228, 229);
		ТекОбласть.Шрифт = Новый Шрифт("Arial", 10,Истина);
		ТекОбласть.ЦветТекста = Новый Цвет(0, 0, 92);
		ТекОбласть.ГраницаСправа = Линия;
		ТекОбласть.ЦветРамки = ЦветаСтиля.ЦветРамки;

	КонецЦикла;
	
	Результат.ФиксацияСверху = Результат.ФиксацияСверху + 1;
	Результат.ФиксацияСлева = 3;
	
	ДоработатьЗаголовок();

КонецПроцедуры

&НаКлиенте
Процедура Сформировать(Команда)
	
	////Макет = ПолучитьМакет("Макет");
	//
	//ОтчетБК = Отчеты.б_ОтчетПоБюджету1БК.Создать();
	//Макет = ОтчетБК.ПолучитьМакет("Макет");

	//ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
	//ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
	//
	//ОбластьПодвал.Параметры.Руководитель = ОбщегоНазначения.ФамилияИнициалыФизЛица(Справочники.бит_ОтветственныеЛицаБюджет.РуководительОрганизации.Сотрудник.Физлицо);
	//ОбластьПодвал.Параметры.РуководительДолжность = Справочники.бит_ОтветственныеЛицаБюджет.РуководительОрганизации.Должность;
	//ОбластьПодвал.Параметры.РуководительФД = ОбщегоНазначения.ФамилияИнициалыФизЛица(Справочники.бит_ОтветственныеЛицаБюджет.РуководительФД.Сотрудник.Физлицо);
	//ОбластьПодвал.Параметры.РуководительФДДолжность = Справочники.бит_ОтветственныеЛицаБюджет.РуководительФД.Должность;
	//ОбластьПодвал.Параметры.Исполнитель = ОбщегоНазначения.ФамилияИнициалыФизЛица(Справочники.бит_ОтветственныеЛицаБюджет.Исполнитель.Сотрудник.Физлицо);
	//ОбластьПодвал.Параметры.Телефон = Справочники.бит_ОтветственныеЛицаБюджет.Исполнитель.Комментарий;

	//
	////ОбластьШапка.Параметры.Год = Формат(Год(НачалоПериода), "ЧГ=0");
	//Результат.Вывести(ОбластьШапка);

	СкомпоноватьРезультат(РежимКомпоновкиРезультата.Непосредственно);
	СформироватьНаСервере();
	
КонецПроцедуры

&НаСервере
Процедура ДоработатьЗаголовок()

	КоличествоКолонок = Результат.ШиринаТаблицы;
		
	ТекОбласть = Результат.Область(1, КоличествоКолонок);
	ТекОбласть.Текст = "1 БК";
	
	ТекОбласть.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
    ТекОбласть.Шрифт = Новый Шрифт("Arial", 12, Истина);

	//ТекОбласть2 = Результат.Область(5, КоличествоКолонок);
	//ТекОбласть2.Текст = "тыс.тенге";
	//
	//ТекОбласть2.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
	//ТекОбласть2.Шрифт = Новый Шрифт("Arial", 12, Истина);

КонецПроцедуры
