<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>Данные</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Удержано</dataPath>
			<field>Удержано</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидРасчета</dataPath>
			<field>ВидРасчета</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодРегистрации</dataPath>
			<field>ПериодРегистрации</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Регистратор</dataPath>
			<field>Регистратор</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФизЛицо</dataPath>
			<field>ФизЛицо</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РаботаетПоДоговоруГПХ</dataPath>
			<field>РаботаетПоДоговоруГПХ</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТарифныйРазряд</dataPath>
			<field>ТарифныйРазряд</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеОрганизации</dataPath>
			<field>ПодразделениеОрганизации</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Должность</dataPath>
			<field>Должность</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК НачалоМесяца,
	КОНЕЦПЕРИОДА(РеглПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК КонецМесяца
ПОМЕСТИТЬ ВТПериоды
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РеглПроизводственныйКалендарь
ГДЕ
	РеглПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Удержано.Результат КАК Удержано,
	ПлановыеУдержания.Регистратор,
	ПлановыеУдержания.ФизЛицо,
	ПлановыеУдержания.ОбособленноеПодразделение КАК Организация,
	ПлановыеУдержания.ВидРасчета,
	ПлановыеУдержания.ПериодРегистрации,
	РаботникиИДоговорникиОрганизации.ТарифныйРазряд,
	РаботникиИДоговорникиОрганизации.РаботаетПоДоговоруГПХ,
	РаботникиИДоговорникиОрганизации.ПодразделениеОрганизации,
	РаботникиИДоговорникиОрганизации.Должность
ИЗ
	(ВЫБРАТЬ РАЗЛИЧНЫЕ
		ПлановыеУдержания.Регистратор КАК Регистратор,
		ПлановыеУдержания.ФизЛицо КАК ФизЛицо,
		ПлановыеУдержания.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
		ПлановыеУдержания.ВидРасчета КАК ВидРасчета,
		ПлановыеУдержания.ПериодРегистрации КАК ПериодРегистрации
	ИЗ
		(ВЫБРАТЬ РАЗЛИЧНЫЕ
			УдержанияРаботниковОрганизаций.Регистратор КАК Регистратор,
			УдержанияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
			УдержанияРаботниковОрганизаций.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
			УдержанияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
			УдержанияРаботниковОрганизаций.ПериодРегистрации КАК ПериодРегистрации
		ИЗ
			РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизаций
		ГДЕ
			УдержанияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ РАЗЛИЧНЫЕ
			ПогашениеЗаймов.Регистратор,
			ПогашениеЗаймов.ФизЛицо,
			ПогашениеЗаймов.Организация,
			"Погашение займа",
			НАЧАЛОПЕРИОДА(ПогашениеЗаймов.Период, МЕСЯЦ)
		ИЗ
			РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймов
		ГДЕ
			ПогашениеЗаймов.Период МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
			И ПогашениеЗаймов.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
			И ПогашениеЗаймов.УдержаноИзЗарплаты
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ РАЗЛИЧНЫЕ
			ИПНРасчетыСБюджетом.Регистратор,
			ИПНРасчетыСБюджетом.ФизЛицо,
			ИПНРасчетыСБюджетом.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ИПНРасчетыСБюджетом.Период, МЕСЯЦ)
		ИЗ
			РегистрНакопления.ИПНРасчетыСБюджетом КАК ИПНРасчетыСБюджетом
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НалогиСборыОтчисления КАК Налоги
				ПО (Налоги.Ссылка = ЗНАЧЕНИЕ(Справочник.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалог))
		ГДЕ
			ИПНРасчетыСБюджетом.Период МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
			И ИПНРасчетыСБюджетом.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
			И ИПНРасчетыСБюджетом.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
			И ИПНРасчетыСБюджетом.НеОтражатьВРеглУчете = ЛОЖЬ
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ РАЗЛИЧНЫЕ
			ОПВРасчетыСФондами.Регистратор,
			ОПВРасчетыСФондами.ФизЛицо,
			ОПВРасчетыСФондами.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ОПВРасчетыСФондами.Период, МЕСЯЦ)
		ИЗ
			РегистрНакопления.ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НалогиСборыОтчисления КАК Налоги
				ПО (Налоги.Ссылка = ЗНАЧЕНИЕ(Справочник.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы))
		ГДЕ
			ОПВРасчетыСФондами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
			И ОПВРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
			И ОПВРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
			И ОПВРасчетыСФондами.ВидПлатежа = ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог)
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ РАЗЛИЧНЫЕ
			ВОСМСРасчетыСФондами.Регистратор,
			ВОСМСРасчетыСФондами.ФизЛицо,
			ВОСМСРасчетыСФондами.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ВОСМСРасчетыСФондами.Период, МЕСЯЦ)
		ИЗ
			РегистрНакопления.ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НалогиСборыОтчисления КАК Налоги
				ПО (Налоги.Ссылка = ЗНАЧЕНИЕ(Справочник.НалогиСборыОтчисления.ВзносыОбязательноеСоциальноеМедицинскоеСтрахование))
		ГДЕ
			ВОСМСРасчетыСФондами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
			И ВОСМСРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
			И ВОСМСРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
			И ВОСМСРасчетыСФондами.ВидПлатежа = ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог)) КАК ПлановыеУдержания) КАК ПлановыеУдержания
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			УдержанияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
			УдержанияРаботниковОрганизаций.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
			УдержанияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
			УдержанияРаботниковОрганизаций.ПериодРегистрации КАК ПериодРегистрации,
			СУММА(УдержанияРаботниковОрганизаций.Результат) КАК Результат,
			УдержанияРаботниковОрганизаций.Регистратор КАК Регистратор
		ИЗ
			РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизаций
		ГДЕ
			УдержанияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
		
		СГРУППИРОВАТЬ ПО
			УдержанияРаботниковОрганизаций.ФизЛицо,
			УдержанияРаботниковОрганизаций.ОбособленноеПодразделение,
			УдержанияРаботниковОрганизаций.ВидРасчета,
			УдержанияРаботниковОрганизаций.ПериодРегистрации,
			УдержанияРаботниковОрганизаций.Регистратор
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ПогашениеЗаймов.ФизЛицо,
			ПогашениеЗаймов.Организация,
			"Погашение займа",
			НАЧАЛОПЕРИОДА(ПогашениеЗаймов.Период, МЕСЯЦ),
			СУММА(ПогашениеЗаймов.ОсновнойДолг),
			ПогашениеЗаймов.Регистратор
		ИЗ
			РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймов
		ГДЕ
			ПогашениеЗаймов.Период МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
			И ПогашениеЗаймов.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
			И ПогашениеЗаймов.УдержаноИзЗарплаты
		
		СГРУППИРОВАТЬ ПО
			ПогашениеЗаймов.ФизЛицо,
			ПогашениеЗаймов.Организация,
			НАЧАЛОПЕРИОДА(ПогашениеЗаймов.Период, МЕСЯЦ),
			ПогашениеЗаймов.Регистратор
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ИПНРасчетыСБюджетом.ФизЛицо,
			ИПНРасчетыСБюджетом.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ИПНРасчетыСБюджетом.Период, МЕСЯЦ),
			СУММА(ИПНРасчетыСБюджетом.Налог),
			ИПНРасчетыСБюджетом.Регистратор
		ИЗ
			РегистрНакопления.ИПНРасчетыСБюджетом КАК ИПНРасчетыСБюджетом
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НалогиСборыОтчисления КАК Налоги
				ПО (Налоги.Ссылка = ЗНАЧЕНИЕ(Справочник.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалог))
		ГДЕ
			ИПНРасчетыСБюджетом.Период МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
			И ИПНРасчетыСБюджетом.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
			И ИПНРасчетыСБюджетом.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
			И ИПНРасчетыСБюджетом.НеОтражатьВРеглУчете = ЛОЖЬ
		
		СГРУППИРОВАТЬ ПО
			ИПНРасчетыСБюджетом.ФизЛицо,
			ИПНРасчетыСБюджетом.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ИПНРасчетыСБюджетом.Период, МЕСЯЦ),
			ИПНРасчетыСБюджетом.Регистратор
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ОПВРасчетыСФондами.ФизЛицо,
			ОПВРасчетыСФондами.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ОПВРасчетыСФондами.Период, МЕСЯЦ),
			СУММА(ОПВРасчетыСФондами.Взнос),
			ОПВРасчетыСФондами.Регистратор
		ИЗ
			РегистрНакопления.ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НалогиСборыОтчисления КАК Налоги
				ПО (Налоги.Ссылка = ЗНАЧЕНИЕ(Справочник.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы))
		ГДЕ
			ОПВРасчетыСФондами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
			И ОПВРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
			И ОПВРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
			И ОПВРасчетыСФондами.ВидПлатежа = ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог)
		
		СГРУППИРОВАТЬ ПО
			ОПВРасчетыСФондами.ФизЛицо,
			ОПВРасчетыСФондами.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ОПВРасчетыСФондами.Период, МЕСЯЦ),
			ОПВРасчетыСФондами.Регистратор
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ВОСМСРасчетыСФондами.ФизЛицо,
			ВОСМСРасчетыСФондами.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ВОСМСРасчетыСФондами.Период, МЕСЯЦ),
			СУММА(ВОСМСРасчетыСФондами.Взнос),
			ВОСМСРасчетыСФондами.Регистратор
		ИЗ
			РегистрНакопления.ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НалогиСборыОтчисления КАК Налоги
				ПО (Налоги.Ссылка = ЗНАЧЕНИЕ(Справочник.НалогиСборыОтчисления.ВзносыОбязательноеСоциальноеМедицинскоеСтрахование))
		ГДЕ
			ВОСМСРасчетыСФондами.Период МЕЖДУ НАЧАЛОПЕРИОДА(&amp;НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&amp;КонецПериода, МЕСЯЦ)
			И ВОСМСРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
			И ВОСМСРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
			И ВОСМСРасчетыСФондами.ВидПлатежа = ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог)
		
		СГРУППИРОВАТЬ ПО
			ВОСМСРасчетыСФондами.ФизЛицо,
			ВОСМСРасчетыСФондами.Организация,
			Налоги.Ссылка,
			НАЧАЛОПЕРИОДА(ВОСМСРасчетыСФондами.Период, МЕСЯЦ),
			ВОСМСРасчетыСФондами.Регистратор) КАК Удержано
		ПО (Удержано.ФизЛицо = ПлановыеУдержания.ФизЛицо)
			И (Удержано.ОбособленноеПодразделение = ПлановыеУдержания.ОбособленноеПодразделение)
			И (Удержано.ВидРасчета = ПлановыеУдержания.ВидРасчета)
			И (Удержано.ПериодРегистрации = ПлановыеУдержания.ПериодРегистрации)
			И ПлановыеУдержания.Регистратор = Удержано.Регистратор
		{ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ЕСТЬNULL(РаботникиОрганизации.ПериодРегистрации, ДоговорникиОрганизации.ПериодРегистрации) КАК ПериодРегистрации,
			ЕСТЬNULL(РаботникиОрганизации.ОбособленноеПодразделение, ДоговорникиОрганизации.Организация) КАК ОбособленноеПодразделение,
			ЕСТЬNULL(РаботникиОрганизации.ФизЛицо, ДоговорникиОрганизации.ФизЛицо) КАК ФизЛицо,
			ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорникиОрганизации.ПодразделениеОрганизации) КАК ПодразделениеОрганизации,
			ЕСТЬNULL(РаботникиОрганизации.Должность, ДоговорникиОрганизации.Должность) КАК Должность,
			ЕСТЬNULL(РаботникиОрганизации.ТарифныйРазряд, ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)) КАК ТарифныйРазряд,
			ВЫБОР
				КОГДА НЕ РаботникиОрганизации.ФизЛицо ЕСТЬ NULL 
					ТОГДА ЛОЖЬ
				ИНАЧЕ ИСТИНА
			КОНЕЦ КАК РаботаетПоДоговоруГПХ
		ИЗ
			Справочник.ФизическиеЛица КАК ФизическиеЛица
				ЛЕВОЕ СОЕДИНЕНИЕ ВТПериоды КАК МесяцыОтчета
				ПО (ИСТИНА)
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Организации КАК Организации
				ПО (ИСТИНА)
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					ДатыПоследнихНазначений.ПериодРегистрации КАК ПериодРегистрации,
					РаботникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
					РаботникиОрганизации.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
					РаботникиОрганизации.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
					РаботникиОрганизации.Должность КАК Должность,
					РаботникиОрганизации.ТарифныйРазряд КАК ТарифныйРазряд
				ИЗ
					(ВЫБРАТЬ
						МесяцыОтчета.НачалоМесяца КАК ПериодРегистрации,
						РаботникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
						РаботникиОрганизации.Организация КАК Организация,
						МАКСИМУМ(ВЫБОР
								КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
									ТОГДА ДОБАВИТЬКДАТЕ(РаботникиОрганизации.Период, ДЕНЬ, -1)
								ИНАЧЕ РаботникиОрганизации.Период
							КОНЕЦ) КАК Период
					ИЗ
						ВТПериоды КАК МесяцыОтчета
							ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
							ПО (РаботникиОрганизации.Период &lt;= МесяцыОтчета.КонецМесяца)
								И (РаботникиОрганизации.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
					
					СГРУППИРОВАТЬ ПО
						МесяцыОтчета.НачалоМесяца,
						РаботникиОрганизации.Сотрудник.Физлицо,
						РаботникиОрганизации.Организация) КАК ДатыПоследнихНазначений
						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
						ПО ДатыПоследнихНазначений.ФизЛицо = РаботникиОрганизации.Сотрудник.Физлицо
							И ДатыПоследнихНазначений.Организация = РаботникиОрганизации.Организация
							И (ДатыПоследнихНазначений.Период = ВЫБОР
								КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
									ТОГДА ДОБАВИТЬКДАТЕ(РаботникиОрганизации.Период, ДЕНЬ, -1)
								ИНАЧЕ РаботникиОрганизации.Период
							КОНЕЦ)
							И (РаботникиОрганизации.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))) КАК РаботникиОрганизации
				ПО ФизическиеЛица.Ссылка = РаботникиОрганизации.ФизЛицо
					И (МесяцыОтчета.НачалоМесяца = РаботникиОрганизации.ПериодРегистрации)
					И (Организации.Ссылка = РаботникиОрганизации.ОбособленноеПодразделение)
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					ДатыПоследнихДоговоров.ПериодРегистрации КАК ПериодРегистрации,
					ДоговорникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
					ДоговорникиОрганизации.Организация КАК Организация,
					МАКСИМУМ(ДоговорникиОрганизации.ПодразделениеОрганизации) КАК ПодразделениеОрганизации,
					МАКСИМУМ(ДоговорникиОрганизации.Должность) КАК Должность
				ИЗ
					(ВЫБРАТЬ
						МесяцыОтчета.НачалоМесяца КАК ПериодРегистрации,
						ДоговорникиОрганизации.Сотрудник КАК Сотрудник,
						ДоговорникиОрганизации.Организация КАК Организация,
						МАКСИМУМ(ДоговорникиОрганизации.ДатаНачала) КАК ДатаНачала
					ИЗ
						ВТПериоды КАК МесяцыОтчета
							ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ДоговорникиОрганизаций КАК ДоговорникиОрганизации
							ПО (ДоговорникиОрганизации.ДатаНачала &lt;= МесяцыОтчета.КонецМесяца)
					
					СГРУППИРОВАТЬ ПО
						МесяцыОтчета.НачалоМесяца,
						ДоговорникиОрганизации.Сотрудник,
						ДоговорникиОрганизации.Организация) КАК ДатыПоследнихДоговоров
						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ДоговорникиОрганизаций КАК ДоговорникиОрганизации
						ПО (ДоговорникиОрганизации.Сотрудник = ДатыПоследнихДоговоров.Сотрудник)
							И (ДоговорникиОрганизации.Организация = ДатыПоследнихДоговоров.Организация)
							И (ДоговорникиОрганизации.ДатаНачала = ДатыПоследнихДоговоров.ДатаНачала)
				
				СГРУППИРОВАТЬ ПО
					ДатыПоследнихДоговоров.ПериодРегистрации,
					ДоговорникиОрганизации.Сотрудник.Физлицо,
					ДоговорникиОрганизации.Организация) КАК ДоговорникиОрганизации
				ПО ФизическиеЛица.Ссылка = ДоговорникиОрганизации.ФизЛицо
					И (МесяцыОтчета.НачалоМесяца = ДоговорникиОрганизации.ПериодРегистрации)
					И (Организации.Ссылка = ДоговорникиОрганизации.Организация)
		ГДЕ
			(НЕ РаботникиОрганизации.ФизЛицо ЕСТЬ NULL 
					ИЛИ НЕ ДоговорникиОрганизации.ФизЛицо ЕСТЬ NULL )) КАК РаботникиИДоговорникиОрганизации
		ПО ПлановыеУдержания.ФизЛицо = РаботникиИДоговорникиОрганизации.ФизЛицо
			И ПлановыеУдержания.ОбособленноеПодразделение = РаботникиИДоговорникиОрганизации.ОбособленноеПодразделение
			И ПлановыеУдержания.ПериодРегистрации = РаботникиИДоговорникиОрганизации.ПериодРегистрации}</query>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>ФИОРаботников</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодРегистрации</dataPath>
			<field>ПериодРегистрации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период регистрации</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФизЛицо</dataPath>
			<field>ФизЛицо</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Физическое лицо</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<attributeUseRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФИО</dataPath>
			<field>ФИО</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>ФИО</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
ПОМЕСТИТЬ Периоды
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ФИОФизЛиц.ФизЛицо КАК ФизЛицо,
	ДатыПоследнихДвижений.ПериодРегистрации КАК ПериодРегистрации,
	ФИОФизЛиц.Фамилия + " " + ФИОФизЛиц.Имя + " " + ФИОФизЛиц.Отчество КАК ФИО
{ВЫБРАТЬ
	ФИО,
	ФизЛицо.*,
	ПериодРегистрации}
ИЗ
	(ВЫБРАТЬ
		Периоды.ПериодРегистрации КАК ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо КАК ФизЛицо,
		МАКСИМУМ(ФИОФизЛиц.Период) КАК Период
	ИЗ
		Периоды КАК Периоды
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц КАК ФИОФизЛиц
			ПО (КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ) &gt;= ФИОФизЛиц.Период
					ИЛИ &amp;ЕстьГруппировкаПоПериодуРегистрации
						И &amp;КонецПериода &gt;= ФИОФизЛиц.Период)
	{ГДЕ
		Периоды.ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо.*}
	
	СГРУППИРОВАТЬ ПО
		Периоды.ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо) КАК ДатыПоследнихДвижений
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц КАК ФИОФизЛиц
		ПО ДатыПоследнихДвижений.ФизЛицо = ФИОФизЛиц.ФизЛицо
			И ДатыПоследнихДвижений.Период = ФИОФизЛиц.Период
{ГДЕ
	ФИОФизЛиц.ФизЛицо.*,
	ДатыПоследнихДвижений.ПериодРегистрации,
	(ФИОФизЛиц.Фамилия + " " + ФИОФизЛиц.Имя + " " + ФИОФизЛиц.Отчество) КАК ФИО}</query>
	</dataSet>
	<dataSetLink>
		<sourceDataSet>Данные</sourceDataSet>
		<destinationDataSet>ФИОРаботников</destinationDataSet>
		<sourceExpression>ФизЛицо</sourceExpression>
		<destinationExpression>ФизЛицо</destinationExpression>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Данные</sourceDataSet>
		<destinationDataSet>ФИОРаботников</destinationDataSet>
		<sourceExpression>ПериодРегистрации</sourceExpression>
		<destinationExpression>ПериодРегистрации</destinationExpression>
	</dataSetLink>
	<totalField>
		<dataPath>Удержано</dataPath>
		<expression>Сумма(Удержано)</expression>
	</totalField>
	<parameter>
		<name>ЕстьГруппировкаПоПериодуРегистрации</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Есть группировка по периоду регистрации</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Удержано</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>КонецПериода</dcscor:parameter>
					<dcscor:value xsi:type="xs:dateTime">0001-01-01T00:00:00</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>НачалоПериода</dcscor:parameter>
					<dcscor:value xsi:type="xs:dateTime">0001-01-01T00:00:00</dcscor:value>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:order>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>ФизЛицо</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
			</dcsset:order>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьЗаголовок</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">Output</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Заголовок</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Анализ удержаний работников организаций</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьПараметрыДанных</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьОтбор</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>