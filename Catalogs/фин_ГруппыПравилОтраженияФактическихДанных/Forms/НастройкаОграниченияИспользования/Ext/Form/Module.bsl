
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Параметры.Свойство("ОбъектИБ") Тогда
		ЗаполнитьЗначенияСвойств(ЭтотОбъект,Параметры,"ОбъектИБ,ВидДанных,ИмяИсточника,СпособИспользования,Условие,Порядок");
	КонецЕсли;
	УправлениеФормой(ЭтотОбъект);
КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Процедура УправлениеФормой(Форма)
	Форма.Элементы.Условие.Видимость = Форма.СпособИспользования=ПредопределенноеЗначение("Перечисление.фин_СпособИспользованияШаблонаОтраженияВБюджетировании.ВсегдаЕслиУдовлетворяетУсловию") ИЛИ Форма.СпособИспользования=ПредопределенноеЗначение("Перечисление.фин_СпособИспользованияШаблонаОтраженияВБюджетировании.ЕслиУдовлетворяетУсловию");
	Форма.Элементы.УсловиеОписаниеУсловия.Видимость = Форма.СпособИспользования=ПредопределенноеЗначение("Перечисление.фин_СпособИспользованияШаблонаОтраженияВБюджетировании.ВсегдаЕслиУдовлетворяетУсловию") ИЛИ Форма.СпособИспользования=ПредопределенноеЗначение("Перечисление.фин_СпособИспользованияШаблонаОтраженияВБюджетировании.ЕслиУдовлетворяетУсловию");
КонецПроцедуры

&НаКлиенте
Процедура СпособИспользованияПриИзменении(Элемент)
	Если НЕ (СпособИспользования=ПредопределенноеЗначение("Перечисление.фин_СпособИспользованияШаблонаОтраженияВБюджетировании.ВсегдаЕслиУдовлетворяетУсловию") ИЛИ СпособИспользования=ПредопределенноеЗначение("Перечисление.фин_СпособИспользованияШаблонаОтраженияВБюджетировании.ЕслиУдовлетворяетУсловию")) Тогда
		Условие = ПредопределенноеЗначение("Справочник.усд_УсловияВыполненияОперацийПоСтрокамДокумента.ПустаяСсылка");	
	КонецЕсли;
	УправлениеФормой(ЭтотОбъект);
КонецПроцедуры


&НаКлиенте
Процедура УсловиеНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	Если ТипЗнч(ОбъектИБ)=Тип("СправочникСсылка.фин_ВидыДокументов") Тогда
		Если НЕ ЗначениеЗаполнено(ВидДанных) Тогда
			ПоказатьПредупреждение(,"Укажите вид данных для группы!");
			Возврат;
		ИначеЕсли ВидДанных<>ПредопределенноеЗначение("Перечисление.фин_ВидыОтраженийПервичныхДокументовВБюджетировании.ПоШапкеДокумента") И НЕ ЗначениеЗаполнено(ИмяИсточника) Тогда
			ПоказатьПредупреждение(,"Укажите таблицу данных для группы!");
			Возврат;
		КонецЕсли;
	КонецЕсли;
	СтандартнаяОбработка = Ложь;
	СтруктураОтбора = Новый Структура;
	СписокВидовДанных = Новый СписокЗначений;
	СписокВидовДанных.Добавить(ВидДанных);
	Если ВидДанных = ПредопределенноеЗначение("Перечисление.фин_ВидыОтраженийПервичныхДокументовВБюджетировании.ПоТабличнойЧасти") Тогда
		СписокВидовДанных.Добавить(ПредопределенноеЗначение("Перечисление.фин_ВидыОтраженийПервичныхДокументовВБюджетировании.ПоШапкеДокумента"));
 		Список = Новый СписокЗначений;
		Список.Добавить("");
		Список.Добавить(ИмяИсточника);
		СтруктураОтбора.Вставить("ИмяИсточника",Список);
	Иначе
		Если ТипЗнч(ОбъектИБ)=Тип("СправочникСсылка.фин_ВидыДокументов") Тогда
			СписокВидовДанных.Добавить(ПредопределенноеЗначение("Перечисление.фин_ВидыОтраженийПервичныхДокументовВБюджетировании.ПоШапкеДокумента"));
	 		Список = Новый СписокЗначений;
			Список.Добавить("");
			Список.Добавить(ИмяИсточника);
			СтруктураОтбора.Вставить("ИмяИсточника",Список);
		Иначе
			СписокВидовДанных.Добавить(ПредопределенноеЗначение("Перечисление.фин_ВидыОтраженийПервичныхДокументовВБюджетировании.ПоДвижениямВРегистрах"));
		КонецЕсли;
	КонецЕсли;
	СтруктураОтбора.Вставить("ВидДанных",СписокВидовДанных);
	СтруктураОтбора.Вставить("Владелец",ОбъектИБ);
	СтруктураПараметров = Новый Структура("ТекущееЗначение,Отбор",Условие,СтруктураОтбора);
	ОткрытьФорму("Справочник.усд_УсловияВыполненияОперацийПоСтрокамДокумента.ФормаВыбора",СтруктураПараметров,Элемент);
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
	Если (СпособИспользования=ПредопределенноеЗначение("Перечисление.фин_СпособИспользованияШаблонаОтраженияВБюджетировании.ВсегдаЕслиУдовлетворяетУсловию") ИЛИ СпособИспользования=ПредопределенноеЗначение("Перечисление.фин_СпособИспользованияШаблонаОтраженияВБюджетировании.ЕслиУдовлетворяетУсловию")) И НЕ ЗначениеЗаполнено(Условие) Тогда
		ПоказатьПредупреждение(,"Для выбранного способа использования необходимо указать условие");
	Иначе	
		Закрыть(Новый Структура("СпособИспользования,Условие,Порядок",СпособИспользования,Условие,Порядок));
	КонецЕсли;
КонецПроцедуры

