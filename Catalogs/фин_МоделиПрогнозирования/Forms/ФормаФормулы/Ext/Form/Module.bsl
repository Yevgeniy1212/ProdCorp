&НаКлиенте
Перем СоответствиеКоманд;

&НаКлиенте
Процедура ВыборФункции(Команда)
	Если Найти(Команда.Имя,"Цифра")=0 Тогда
		Элементы.Формула.ВыделенныйТекст = СоответствиеКоманд.Получить(Команда.Имя);
	Иначе
		Элементы.Формула.ВыделенныйТекст = Сред(Команда.Имя,СтрДлина("Цифра")+1);
	КонецЕсли;
	Модифицированность = Истина;
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Параметры.Свойство("Формула")=Ложь Тогда
		Отказ = Истина;
	КонецЕсли;
	Формула = Параметры.Формула;
	НадписьФормула = "Формула";
	ТекстФормулы = Формула;
	ТекстФормулы = СтрЗаменить(ТекстФормулы,	"Sqrt(",	"КореньКв(");
	ТекстФормулы = СтрЗаменить(ТекстФормулы,	"Pow(",		"Степень(");
	ПредставлениеФормулы.УстановитьТекст(ТекстФормулы);
КонецПроцедуры

&НаКлиенте
Процедура ТригонометрическиеФункции(Команда)
	СписокФункций = Новый СписокЗначений;
	СписокФункций.Добавить("Sin()",		"Sin(Угол) - синус от аргумента, заданного в радианах");
	СписокФункций.Добавить("Cos()",		"Cos(Угол) - косинус от аргумента, заданного в радианах");
	СписокФункций.Добавить("Tan()",		"Tan(Угол) - тангенс от аргумента, заданного в радианах");
	СписокФункций.Добавить("ASin()",	"ASin(Число) - вычисление арксинуса в радианах от аргумента в диапазоне -1 ... 1");
	СписокФункций.Добавить("ACos()",	"ACos(Число) - вычисление арккосинуса в радианах от аргумента в диапазоне -1 ... 1");
	СписокФункций.Добавить("ATan()",	"ATan(Число) - вычисление арктангенса в радианах от аргумента в диапазоне -1 ... 1");
	ОписаниеОбработкаВыбораТригонометрическихФункций = Новый ОписаниеОповещения("ОбработкаВыбораТригонометрическихФункций",ЭтотОбъект);
	ПоказатьВыборИзСписка(ОписаниеОбработкаВыбораТригонометрическихФункций,СписокФункций,Элементы.ТригонометрическиеФункции,СписокФункций[0]);
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаВыбораТригонометрическихФункций(РезультатВыбора,ДополнительныеПараметры) Экспорт
	Если РезультатВыбора <> Неопределено Тогда
		Элементы.Формула.ВыделенныйТекст = РезультатВыбора.Значение;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
	Формула = ПредставлениеФормулы.ПолучитьТекст();
	Формула = СтрЗаменить(Формула,"КореньКв(",	"Sqrt(");
	Формула = СтрЗаменить(Формула,"Степень(",	"Pow(");
	Закрыть(Формула);
КонецПроцедуры


СоответствиеКоманд = Новый Соответствие;
СоответствиеКоманд.Вставить("Значение",	"Значение");
СоответствиеКоманд.Вставить("Выбор",	"?(,,)");
СоответствиеКоманд.Вставить("Макс",		"Макс(,)");
СоответствиеКоманд.Вставить("Мин",		"Мин(,)");
СоответствиеКоманд.Вставить("Окр",		"Окр(,)");
СоответствиеКоманд.Вставить("Цел",		"Цел()");
СоответствиеКоманд.Вставить("Оценить",	"ОценитьПо(,)");
СоответствиеКоманд.Вставить("Log",		"Log()");
СоответствиеКоманд.Вставить("Log10",	"Log10()");
СоответствиеКоманд.Вставить("Корень",	"КореньКв()");
СоответствиеКоманд.Вставить("Минус",	"-");
СоответствиеКоманд.Вставить("Плюс",		"+");
СоответствиеКоманд.Вставить("СкобкаЗакрывающая",	")");
СоответствиеКоманд.Вставить("СкобкаОткрывающая",	"(");
СоответствиеКоманд.Вставить("Степень",	"Степень(,)");
СоответствиеКоманд.Вставить("Умножить",	"*");
СоответствиеКоманд.Вставить("Делить",	"/");
СоответствиеКоманд.Вставить("Exp",		"Exp()");
СоответствиеКоманд.Вставить("Больше",		">");
СоответствиеКоманд.Вставить("Меньше",		"<");
СоответствиеКоманд.Вставить("Равно",		"=");
СоответствиеКоманд.Вставить("БольшеИлиРавно",		"=>");
СоответствиеКоманд.Вставить("МеньшеИлиРавно",		"<=");
СоответствиеКоманд.Вставить("НеРавно",		"<>");
СоответствиеКоманд.Вставить("Точка",		".");
