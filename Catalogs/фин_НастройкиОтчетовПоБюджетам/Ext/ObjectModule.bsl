
Процедура ПриЗаписи(Отказ)
	Если ОбменДанными.Загрузка=Истина Тогда
		Возврат;
	КонецЕсли;
	Для Каждого СтрокаТаблиц Из ТаблицыОтчета Цикл
		Если ЗначениеЗаполнено(СтрокаТаблиц.Таблица) Тогда
			Если СтрокаТаблиц.Таблица.Владелец<>Ссылка Тогда
				НоваяТаблица = Справочники.фин_ТаблицыОтчетовПоБюджетам.СоздатьЭлемент();
				ЗаполнитьЗначенияСвойств(НоваяТаблица,СтрокаТаблиц.Таблица,,"Код,Родитель");
				НоваяТаблица.Владелец = Ссылка;
				НоваяТаблица.УстановитьНовыйКод();
				Попытка
					НоваяТаблица.Записать();
					ОбрабатываемыеТаблицыФормы = Новый Массив;
					ОбрабатываемыеТаблицыФормы.Добавить(Показатели);
					ОбрабатываемыеТаблицыФормы.Добавить(Группировки);
					ОбрабатываемыеТаблицыФормы.Добавить(ВидыАналитическихДанных);
					ОбрабатываемыеТаблицыФормы.Добавить(АналитическиеПоляСводаКорректировок);
					фин_УправлениеОтчетамиКлиентСервер.ПеренестиНастройкиТаблицыОтчета(ОбрабатываемыеТаблицыФормы,СтрокаТаблиц.Таблица,НоваяТаблица.Ссылка,Ложь);
					СтрокаТаблиц.Таблица = НоваяТаблица.Ссылка;
				Исключение
					ОбщегоНазначенияКлиентСервер.СообщитьПользователю("Не удалось создать таблицу настроек: "+ОписаниеОшибки());
					Возврат;
				КонецПопытки;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры
