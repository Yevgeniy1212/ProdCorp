
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	//Вставить содержимое обработчика.
	ИмяОтчета = ИмяОтчета(ПараметрКоманды);
	Если ИмяОтчета="" Тогда
		Возврат;
	КонецЕсли;
	ПараметрыФормы = НастройкиОтчета(ПараметрКоманды);
	ОткрытьФорму("Отчет."+ИмяОтчета+".Форма", ПараметрыФормы, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность,?(фин_ОбщегоНазначенияКлиентПовтИсп.РежимОтдельногоОткрытияОкон(),ВариантОткрытияОкна.ОтдельноеОкно,ПараметрыВыполненияКоманды.Окно));
КонецПроцедуры

&НаСервере
Функция ИмяОтчета(Настройка)
	Если ТипЗнч(Настройка)=Тип("СправочникСсылка.фин_ВидыОтчетовПоБюджетам") Тогда
		Возврат Справочники.фин_ВидыОтчетовПоБюджетам.ПолучитьИмяМетаданныхОтчета(Настройка);	
	Иначе
		Возврат Справочники.фин_ВидыОтчетовПоБюджетам.ПолучитьИмяМетаданныхОтчета(Настройка.Владелец);	
	КонецЕсли;
КонецФункции


&НаКлиенте
Функция НастройкиОтчета(Настройка)
	Если ТипЗнч(Настройка)=Тип("СправочникСсылка.фин_ВидыОтчетовПоБюджетам") Тогда
		Возврат Новый Структура;	
	КонецЕсли;
	СтруктураНастроек = Новый Структура("НеВосстанавливатьНастройки,СформироватьПриОткрытии,ШаблонОтчета",Истина,Истина,Настройка);
	//МетаданныеОтчета = Справочники.фин_ВидыОтчетовПоБюджетам.МетаданныеОтчета(Настройка.Владелец);
	//Для Каждого Реквизит Из МетаданныеОтчета.Реквизиты Цикл
	//	 Значение = Справочники.фин_НастройкиОтчетовПоБюджетам.ЗначениеРеквизитаОтчетаИзТекущейНастройки(Реквизит.Имя,Настройка);
	//	 Если Значение<>Неопределено Тогда
	//		 СтруктураНастроек.Вставить(Реквизит.Имя,Значение);
	//	 КонецЕсли;
	//КонецЦикла;
	//ТабличныеЧасти = фин_ОбщегоНазначенияВызовСервераПовтИсп.ТабличныеЧастиСправочникаНастроекОтчетов();	
	//Для Каждого ТЧ Из МетаданныеОтчета.ТабличныеЧасти Цикл
	//	Если ТабличныеЧасти.Найти(НРег(ТЧ.Имя))=Неопределено Тогда
	//		Продолжить;
	//	КонецЕсли;
	//	СтруктураНастроек.Вставить(ТЧ.Имя,Настройка[ТЧ.Имя].Выгрузить());
	//КонецЦикла;
	 
	Возврат СтруктураНастроек;	
КонецФункции

